<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>初识Go语言 | 兔の博客</title><meta name="author" content="Alexander Liu"><meta name="copyright" content="Alexander Liu"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Go非常有意思的一门语言，这一次的学习偏向于基础知识，后面可能还会接触工程项目，总之先把基础打好！！！">
<meta property="og:type" content="article">
<meta property="og:title" content="初识Go语言">
<meta property="og:url" content="http://example.com/2021/10/12/chu-shi-go-yu-yan/index.html">
<meta property="og:site_name" content="兔の博客">
<meta property="og:description" content="Go非常有意思的一门语言，这一次的学习偏向于基础知识，后面可能还会接触工程项目，总之先把基础打好！！！">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7">
<meta property="article:published_time" content="2021-10-12T14:17:11.000Z">
<meta property="article:modified_time" content="2021-10-25T07:48:57.000Z">
<meta property="article:author" content="Alexander Liu">
<meta property="article:tag" content="大三自学">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2021/10/12/chu-shi-go-yu-yan/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"prismjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '初识Go语言',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-10-25 15:48:57'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.2.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="兔の博客" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">75</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">15</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div><hr/></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">兔の博客</a></span><div id="menus"><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">初识Go语言</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-10-12T14:17:11.000Z" title="发表于 2021-10-12 22:17:11">2021-10-12</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-10-25T07:48:57.000Z" title="更新于 2021-10-25 15:48:57">2021-10-25</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="初识Go语言"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="Go非常有意思的一门语言，这一次的学习偏向于基础知识，后面可能还会接触工程项目，总之先把基础打好！！！"><a href="#Go非常有意思的一门语言，这一次的学习偏向于基础知识，后面可能还会接触工程项目，总之先把基础打好！！！" class="headerlink" title="Go非常有意思的一门语言，这一次的学习偏向于基础知识，后面可能还会接触工程项目，总之先把基础打好！！！"></a>Go非常有意思的一门语言，这一次的学习偏向于基础知识，后面可能还会接触工程项目，总之先把基础打好！！！</h1><span id="more"></span>



<h1 id="基础环境配置"><a href="#基础环境配置" class="headerlink" title="基础环境配置"></a>基础环境配置</h1><h2 id="具体步骤："><a href="#具体步骤：" class="headerlink" title="具体步骤："></a>具体步骤：</h2><ul>
<li>在Window上直接下载Golang加上Goland就好，这里比较简单我不做过多的记录，电脑崩了好几次，这已经是第二次配置Go语言了orz。</li>
<li>下面记录一下在Linux中配置环境的过程：<ul>
<li><p>镜像网站：</p>
<ol>
<li>官方网站<code>https://golang.org/dl/</code>，搭梯子，访问太慢。</li>
<li>Go官方镜像站（推荐）：<code>https://golang.google.cn/dl</code></li>
<li>中文网站：<code>https://studygolang.com/dl</code></li>
</ol>
</li>
<li><p>下载源码之后：<code>sudo tar -zxvf 源码包 -C /usr/local/</code>才能够很好的解决上述的问题嗷！！！</p>
</li>
<li><p>解压完成之后配置环境变量：</p>
<ul>
<li>首先<code>cd / cd ~</code>，回到<code>$HOME目录下</code>，HOME目录下有个.bashrc文件，就是环境目录的配置文件</li>
<li>在文件末尾加上我们的环境配置：</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211013094212.png" alt="image-20211013094203229"></p>
<p>其中第一行是我们解压的go源码所在的目录。第二行GOPATH是我们写go代码的工作路径，可以自定义，这里我们将其配置在$HOME目录下的go文件夹中。第三行我们去写系统的环境变量，取并集，机上我们GOROOT的bin和GOPATH的bin就可以了嗷！！！</p>
<ul>
<li><code>source ~/.bashrc</code>重新加载我们的配置文件进来嗷！！！</li>
<li><code>go version</code>以及<code>go help</code>没有问题，说明就配置成功了。</li>
<li>使用本地的VSCode通过SSH插件连接虚拟机中对应的go的工作目录，可以成功连上，说明配置成功了！！！</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="Go的序言"><a href="#Go的序言" class="headerlink" title="Go的序言"></a>Go的序言</h1><h2 id="优势："><a href="#优势：" class="headerlink" title="优势："></a>优势：</h2><h3 id="部署简单："><a href="#部署简单：" class="headerlink" title="部署简单："></a>部署简单：</h3><ol>
<li>可以直接编译成机器码（go build）</li>
<li>不依赖其他库（编译生成的文件就全部整好了！！！）</li>
<li>直接运行就可以部署！！！（./生成的可执行文件就可以完成服务器的运行嗷！！！）</li>
</ol>
<h3 id="静态类型语言："><a href="#静态类型语言：" class="headerlink" title="静态类型语言："></a>静态类型语言：</h3><ul>
<li>编译的时候就可以查出来隐藏的大多数问题，防止跑的过程中出现问题。</li>
</ul>
<h3 id="语言层面的并发："><a href="#语言层面的并发：" class="headerlink" title="语言层面的并发："></a>语言层面的并发：</h3><ul>
<li>天生的基因支持并发</li>
<li>充分利用多核</li>
</ul>
<h3 id="强大的标准化："><a href="#强大的标准化：" class="headerlink" title="强大的标准化："></a>强大的标准化：</h3><ul>
<li>runtime系统调度机制：<ul>
<li>帮助垃圾回收</li>
<li>帮助我们做一些Go的调度的平均分配</li>
<li>很多的优化机制</li>
</ul>
</li>
<li>高效的GC垃圾回收：<ul>
<li>1.8版本之后就加入了三色标记和混合写屏障，效率非常搞了</li>
</ul>
</li>
<li>丰富的标准库：</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211013095232.png" alt="image-20211013095232293"></p>
<h3 id="简单易学："><a href="#简单易学：" class="headerlink" title="简单易学："></a>简单易学：</h3><ul>
<li>25个关键字</li>
<li>C基因，内嵌C都支持？？？</li>
<li>面向对象的特征（继承，多态，封装）</li>
<li>跨平台</li>
</ul>
<h3 id="大厂领军："><a href="#大厂领军：" class="headerlink" title="大厂领军："></a>大厂领军：</h3><ul>
<li>背书猛的一批：</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211013095437.png" alt="image-20211013095436889"></p>
<ul>
<li>编译速度很快啊！！！</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211013095553.png" alt="image-20211013095552886"></p>
<h2 id="适用领域："><a href="#适用领域：" class="headerlink" title="适用领域："></a>适用领域：</h2><ol>
<li>云计算基础设施：<strong>Docker , k8s</strong> , etcd , consul , cloudflare CDN等等</li>
<li>基础后端软件：tidb , influxdb</li>
<li>微服务：go-kit , micro , monzo bank的bilibili等</li>
<li>互联网基础设施：以太坊 ， hyperledger等</li>
</ol>
<h2 id="不足："><a href="#不足：" class="headerlink" title="不足："></a>不足：</h2><ol>
<li>包管理的不足</li>
<li>没有泛化，GO计划2.0上加上（传言）</li>
<li>所有的Exception都用Error来处理</li>
<li>对于C的降级处理，并非无缝衔接</li>
</ol>
<h1 id="认识Go程序"><a href="#认识Go程序" class="headerlink" title="认识Go程序"></a>认识Go程序</h1><h2 id="语法："><a href="#语法：" class="headerlink" title="语法："></a>语法：</h2><h3 id="简单程序入门："><a href="#简单程序入门：" class="headerlink" title="简单程序入门："></a>简单程序入门：</h3><pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">package</span> main <span class="token comment">//程序的包名</span>

<span class="token comment">//引入的包</span>
<span class="token keyword">import</span> <span class="token punctuation">(</span>
   <span class="token string">"fmt"</span>
   <span class="token string">"time"</span>
<span class="token punctuation">)</span>

<span class="token comment">//main函数</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token comment">//Golang中的";"，加上和不加上都可以哦</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"hello Go!!!"</span><span class="token punctuation">)</span>
   time<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">*</span> time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>一个Package中只有一个Main入口哦！！！</li>
<li>函数的<code>{</code>一定是和函数名在同一行的，否则编译错误。</li>
</ul>
<h3 id="变量声明："><a href="#变量声明：" class="headerlink" title="变量声明："></a>变量声明：</h3><pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
   <span class="token string">"fmt"</span>
   <span class="token string">"math"</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token comment">//方法一：声明一个变量</span>
   <span class="token keyword">var</span> a <span class="token builtin">int</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"a = "</span><span class="token punctuation">,</span>a<span class="token punctuation">)</span>
   fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"type of a = %T\n"</span><span class="token punctuation">,</span>a<span class="token punctuation">)</span>

   <span class="token comment">//方法二：声明一个变量，初始化一个值</span>
   <span class="token keyword">var</span> b <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">100</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"b = "</span><span class="token punctuation">,</span>b<span class="token punctuation">)</span>
   fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"type of b = %T\n"</span><span class="token punctuation">,</span>b<span class="token punctuation">)</span>

   <span class="token comment">//方法三：初始化的时候，可以省去数据类型，通过值自动会匹配当前的变量的数据类型</span>
   <span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token number">200</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"c = "</span><span class="token punctuation">,</span>c<span class="token punctuation">)</span>
   fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"type of c = %T\n"</span><span class="token punctuation">,</span>c<span class="token punctuation">)</span>

   <span class="token keyword">var</span> d <span class="token operator">=</span> <span class="token string">"abcd"</span>
   fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"d = %s, type of d = %T\n"</span><span class="token punctuation">,</span>d<span class="token punctuation">,</span>d<span class="token punctuation">)</span>

   <span class="token comment">//方法四：（最常用的方法）省去var关键词，直接自动匹配</span>
   e <span class="token operator">:=</span> math<span class="token punctuation">.</span>Pi
   fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"e = %f, type of e = %T\n"</span><span class="token punctuation">,</span>e<span class="token punctuation">,</span>e<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>上面就是声明变量的方法。</li>
<li>如果想要全局变量，把变量的声明放在方法外面就成嗷！！！</li>
</ul>
<pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">var</span> gA <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">100</span>
<span class="token keyword">var</span> gB <span class="token operator">=</span> <span class="token number">200</span>
<span class="token comment">//gC := 300</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>上面的方法一二三都可以声明全局变量，但是方法四这种简单的是不适用的嗷！！！</p>
<ul>
<li>声明多个变量</li>
</ul>
<p><code>var xx , yy int  = 100, 200</code></p>
<p><code>var kk , ll  = 100 , "Alexander"</code></p>
<p>多行的多变量声明：</p>
<pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">var</span><span class="token punctuation">(</span>
	vv <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">100</span>
    jj <span class="token builtin">bool</span> <span class="token operator">=</span> <span class="token boolean">true</span>
<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>语法四声明变量：</p>
<pre class="line-numbers language-go" data-language="go"><code class="language-go">xx <span class="token punctuation">,</span> yy <span class="token operator">:=</span> <span class="token number">100</span><span class="token punctuation">,</span><span class="token number">200</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>xx<span class="token punctuation">)</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>yy<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>





<h3 id="Const与Iota知识点注意事项"><a href="#Const与Iota知识点注意事项" class="headerlink" title="Const与Iota知识点注意事项"></a>Const与Iota知识点注意事项</h3><pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">"fmt"</span>

<span class="token comment">// const可以用于枚举类型</span>
<span class="token keyword">const</span> <span class="token punctuation">(</span>
   <span class="token comment">//可以在const() 中添加一个关键字iota，每行iota都会累加1，第一行的ioat默认值为0</span>
   BEIJING <span class="token operator">=</span> <span class="token number">10</span><span class="token operator">*</span><span class="token boolean">iota</span>  <span class="token comment">//iota = 0</span>
   SHANGHAI      <span class="token comment">//iota = 1</span>
   SHENZHEN      <span class="token comment">//iota = 2</span>
<span class="token punctuation">)</span>

<span class="token keyword">const</span> <span class="token punctuation">(</span>
   a<span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token boolean">iota</span><span class="token operator">+</span><span class="token number">1</span> <span class="token punctuation">,</span> <span class="token boolean">iota</span><span class="token operator">+</span><span class="token number">2</span> <span class="token comment">// iota = 0 , a = iota + 1 , b = iota + 2 , a = 1 , b = 2</span>
   c<span class="token punctuation">,</span> d               <span class="token comment">// iota = 1 , c = iota + 1 , d = iota + 2 , c = 2 , d = 3</span>
   e<span class="token punctuation">,</span> f               <span class="token comment">// iota = 2 , e = iota + 1 , f = iota + 2 , e = 3 , f = 4</span>

   g<span class="token punctuation">,</span> h <span class="token operator">=</span> <span class="token boolean">iota</span><span class="token operator">*</span><span class="token number">2</span> <span class="token punctuation">,</span> <span class="token boolean">iota</span><span class="token operator">*</span><span class="token number">3</span> <span class="token comment">// iota = 3 , g = iota * 2 , h = iota * 3 , g = 6 , h = 9</span>
   i<span class="token punctuation">,</span>k                   <span class="token comment">// iota = 4 , i = iota * 2 , k = iota * 3 , i = 8 , k = 12</span>
<span class="token punctuation">)</span>

<span class="token comment">// summary: iota每一行都加1，第一行为0（从0开始），具体的计算公式则是根据我们第一行给出的计算公式来确定的嗷！！！</span>
<span class="token comment">// iota只能够配合const() 一起使用哦！！！iota只有在const进行累加效果。。。</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token comment">//常量（只读属性）</span>
   <span class="token keyword">const</span> length <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">10</span>

   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"length = "</span><span class="token punctuation">,</span>length<span class="token punctuation">)</span>

   <span class="token comment">//length = 100，常量是不允许修改的</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"BEIJING = "</span><span class="token punctuation">,</span>BEIJING<span class="token punctuation">)</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"SHANGHAI = "</span><span class="token punctuation">,</span>SHANGHAI<span class="token punctuation">)</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"SHENZHEN = "</span><span class="token punctuation">,</span>SHENZHEN<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="函数的多返回值三种写法"><a href="#函数的多返回值三种写法" class="headerlink" title="函数的多返回值三种写法"></a>函数的多返回值三种写法</h3><pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">"fmt"</span>

<span class="token keyword">func</span> <span class="token function">foo1</span><span class="token punctuation">(</span>a <span class="token builtin">string</span><span class="token punctuation">,</span> b <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">{</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"--- foo1 ---"</span><span class="token punctuation">)</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"a = "</span><span class="token punctuation">,</span>a<span class="token punctuation">)</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"b = "</span><span class="token punctuation">,</span>b<span class="token punctuation">)</span>

   c <span class="token operator">:=</span> <span class="token number">100</span>

   <span class="token keyword">return</span> c
<span class="token punctuation">}</span>

<span class="token comment">//返回多个匿名返回值</span>
<span class="token keyword">func</span> <span class="token function">foo2</span><span class="token punctuation">(</span>a <span class="token builtin">string</span><span class="token punctuation">,</span> b <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"--- foo2 ---"</span><span class="token punctuation">)</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"a = "</span><span class="token punctuation">,</span>a<span class="token punctuation">)</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"b = "</span><span class="token punctuation">,</span>b<span class="token punctuation">)</span>

   <span class="token keyword">return</span> <span class="token number">666</span><span class="token punctuation">,</span><span class="token number">777</span>
<span class="token punctuation">}</span>

<span class="token comment">//返回多个返回值，有形参名称的，这两值就算我的函数中不赋值，默认的返回值也为0嗷！！！</span>
<span class="token keyword">func</span> <span class="token function">foo3</span><span class="token punctuation">(</span>a <span class="token builtin">string</span><span class="token punctuation">,</span> b <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>r1 <span class="token builtin">int</span><span class="token punctuation">,</span>r2 <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"--- foo3 ---"</span><span class="token punctuation">)</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"a = "</span><span class="token punctuation">,</span>a<span class="token punctuation">)</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"b = "</span><span class="token punctuation">,</span>b<span class="token punctuation">)</span>

   <span class="token comment">//给有名称的返回值变量赋值</span>
   r1 <span class="token operator">=</span> <span class="token number">1000</span>
   r2 <span class="token operator">=</span> <span class="token number">2000</span>

   <span class="token keyword">return</span>
<span class="token punctuation">}</span>

<span class="token comment">//r1 , r2类型相同的时候，可以使用一个int就成嗷！！！</span>
<span class="token keyword">func</span> <span class="token function">foo4</span><span class="token punctuation">(</span>a <span class="token builtin">string</span><span class="token punctuation">,</span> b <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>r1 <span class="token punctuation">,</span>r2 <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"--- foo4 ---"</span><span class="token punctuation">)</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"a = "</span><span class="token punctuation">,</span>a<span class="token punctuation">)</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"b = "</span><span class="token punctuation">,</span>b<span class="token punctuation">)</span>

   <span class="token comment">//给有名称的返回值变量赋值</span>
   r1 <span class="token operator">=</span> <span class="token number">1000</span>
   r2 <span class="token operator">=</span> <span class="token number">2000</span>

   <span class="token keyword">return</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   c <span class="token operator">:=</span> <span class="token function">foo1</span><span class="token punctuation">(</span><span class="token string">"foo1"</span><span class="token punctuation">,</span><span class="token number">6666</span><span class="token punctuation">)</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"c = "</span><span class="token punctuation">,</span>c<span class="token punctuation">)</span>


   ret1 <span class="token punctuation">,</span> ret2 <span class="token operator">:=</span> <span class="token function">foo2</span><span class="token punctuation">(</span><span class="token string">"foo2"</span><span class="token punctuation">,</span><span class="token string">"Hah, this is another one!!!"</span><span class="token punctuation">)</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>ret1<span class="token punctuation">)</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>ret2<span class="token punctuation">)</span>


   ret1 <span class="token punctuation">,</span> ret2 <span class="token operator">=</span> <span class="token function">foo3</span><span class="token punctuation">(</span><span class="token string">"foo3"</span><span class="token punctuation">,</span><span class="token string">"Hah, this is the third one!!!"</span><span class="token punctuation">)</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"ret1 = "</span><span class="token punctuation">,</span>ret1<span class="token punctuation">,</span><span class="token string">" ret2 = "</span><span class="token punctuation">,</span>ret2<span class="token punctuation">)</span>

   ret1 <span class="token punctuation">,</span> ret2 <span class="token operator">=</span> <span class="token function">foo4</span><span class="token punctuation">(</span><span class="token string">"foo4"</span><span class="token punctuation">,</span><span class="token string">"Hah, this is the fourth one!!!"</span><span class="token punctuation">)</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"ret1 = "</span><span class="token punctuation">,</span>ret1<span class="token punctuation">,</span><span class="token string">" ret2 = "</span><span class="token punctuation">,</span>ret2<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>summary：<ol>
<li>匿名</li>
<li>匿名多返回值</li>
<li>有名称的返回值</li>
</ol>
</li>
</ul>
<h3 id="Import导包路径和Init方法"><a href="#Import导包路径和Init方法" class="headerlink" title="Import导包路径和Init方法"></a>Import导包路径和Init方法</h3><ul>
<li>示意图：</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211014194110.png" alt="image-20211014194102605"></p>
<p>有点像Java的初始化函数，在调用某个包中的方法的时候，先会执行Init()方法进行初始化。</p>
<ul>
<li>函数：</li>
</ul>
<pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">package</span> main


<span class="token comment">//大写的函数才是对外开放的函数，不然的话就只有当前包中才可以调用嗷！！！</span>
<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"go2/GolangStudy/5-init/lib1"</span>
	<span class="token string">"go2/GolangStudy/5-init/lib2"</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	lib1<span class="token punctuation">.</span><span class="token function">Lib1Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	lib2<span class="token punctuation">.</span><span class="token function">Lib2Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>文件目录结构：</p>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211014194749.png" alt="image-20211014194749257"></p>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211014194943.png" alt="image-20211014194943744"></p>
<p>GoLand非常强，不用自己导入包，直接输入lib1就有提示的嗷！！！</p>
<ul>
<li>lib1中对应的go文件的内容：</li>
</ul>
<pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">package</span> lib1

<span class="token keyword">import</span> <span class="token string">"fmt"</span>

<span class="token keyword">func</span> <span class="token function">Lib1Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"Lib1Test()..."</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"lib1 , init() ..."</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>







<h3 id="Import匿名及别名导包方式"><a href="#Import匿名及别名导包方式" class="headerlink" title="Import匿名及别名导包方式"></a>Import匿名及别名导包方式</h3><ul>
<li>导入的包如果不使用任何函数，那么会报错，如果我仅仅想要执行某个包中的初始化方法但是又用不到这个包中的任何方法呢？？？</li>
</ul>
<ol>
<li>匿名导入包：</li>
</ol>
<pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">package</span> main


<span class="token comment">//大写的函数才是对外开放的函数，不然的话就只有当前包中才可以调用嗷！！！</span>
<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token boolean">_</span> <span class="token string">"go2/GolangStudy/5-init/lib1"</span>
	<span class="token string">"go2/GolangStudy/5-init/lib2"</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// lib1.Lib1Test()</span>
	lib2<span class="token punctuation">.</span><span class="token function">Lib2Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>如上就可以使得lib1中的Init()方法执行嗷！！！</p>
<p>如果匿名导入包的话是无法使用这个包的方法的，但是可以使得对应包的初始化方法执行嗷！！！</p>
<ol start="2">
<li>同理，可以给导入的包起别名嗷！！！</li>
</ol>
<pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">package</span> main


<span class="token comment">//大写的函数才是对外开放的函数，不然的话就只有当前包中才可以调用嗷！！！</span>
<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token boolean">_</span> <span class="token string">"go2/GolangStudy/5-init/lib1"</span>
	mylib2 <span class="token string">"go2/GolangStudy/5-init/lib2"</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// lib1.Lib1Test()</span>
	mylib2<span class="token punctuation">.</span><span class="token function">Lib2Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li>全部方法的导入方法：</li>
</ol>
<pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">package</span> main


<span class="token comment">//大写的函数才是对外开放的函数，不然的话就只有当前包中才可以调用嗷！！！</span>
<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token boolean">_</span> <span class="token string">"go2/GolangStudy/5-init/lib1"</span>
	<span class="token punctuation">.</span> <span class="token string">"go2/GolangStudy/5-init/lib2"</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// lib1.Lib1Test()</span>
	<span class="token function">Lib2Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>类似于Python中的<code>from package import *</code></p>
<p>点不要轻易使用，如果两个包中有同名的方法就会发生冲突嗷！！！</p>
<h3 id="Golang中的指针速通"><a href="#Golang中的指针速通" class="headerlink" title="Golang中的指针速通"></a>Golang中的指针速通</h3><ul>
<li>和C语言中的是一样的嗷！！！简单的参数就是传值！！！如果<code>*a</code>和C语言是一样的嗷！！！就是传址操作嗷！！！</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211014200036.png" alt="image-20211014200036290"></p>
<ul>
<li>经典示例代码：</li>
</ul>
<pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">"fmt"</span>

<span class="token keyword">func</span> <span class="token function">swap</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">var</span> temp <span class="token operator">=</span> a
   a <span class="token operator">=</span> b
   b <span class="token operator">=</span> temp
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">swap2</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b <span class="token operator">*</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">var</span> temp <span class="token operator">=</span> <span class="token operator">*</span>a
   <span class="token operator">*</span>a <span class="token operator">=</span> <span class="token operator">*</span>b
   <span class="token operator">*</span>b <span class="token operator">=</span> temp
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   a<span class="token punctuation">,</span> b <span class="token operator">:=</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span>
   <span class="token function">swap</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"a = "</span><span class="token punctuation">,</span>a<span class="token punctuation">)</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"b = "</span><span class="token punctuation">,</span>b<span class="token punctuation">)</span>

   <span class="token comment">//swap</span>
   a<span class="token punctuation">,</span>b <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span><span class="token number">20</span>
   <span class="token function">swap2</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>a<span class="token punctuation">,</span><span class="token operator">&amp;</span>b<span class="token punctuation">)</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"a = "</span><span class="token punctuation">,</span>a<span class="token punctuation">)</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"b = "</span><span class="token punctuation">,</span>b<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="defer语句"><a href="#defer语句" class="headerlink" title="defer语句"></a>defer语句</h3><ul>
<li>示例代码：</li>
</ul>
<pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">"fmt"</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token comment">//写入defer关键字</span>
   <span class="token keyword">defer</span> fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"main end1"</span><span class="token punctuation">)</span>
   <span class="token keyword">defer</span> fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"main end2"</span><span class="token punctuation">)</span>

   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"main::hello go 1"</span><span class="token punctuation">)</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"main::hello go 2"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>defer后面的语句在所有流程结束，代码结束之前执行，类似于Java中的finally，经常用于释放资源。</li>
<li>defer可以有多个，本质是进行了压栈，所以上面的end1在栈底，end2在栈首，执行的时候先main end2再main end1嗷！！！</li>
<li>另外一个Demo：</li>
</ul>
<pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">"fmt"</span>

<span class="token keyword">func</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"hehe, I am here !!!"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token comment">//写入defer关键字</span>
   <span class="token keyword">defer</span> fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"main end"</span><span class="token punctuation">)</span>
   <span class="token keyword">defer</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"main::hello go 1"</span><span class="token punctuation">)</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"main::hello go 2"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>输出结果：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">main::hello go <span class="token number">1</span>
main::hello go <span class="token number">2</span>
hehe, I am here <span class="token operator">!</span><span class="token operator">!</span><span class="token operator">!</span>
main end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>defer要放在return之前哈，不然defer根本执行不到哇！！！return应该放在最后嗷！！！现在探究的是return和defer的执行顺序：</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211014201307.png" alt="image-20211014201307142"></p>
<p>很好理解，当程序运行到<code>}</code>的时候，才执行deter函数嗷，这个时候return早就执行完了嗷！！！deter是在return后面执行的嗷！！！</p>
<ul>
<li>另外一个小例子：</li>
</ul>
<pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">"fmt"</span>

<span class="token keyword">func</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"hehe, I am here !!!"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">test2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
   <span class="token keyword">defer</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token keyword">return</span> <span class="token string">"Hello this is the return function"</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token comment">//写入defer关键字</span>
   <span class="token keyword">defer</span> fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"main end"</span><span class="token punctuation">)</span>
   <span class="token keyword">defer</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"main::hello go 1"</span><span class="token punctuation">)</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"main::hello go 2"</span><span class="token punctuation">)</span>

   <span class="token function">test2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"======================"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">main::hello go <span class="token number">1</span>
main::hello go <span class="token number">2</span>
hehe, I am here <span class="token operator">!</span><span class="token operator">!</span><span class="token operator">!</span>
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
hehe, I am here <span class="token operator">!</span><span class="token operator">!</span><span class="token operator">!</span>
main end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>可以看到，deter是在 <strong>本方法执行结束之后执行的嗷！！！</strong></p>
<h3 id="Go中的Slice"><a href="#Go中的Slice" class="headerlink" title="Go中的Slice"></a>Go中的Slice</h3><ul>
<li>相应笔记在代码中哦！！</li>
</ul>
<pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
   <span class="token string">"fmt"</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">printArray</span><span class="token punctuation">(</span>myArray <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span>val <span class="token operator">:=</span> <span class="token keyword">range</span> myArray <span class="token punctuation">{</span>
      fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span>
   <span class="token punctuation">}</span>

   myArray<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">100</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token comment">//固定长度数组</span>
   <span class="token keyword">var</span> myArray1 <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token builtin">int</span>
   myArray2 <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">}</span>

   <span class="token comment">//第一种遍历方式</span>
   <span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token function">len</span><span class="token punctuation">(</span>myArray1<span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
      fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>myArray1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
   
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"================"</span><span class="token punctuation">)</span>
   
   <span class="token comment">//第二种方式</span>
   <span class="token keyword">for</span> index<span class="token punctuation">,</span> value <span class="token operator">:=</span> <span class="token keyword">range</span> myArray2 <span class="token punctuation">{</span>
      fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"index = "</span><span class="token punctuation">,</span>index<span class="token punctuation">,</span><span class="token string">",value = "</span><span class="token punctuation">,</span>value<span class="token punctuation">)</span>
   <span class="token punctuation">}</span>

   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"================"</span><span class="token punctuation">)</span>

   <span class="token comment">//查看数组的数据类型</span>
   fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"myArray1 type = %T\n"</span><span class="token punctuation">,</span> myArray1<span class="token punctuation">)</span>
   fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"myArray2 type = %T\n"</span><span class="token punctuation">,</span> myArray2<span class="token punctuation">)</span>

   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"================"</span><span class="token punctuation">)</span>

   <span class="token comment">//不同长度数组的类型都不一样，那咱怎么传参呢？？？不可能给每个长度的数组定制啊，这也太麻烦了！！！</span>
   <span class="token comment">//引入我们的动态数组的概念</span>
   <span class="token comment">//注意，如果传参是myArray [10]int这种形式，本质是传值，如果是myArray []int这种动态数组，本质是传址</span>
   myArray <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">}</span> <span class="token comment">//这个也是动态数组的表示方式哦！！！最大的区别，就是没有写长度嗷！！！</span>
   fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"myArray type = %T\n"</span><span class="token punctuation">,</span> myArray<span class="token punctuation">)</span>
   <span class="token function">printArray</span><span class="token punctuation">(</span>myArray<span class="token punctuation">)</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"===="</span><span class="token punctuation">)</span>
   <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> value <span class="token operator">:=</span> <span class="token keyword">range</span> myArray <span class="token punctuation">{</span>
      fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
   <span class="token punctuation">}</span>

   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"================"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>注意上面哦！！！如果我们写死了传递的数组如：<code>myArray [4]int</code>这样的话，本质上也是值拷贝，不好修改元素，也不方便传值嗷！！！由此，动态数组非常重要嗷！！！</li>
<li>动态数组在传参上使用的类似于Java的引用传递，而且不同元素长度的动态数组，他们的形参是一致的嗷！！！</li>
</ul>
<h4 id="Slice的声明方式"><a href="#Slice的声明方式" class="headerlink" title="Slice的声明方式"></a>Slice的声明方式</h4><pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token comment">//第一种哦！！！</span>
   slice1 <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">}</span>
   fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"len = %d, slice = %v\n"</span><span class="token punctuation">,</span><span class="token function">len</span><span class="token punctuation">(</span>slice1<span class="token punctuation">)</span><span class="token punctuation">,</span>slice1<span class="token punctuation">)</span>

   <span class="token comment">//第二种</span>
   <span class="token keyword">var</span> slice2 <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span> <span class="token comment">//声明slice2是一个切片，但是没有给他分配空间嗷！！！这个时候直接slice[0] = 100是错误的，因为这个空间都不存在嗷！！！</span>
   slice2 <span class="token operator">=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span> <span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token comment">// 为这个slice分配空间，默认值都是0哈！！！</span>
   fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"len = %d, slice = %v\n"</span><span class="token punctuation">,</span><span class="token function">len</span><span class="token punctuation">(</span>slice2<span class="token punctuation">)</span><span class="token punctuation">,</span>slice2<span class="token punctuation">)</span>

   <span class="token comment">//第三种，声明的同时为其分配空间嗷！！！</span>
   <span class="token keyword">var</span> slice3 <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span> <span class="token operator">=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
   fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"len = %d, slice = %v\n"</span><span class="token punctuation">,</span><span class="token function">len</span><span class="token punctuation">(</span>slice3<span class="token punctuation">)</span><span class="token punctuation">,</span>slice3<span class="token punctuation">)</span>

   <span class="token comment">//第四种，通过给遍历分配空间，通过:=推导出slice是一个切片</span>
   slice4 <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
   fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"len = %d, slice = %v\n"</span><span class="token punctuation">,</span><span class="token function">len</span><span class="token punctuation">(</span>slice4<span class="token punctuation">)</span><span class="token punctuation">,</span>slice4<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>常用分配空间方式</li>
</ul>
<pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">if</span> slice <span class="token operator">==</span> <span class="token boolean">nil</span><span class="token punctuation">{</span>
    slice <span class="token operator">=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>



<h4 id="Slice的使用方式"><a href="#Slice的使用方式" class="headerlink" title="Slice的使用方式"></a>Slice的使用方式</h4><ul>
<li>切片容量追加</li>
</ul>
<pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">var</span> numbers <span class="token operator">=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span> <span class="token punctuation">,</span> <span class="token number">3</span> <span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"len = %d , cap = %d , slice = %v\n"</span><span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>numbers<span class="token punctuation">)</span> <span class="token punctuation">,</span> <span class="token function">cap</span><span class="token punctuation">(</span>numbers<span class="token punctuation">)</span> <span class="token punctuation">,</span> numbers<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211016155338.png" alt="image-20211016155330391">ptr指向合法空间末尾，后面两个格子是非法空间，虽然无法访问，但是为位置已经开辟好了嗷！！！</p>
<ul>
<li>追加两个元素：</li>
</ul>
<pre class="line-numbers language-go" data-language="go"><code class="language-go">numbers <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>numbers<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
numbers <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>numbers<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>向numbers中追加两个元素，这个时候numbers已经满了。</p>
<ul>
<li>numbers已经满了，再向其中添加内容怎么办？</li>
</ul>
<blockquote>
<p>go会自动帮助我们再去开辟一段空间，默认容量拓展为原来容量的两倍（切片扩容机制）</p>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211016155711.png" alt="image-20211016155711564"></p>
</blockquote>
<ul>
<li>如果不指定cap，默认的cap和你分配的len是一样嗷！！！</li>
<li>切片的截取：</li>
</ul>
<pre class="line-numbers language-go" data-language="go"><code class="language-go">s <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">}</span>

<span class="token comment">//第一种方式，startIndex : endIndex</span>
s1 <span class="token operator">:=</span> s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span>
<span class="token comment">//下面这种表示全部元素，还有类似的</span>
s2 <span class="token operator">:=</span> s<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
s<span class="token punctuation">[</span>startIndex<span class="token punctuation">:</span><span class="token punctuation">]</span>
s<span class="token punctuation">[</span><span class="token punctuation">:</span>endIndex<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>截取本质：</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211016160146.png" alt="image-20211016160146239"></p>
<p>默认截取指向的底层切片是同一个！！</p>
<p>如果我想要完成copy呢？</p>
<p><code>s2 := make([]int , 3)</code></p>
<p><code>copy(s3, s)</code></p>
<p>这个就类似于Java中的浅拷贝和深拷贝，上面这个意思就是将s中的内容依次拷贝到s3中嗷！！！</p>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211016160419.png" alt="image-20211016160418875"></p>
<h3 id="Go中的Map"><a href="#Go中的Map" class="headerlink" title="Go中的Map"></a>Go中的Map</h3><h4 id="Map的声明方式"><a href="#Map的声明方式" class="headerlink" title="Map的声明方式"></a>Map的声明方式</h4><pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token comment">//===》 第一种方式：声明myMap1是一个map，key和value都为string，和slice一样，这样声明map底层是没有空间的嗷</span>
   <span class="token keyword">var</span> myMap1 <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">string</span>
   <span class="token keyword">if</span> myMap1 <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
      fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"myMap1 is an empty map!!!"</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span>

   myMap1 <span class="token operator">=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">string</span> <span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
   myMap1<span class="token punctuation">[</span><span class="token string">"one"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"java"</span>
   myMap1<span class="token punctuation">[</span><span class="token string">"two"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"python"</span>
   myMap1<span class="token punctuation">[</span><span class="token string">"three"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"c++"</span>

   <span class="token comment">//如果我的map赋值赋满了，底层也会自动帮助我们开辟空间，和slice是一样的嗷！！！</span>
   fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"%v , %d\n"</span> <span class="token punctuation">,</span> myMap1<span class="token punctuation">,</span><span class="token function">len</span><span class="token punctuation">(</span>myMap1<span class="token punctuation">)</span><span class="token punctuation">)</span>

   <span class="token comment">//===》 第二种方式：可以不指定长度哦，自动会给我们分配长度的</span>
   myMap2 <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">)</span>
   myMap2<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"java"</span>

   <span class="token comment">//===》 第三种方式</span>
   myMap3 <span class="token operator">:=</span> <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span>
      <span class="token string">"one"</span><span class="token punctuation">:</span> <span class="token string">"php"</span><span class="token punctuation">,</span>
      <span class="token string">"two"</span><span class="token punctuation">:</span> <span class="token string">"python"</span><span class="token punctuation">,</span>
   <span class="token punctuation">}</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>myMap3<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>和Java很像，声明了一个这种变量，一定要初始化（在Go中叫做分配空间），才能够使用嗷！！！</p>
<h4 id="Map的使用方式"><a href="#Map的使用方式" class="headerlink" title="Map的使用方式"></a>Map的使用方式</h4><ul>
<li>增删改查：</li>
</ul>
<pre class="line-numbers language-go" data-language="go"><code class="language-go">cityMap <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">)</span>

<span class="token comment">//添加</span>
cityMap<span class="token punctuation">[</span><span class="token string">"china"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"BeiJing"</span>
cityMap<span class="token punctuation">[</span><span class="token string">"Japan"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"Tokyo"</span>
cityMap<span class="token punctuation">[</span><span class="token string">"USA"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"NewYork"</span>

<span class="token comment">//删除</span>
<span class="token function">delete</span><span class="token punctuation">(</span>cityMap <span class="token punctuation">,</span> <span class="token string">"Japan"</span><span class="token punctuation">)</span>

<span class="token comment">//修改</span>
cityMap<span class="token punctuation">[</span><span class="token string">"USA"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"DC"</span>

<span class="token comment">//遍历</span>
<span class="token keyword">for</span> key<span class="token punctuation">,</span> value <span class="token operator">:=</span> <span class="token keyword">range</span> cityMap<span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"key = "</span><span class="token punctuation">,</span>key<span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"value = "</span><span class="token punctuation">,</span>value<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>定义打印Map的函数</li>
</ul>
<pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">printMap</span><span class="token punctuation">(</span>cityMap <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">for</span> key<span class="token punctuation">,</span> value <span class="token operator">:=</span> <span class="token keyword">range</span> cityMap<span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"key = "</span><span class="token punctuation">,</span>key<span class="token punctuation">)</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"value = "</span><span class="token punctuation">,</span>value<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">changeValue</span><span class="token punctuation">(</span>cityMap <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    cityMap<span class="token punctuation">[</span><span class="token string">"England"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"London"</span>
<span class="token punctuation">}</span>

<span class="token comment">//调用</span>
<span class="token function">printMap</span><span class="token punctuation">(</span>cityMap<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这里要注意，调用这个函数的时候，本质上是一个引用传递，实质上传递的是cityMap的指针嗷！！！指向的是同一块空间嗷！！！</p>
<h3 id="struct的基本定义和使用"><a href="#struct的基本定义和使用" class="headerlink" title="struct的基本定义和使用"></a>struct的基本定义和使用</h3><ul>
<li>结构体基本使用，函数定义（传值或传址）</li>
</ul>
<pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">"fmt"</span>

<span class="token keyword">type</span> myint <span class="token builtin">int</span>

<span class="token keyword">type</span> Book <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	title <span class="token builtin">string</span>
	auth <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">changeBook</span><span class="token punctuation">(</span>book Book<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">//传递一个Book的副本</span>
	book<span class="token punctuation">.</span>auth <span class="token operator">=</span> <span class="token string">"tuzijiejie"</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">changeBook2</span><span class="token punctuation">(</span>book <span class="token operator">*</span>Book<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">//传递一个Book的指针</span>
	book<span class="token punctuation">.</span>auth <span class="token operator">=</span> <span class="token string">"tuzijiejie"</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> a myint <span class="token operator">=</span> <span class="token number">10</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"a = "</span><span class="token punctuation">,</span>a<span class="token punctuation">)</span>

	<span class="token keyword">var</span> book1 Book
	book1<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">"Golang"</span>
	book1<span class="token punctuation">.</span>auth <span class="token operator">=</span> <span class="token string">"tuzi"</span>

	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"%v\n"</span><span class="token punctuation">,</span>book1<span class="token punctuation">)</span>

	<span class="token function">changeBook</span><span class="token punctuation">(</span>book1<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"%v\n"</span><span class="token punctuation">,</span>book1<span class="token punctuation">)</span>

	<span class="token function">changeBook2</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>book1<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"%v\n"</span><span class="token punctuation">,</span>book1<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="类的表示："><a href="#类的表示：" class="headerlink" title="类的表示："></a>类的表示：</h4><ul>
<li>将结构体和方法分开，此外要注意大小写，大写才是能够被外部访问到的嗷！！！</li>
</ul>
<p>下面这一个struct搭配上下面专属的方法，构成了一个完整的类嗷！！！</p>
<pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">type</span> Hero <span class="token keyword">struct</span><span class="token punctuation">{</span>
    Name <span class="token builtin">string</span>
    Ad <span class="token builtin">int</span>
    Level <span class="token builtin">int</span>
<span class="token punctuation">}</span>

<span class="token comment">//(this Hero)这种是传值嗷！！！打咩，只有*才是传地址，才可以改变属性嗷！！！</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>this <span class="token operator">*</span>Hero<span class="token punctuation">)</span> <span class="token function">GetName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"Name = "</span><span class="token punctuation">,</span> this<span class="token punctuation">.</span>Name<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>this <span class="token operator">*</span>Hero<span class="token punctuation">)</span> <span class="token function">SetName</span><span class="token punctuation">(</span>newName <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    this<span class="token punctuation">.</span>name <span class="token operator">=</span> newName
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>this <span class="token operator">*</span>Hero<span class="token punctuation">)</span> <span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"Name = "</span><span class="token punctuation">,</span>this<span class="token punctuation">.</span>Name<span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"Ad = "</span><span class="token punctuation">,</span>this<span class="token punctuation">.</span>Ad<span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"Level = "</span><span class="token punctuation">,</span>this<span class="token punctuation">.</span>Level<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>this Hero指的是和Hero这个struct绑定，调用这个属性的是Hero对象，实际调用的对象可以用this来指代</p>
<ul>
<li>创建对象：</li>
</ul>
<pre class="line-numbers language-go" data-language="go"><code class="language-go">hero <span class="token operator">:=</span> Hero<span class="token punctuation">{</span>Name<span class="token punctuation">:</span> <span class="token string">"tuzi"</span><span class="token punctuation">,</span> Ad<span class="token punctuation">:</span> <span class="token number">100</span> <span class="token punctuation">,</span> Level<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">}</span>
hero<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

hero<span class="token punctuation">.</span><span class="token function">SetName</span><span class="token punctuation">(</span><span class="token string">"lisi"</span><span class="token punctuation">)</span>
hero<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>虽然语法没有任何错误，但是所有的方法传入的对象（this Hero），都是该对象的一个副本（拷贝）</p>
<p>因此要改为 <strong>指针</strong> ！！！（this *Hero），这样写，当对象调用的时候，才默认是传递引用嗷！！！</p>
<ul>
<li>大写与小写：</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211016165449.png" alt="image-20211016165448638"></p>
<p>例如Level -&gt; level，这个只有类中可以访问嗷！！！如果方法是大写，其他的包中是能够访问的。但是如果是小写，只有本包之内能访问这个方法。</p>
<h4 id="类的继承："><a href="#类的继承：" class="headerlink" title="类的继承："></a>类的继承：</h4><pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">"fmt"</span>

<span class="token comment">//父类</span>
<span class="token keyword">type</span> Human <span class="token keyword">struct</span> <span class="token punctuation">{</span>
   name <span class="token builtin">string</span>
   sex <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>this <span class="token operator">*</span>Human<span class="token punctuation">)</span> <span class="token function">Eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"Human eat ......"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>this <span class="token operator">*</span>Human<span class="token punctuation">)</span> <span class="token function">Walk</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"Human walk ......"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">//=====================================================</span>

<span class="token comment">//子类</span>
<span class="token keyword">type</span> SuperMan <span class="token keyword">struct</span> <span class="token punctuation">{</span>
   Human <span class="token comment">// 这么写就表示继承了Human这个类</span>

   level <span class="token builtin">int</span>
<span class="token punctuation">}</span>

<span class="token comment">//重定义父类方法</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>this <span class="token operator">*</span>SuperMan<span class="token punctuation">)</span> <span class="token function">Eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"SuperHuman eat ......"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">//子类新方法</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>this <span class="token operator">*</span>SuperMan<span class="token punctuation">)</span> <span class="token function">Fly</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"SuperHuman fly ......"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>this <span class="token operator">*</span>SuperMan<span class="token punctuation">)</span> <span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"========================"</span><span class="token punctuation">)</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"name = "</span><span class="token punctuation">,</span>this<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"gender = "</span><span class="token punctuation">,</span>this<span class="token punctuation">.</span>sex<span class="token punctuation">)</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"level = "</span><span class="token punctuation">,</span>this<span class="token punctuation">.</span>level<span class="token punctuation">)</span>
<span class="token punctuation">}</span>



<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token comment">//定义父类对象</span>
   h <span class="token operator">:=</span> Human<span class="token punctuation">{</span><span class="token string">"zhang3"</span><span class="token punctuation">,</span><span class="token string">"male"</span><span class="token punctuation">}</span>

   h<span class="token punctuation">.</span><span class="token function">Eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   h<span class="token punctuation">.</span><span class="token function">Walk</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"======================"</span><span class="token punctuation">)</span>

   <span class="token comment">//定义子类对象</span>
   s <span class="token operator">:=</span> SuperMan<span class="token punctuation">{</span>Human<span class="token punctuation">{</span><span class="token string">"Clerk"</span><span class="token punctuation">,</span><span class="token string">"male"</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">}</span>
   s<span class="token punctuation">.</span><span class="token function">Eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//子类重写的方法</span>
   s<span class="token punctuation">.</span><span class="token function">Walk</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//父类定义的方法</span>
   s<span class="token punctuation">.</span><span class="token function">Fly</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//子类新增的方法</span>

   <span class="token comment">//子类定义对象的另外一种方式</span>
   <span class="token keyword">var</span> s2 SuperMan
   s2<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"Alexander Liu"</span>
   s2<span class="token punctuation">.</span>sex <span class="token operator">=</span> <span class="token string">"male"</span>
   s2<span class="token punctuation">.</span>level <span class="token operator">=</span> <span class="token number">88</span>
   s2<span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="Interface的基本定义和使用"><a href="#Interface的基本定义和使用" class="headerlink" title="Interface的基本定义和使用"></a>Interface的基本定义和使用</h3><h4 id="多态的实现："><a href="#多态的实现：" class="headerlink" title="多态的实现："></a>多态的实现：</h4><pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">"fmt"</span>

<span class="token comment">//本质上是一个指针</span>
<span class="token keyword">type</span> Animal <span class="token keyword">interface</span> <span class="token punctuation">{</span>
   <span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token function">GetColor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token comment">//获取动物的颜色</span>
   <span class="token function">GetType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token comment">//获得动物的种类</span>
<span class="token punctuation">}</span>

<span class="token comment">//具体的类1</span>
<span class="token keyword">type</span> Cat <span class="token keyword">struct</span> <span class="token punctuation">{</span>
<span class="token comment">// 继承接口甚至都不用写继承，直接把接口中的方法全部实现就行了嗷！！！</span>
   color <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>this <span class="token operator">*</span>Cat<span class="token punctuation">)</span> <span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"Cat is sleeping"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>this <span class="token operator">*</span>Cat<span class="token punctuation">)</span> <span class="token function">GetColor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
   <span class="token keyword">return</span> this<span class="token punctuation">.</span>color
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>this <span class="token operator">*</span>Cat<span class="token punctuation">)</span> <span class="token function">GetType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
   <span class="token keyword">return</span> <span class="token string">"Cat"</span>
<span class="token punctuation">}</span>

<span class="token comment">//具体的类2</span>
<span class="token keyword">type</span> Dog <span class="token keyword">struct</span> <span class="token punctuation">{</span>
   <span class="token comment">// 继承接口甚至都不用写继承，直接把接口中的方法全部实现就行了嗷！！！</span>
   color <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>this <span class="token operator">*</span>Dog<span class="token punctuation">)</span> <span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"Dog is sleeping"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>this <span class="token operator">*</span>Dog<span class="token punctuation">)</span> <span class="token function">GetColor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
   <span class="token keyword">return</span> this<span class="token punctuation">.</span>color
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>this <span class="token operator">*</span>Dog<span class="token punctuation">)</span> <span class="token function">GetType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
   <span class="token keyword">return</span> <span class="token string">"Dog"</span>
<span class="token punctuation">}</span>

<span class="token comment">//定义接口的方法</span>
<span class="token keyword">func</span> <span class="token function">showAnimal</span><span class="token punctuation">(</span>animal Animal<span class="token punctuation">)</span>  <span class="token punctuation">{</span>
   animal<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"kind = "</span><span class="token punctuation">,</span>animal<span class="token punctuation">.</span><span class="token function">GetType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"color = "</span><span class="token punctuation">,</span>animal<span class="token punctuation">.</span><span class="token function">GetColor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">//完全实现了所有的方法，接口的指针才能够具体的实现类</span>
<span class="token comment">//什么是多态：接口指针指向具体的实现类，由于实现类的不同，导致状态也不一样嗷！！！</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">var</span> animal Animal

   animal <span class="token operator">=</span> <span class="token operator">&amp;</span>Cat<span class="token punctuation">{</span><span class="token string">"White"</span><span class="token punctuation">}</span>

   <span class="token function">showAnimal</span><span class="token punctuation">(</span>animal<span class="token punctuation">)</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"============="</span><span class="token punctuation">)</span>

   animal <span class="token operator">=</span> <span class="token operator">&amp;</span>Dog<span class="token punctuation">{</span><span class="token string">"Black"</span><span class="token punctuation">}</span>

   <span class="token function">showAnimal</span><span class="token punctuation">(</span>animal<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>多态的基本要素：<ol>
<li>有一个父类（有接口）。</li>
<li>有子类（实现了父类的全部接口方法）。</li>
<li>父类的类型的变量（指针）指向（引用）子类的具体数据变量。</li>
</ol>
</li>
</ul>
<h4 id="通用万能类型（空接口）："><a href="#通用万能类型（空接口）：" class="headerlink" title="通用万能类型（空接口）："></a>通用万能类型（空接口）：</h4><ul>
<li>interface {}</li>
<li>所有的int , string , float64 , struct ……都实现了interface{} ——&gt; 可以使用interface {} 类型引用任意的数据类型。</li>
<li>本质上空接口没有方法，也就是所有类型都实现了空接口，因此空接口可以调用任何类型的数据。</li>
</ul>
<pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">"fmt"</span>

<span class="token comment">//interface是万能数据类型</span>
<span class="token keyword">func</span> <span class="token function">myFunc</span><span class="token punctuation">(</span>arg <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"MyFunc is called ... "</span><span class="token punctuation">)</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span>

   <span class="token comment">//interface{} 如何区分引用的底层数据类型是什么</span>

   <span class="token comment">//底层有“类型断言机制”</span>
   value <span class="token punctuation">,</span> ok <span class="token operator">:=</span> arg<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">)</span>
   <span class="token keyword">if</span> <span class="token operator">!</span>ok <span class="token punctuation">{</span>
      fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"arg is not string type"</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
      fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"arg is string , value = "</span><span class="token punctuation">,</span>value<span class="token punctuation">)</span>
      fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"value type is %T\n"</span><span class="token punctuation">,</span>arg<span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token function">myFunc</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"============="</span><span class="token punctuation">)</span>
   <span class="token function">myFunc</span><span class="token punctuation">(</span><span class="token string">"0"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>类型断言为什么会成功？</li>
</ul>
<p>底层变量的构造：</p>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211017102801.png" alt="image-20211017102801380"></p>
<pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">var</span> a <span class="token builtin">string</span>
a <span class="token operator">=</span> <span class="token string">"abc"</span>
<span class="token comment">//pair&lt;static type:string , value:"abc"&gt;</span>

<span class="token keyword">var</span> allType <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
allType <span class="token operator">=</span> a
<span class="token comment">//pair&lt;type: string , value:"abc"&gt;</span>

str <span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> allType<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">)</span>
<span class="token comment">//这个断言会去查找上面的pair，判断这个type和你的判断类型是否相等嗷！！！</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>具体类型：</p>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211017103355.png" alt="image-20211017103354620"></p>
<ul>
<li>另外一个小例子：</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211017103856.png" alt="image-20211017103856558"></p>
<p>虽然拿着它的Interface一直在变，但是在记录的pair中的数据，始终如一嗷！！！</p>
<h3 id="Reflect反射机制"><a href="#Reflect反射机制" class="headerlink" title="Reflect反射机制"></a>Reflect反射机制</h3><ul>
<li><p>这里的反射机制要承接上面的pair &lt;type , value&gt;使用哦</p>
</li>
<li><p>允许我们把变量的原型给他造出来</p>
</li>
</ul>
<p>常用方式：</p>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211018192045.png" alt="image-20211018192044873"></p>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211018192059.png" alt="image-20211018192059582"></p>
<p>下面这两个其实就是获得了传入的interface的pair来获得了对应的类型信息。</p>
<ul>
<li>使用代码：</li>
</ul>
<pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"fmt"</span>
	<span class="token string">"reflect"</span>
<span class="token punctuation">)</span>


<span class="token keyword">type</span> User <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	Id <span class="token builtin">int</span>
	Name <span class="token builtin">string</span>
	Age <span class="token builtin">int</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>this <span class="token operator">*</span>User<span class="token punctuation">)</span> <span class="token function">Call</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"user is called ... "</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"%v\n"</span><span class="token punctuation">,</span>this<span class="token punctuation">)</span>
<span class="token punctuation">}</span>


<span class="token keyword">func</span> <span class="token function">reflectNum</span><span class="token punctuation">(</span>arg <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"type : "</span><span class="token punctuation">,</span>reflect<span class="token punctuation">.</span><span class="token function">TypeOf</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"value : "</span><span class="token punctuation">,</span>reflect<span class="token punctuation">.</span><span class="token function">ValueOf</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">DoFiledAndMethod</span><span class="token punctuation">(</span>input <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">//获取input的type</span>
	inputType <span class="token operator">:=</span> reflect<span class="token punctuation">.</span><span class="token function">TypeOf</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"input type is : "</span><span class="token punctuation">,</span>inputType<span class="token punctuation">.</span><span class="token function">Name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

	<span class="token comment">//获取input的value</span>
	inputValue <span class="token operator">:=</span> reflect<span class="token punctuation">.</span><span class="token function">ValueOf</span><span class="token punctuation">(</span>inputType<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Elem</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"input value is : "</span><span class="token punctuation">,</span>inputValue<span class="token punctuation">)</span>

	<span class="token comment">//通过type获取里面的字段</span>
	<span class="token comment">//1. 获取interface的reflect.type，通过type得到NumField，进行遍历</span>
	<span class="token comment">//2. 得到每个field，数据类型</span>
	<span class="token comment">//3. 通过field又一个Interface{}方法得到对应的value</span>
	<span class="token comment">//for i := 0; i &lt; inputType.NumField(); i++ {</span>
	<span class="token comment">//	field := inputType.Field(i)</span>
	<span class="token comment">//	value := inputValue.Field(i).Elem()</span>
	<span class="token comment">//</span>
	<span class="token comment">//	fmt.Printf("%s : %v = %v\n",field.Name,field.Type,value)</span>
	<span class="token comment">//}</span>

	<span class="token comment">//通过type获取里面的方法</span>
	<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> inputType<span class="token punctuation">.</span><span class="token function">NumMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
		m <span class="token operator">:=</span> inputType<span class="token punctuation">.</span><span class="token function">Method</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"%s: %v\n"</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>Name<span class="token punctuation">,</span>m<span class="token punctuation">.</span>Type<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	num <span class="token operator">:=</span> <span class="token number">3.1415926525</span>

	<span class="token function">reflectNum</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span>

	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"==================="</span><span class="token punctuation">)</span>

	user <span class="token operator">:=</span> User<span class="token punctuation">{</span>
		Id<span class="token punctuation">:</span>   <span class="token number">22</span><span class="token punctuation">,</span>
		Name<span class="token punctuation">:</span> <span class="token string">"Alexander liu"</span><span class="token punctuation">,</span>
		Age<span class="token punctuation">:</span>  <span class="token number">19</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>

	<span class="token function">DoFiledAndMethod</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="反射解析结构体标签tag"><a href="#反射解析结构体标签tag" class="headerlink" title="反射解析结构体标签tag"></a>反射解析结构体标签tag</h4><pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
   <span class="token string">"fmt"</span>
   <span class="token string">"reflect"</span>
<span class="token punctuation">)</span>

<span class="token keyword">type</span> resume <span class="token keyword">struct</span> <span class="token punctuation">{</span>
   Name <span class="token builtin">string</span> <span class="token string">`info:"name" doc:"我的名字"`</span>
   Sex <span class="token builtin">string</span> <span class="token string">`info:"sex"`</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">findTag</span><span class="token punctuation">(</span>str <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   t <span class="token operator">:=</span> reflect<span class="token punctuation">.</span><span class="token function">TypeOf</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Elem</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

   <span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> t<span class="token punctuation">.</span><span class="token function">NumField</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
      tagString <span class="token operator">:=</span> t<span class="token punctuation">.</span><span class="token function">Field</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span>Tag<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">"info"</span><span class="token punctuation">)</span>
      tagdoc <span class="token operator">:=</span> t<span class="token punctuation">.</span><span class="token function">Field</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span>Tag<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">"doc"</span><span class="token punctuation">)</span>

      fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"info: "</span><span class="token punctuation">,</span> tagString <span class="token punctuation">,</span> <span class="token string">" doc: "</span><span class="token punctuation">,</span>tagdoc<span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">var</span> re resume

   <span class="token function">findTag</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>re<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="结构体标签在JSON中的使用"><a href="#结构体标签在JSON中的使用" class="headerlink" title="结构体标签在JSON中的使用"></a>结构体标签在JSON中的使用</h4><pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
   <span class="token string">"encoding/json"</span>
   <span class="token string">"fmt"</span>
<span class="token punctuation">)</span>

<span class="token keyword">type</span> Movie <span class="token keyword">struct</span> <span class="token punctuation">{</span>
   <span class="token comment">//后面的json后面就是json中对应的标签</span>
   Title <span class="token builtin">string</span> <span class="token string">`json:"title"`</span>
   Year <span class="token builtin">int</span> <span class="token string">`json:"year"`</span>
   Price <span class="token builtin">int</span>  <span class="token string">`json:"rmb"`</span>
   Actors <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span> <span class="token string">`json:"actors"`</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   movie <span class="token operator">:=</span> Movie<span class="token punctuation">{</span>
      Title<span class="token punctuation">:</span>  <span class="token string">"Avengers"</span><span class="token punctuation">,</span>
      Year<span class="token punctuation">:</span>   <span class="token number">2019</span><span class="token punctuation">,</span>
      Price<span class="token punctuation">:</span>  <span class="token number">142</span><span class="token punctuation">,</span>
      Actors<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">"Iron Man"</span><span class="token punctuation">,</span><span class="token string">"Thor"</span><span class="token punctuation">,</span><span class="token string">"Hulk"</span><span class="token punctuation">,</span><span class="token string">"Vision"</span><span class="token punctuation">,</span><span class="token string">"Captain America"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
   <span class="token punctuation">}</span>

   <span class="token comment">//编码的过程   结构体---&gt;json</span>
   jsonStr<span class="token punctuation">,</span> err <span class="token operator">:=</span> json<span class="token punctuation">.</span><span class="token function">Marshal</span><span class="token punctuation">(</span>movie<span class="token punctuation">)</span>
   <span class="token keyword">if</span> err<span class="token operator">!=</span><span class="token boolean">nil</span> <span class="token punctuation">{</span>
      fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"json marshal error"</span><span class="token punctuation">,</span>err<span class="token punctuation">)</span>
      <span class="token keyword">return</span>
   <span class="token punctuation">}</span>

   fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"jsonStr = %s\n"</span><span class="token punctuation">,</span>jsonStr<span class="token punctuation">)</span>
    
    <span class="token comment">//解码的过程 jsonStr ---&gt; 结构体</span>
    my_movie <span class="token operator">:=</span> Movie<span class="token punctuation">{</span><span class="token punctuation">}</span>
    err <span class="token operator">=</span> json<span class="token punctuation">.</span><span class="token function">Unmarshal</span><span class="token punctuation">(</span>jsonStr<span class="token punctuation">,</span><span class="token operator">&amp;</span>myMovie<span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span><span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"json unmarshal error"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"%v\n"</span><span class="token punctuation">,</span>myMovie<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>可以看一下JSON的结果哦！！！</li>
</ul>
<p><code>jsonStr = {"title":"Avengers","year":2019,"rmb":142,"actors":["Iron Man","Thor","Hulk","Vision","Captain America"]}</code></p>
<p>可以看到这里的标签就是我们上面的tag中的标签哦！！！和Java相比，多了一种方式嗷！！！</p>
<h1 id="GoRoutine"><a href="#GoRoutine" class="headerlink" title="GoRoutine"></a>GoRoutine</h1><h2 id="设计策略："><a href="#设计策略：" class="headerlink" title="设计策略："></a>设计策略：</h2><ol>
<li>复用内核级线程</li>
</ol>
<ul>
<li>多线程，多进程解决了阻塞的问题，但是还是有问题！！！</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211020204527.png" alt="image-20211020204519579"></p>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211020205213.png" alt="image-20211020205213128"></p>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211020205235.png" alt="image-20211020205234515"></p>
<ul>
<li>go-routine的引入：</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211020205350.png" alt="image-20211020205350253"></p>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211020205405.png" alt="image-20211020205405129"></p>
<p>M:N关系：</p>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211020205456.png" alt="image-20211020205456336"></p>
<p>GMP：</p>
<p>G -&gt; goroutine协程</p>
<p>P -&gt; processor处理器</p>
<p>M -&gt; thread线程（内核态线程）</p>
<p>整体结构：</p>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211020210016.png" alt="image-20211020210016275"></p>
<ul>
<li>Work Stealing机制：</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211020210235.png" alt="image-20211020210234665">自己的没了，从旁边的队列偷一个过来执行，偷取机制！！！</p>
<ul>
<li>Hand Off机制：</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211020210436.png" alt="image-20211020210435926"></p>
<p>分离机制，一个携程卡死了，CPU里面进行M的切换，队列也发生改变，让阻塞的阻塞去吧，我继续干活了嗷！！！</p>
<ol start="2">
<li>利用并行</li>
</ol>
<p>GOMAXPROCS限定P的个数 = CPU核数 / 2</p>
<ol start="3">
<li>抢占：</li>
</ol>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211020210713.png" alt="image-20211020210712773"></p>
<ol start="4">
<li>全局G队列</li>
</ol>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211020210745.png" alt="image-20211020210745336"></p>
<h2 id="创建GoRoutine："><a href="#创建GoRoutine：" class="headerlink" title="创建GoRoutine："></a>创建GoRoutine：</h2><pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
   <span class="token string">"fmt"</span>
   <span class="token string">"time"</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">newTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   i <span class="token operator">:=</span> <span class="token number">0</span>
   <span class="token keyword">for</span> <span class="token punctuation">{</span>
      i<span class="token operator">++</span>
      fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"new Gouroutine : i = %d\n"</span><span class="token punctuation">,</span>i<span class="token punctuation">)</span>
      time<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">*</span> time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token comment">//创建一个go程</span>
   <span class="token comment">//第一种方式，定义方法，用go去执行</span>
   <span class="token keyword">go</span> <span class="token function">newTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

   <span class="token comment">//所有的子goroutine空间都是从main给的</span>
   <span class="token comment">//main退出了，其他的子goroutine都会退出嗷！！！！</span>

   <span class="token comment">//第二种方法，匿名函数跑跑跑！！！</span>
   <span class="token keyword">go</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">defer</span> fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"B.defer"</span><span class="token punctuation">)</span>
      <span class="token comment">//退出当前GoRoutine，不影响其他Goroutine</span>
      <span class="token comment">//runtime.Goexit()</span>
      <span class="token comment">//直接让整个Go程序退出</span>
      <span class="token comment">//return</span>
      
      fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"B"</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

   <span class="token comment">//第二种方法（二），匿名+参数</span>
   <span class="token comment">//这里的返回值是拿不到的嗷！！！</span>
   <span class="token comment">//本来就是并行的，我都往下走了，我还回头把值返回给你吗？？？？？？</span>
   <span class="token keyword">go</span> <span class="token keyword">func</span><span class="token punctuation">(</span>a <span class="token builtin">int</span><span class="token punctuation">,</span> b <span class="token builtin">int</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>
      fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>a <span class="token operator">+</span> b<span class="token punctuation">)</span>
   <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span>

   i <span class="token operator">:=</span> <span class="token number">0</span>
   <span class="token keyword">for</span> i <span class="token operator">!=</span> <span class="token number">5</span><span class="token punctuation">{</span>
      i <span class="token operator">++</span>
      fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"             main goroutine : i = %d\n"</span><span class="token punctuation">,</span>i<span class="token punctuation">)</span>
      time<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">*</span> time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/inthat/article/details/118531656">Goroutine中exit函数的使用！！！</a></li>
</ul>
<h2 id="通信机制Channel："><a href="#通信机制Channel：" class="headerlink" title="通信机制Channel："></a>通信机制Channel：</h2><ul>
<li><p>本身就是一种数据类型，具有同步两个goroutine的能力嗷！！！如果队列中没有数据读取数据会阻塞！！！当其中有数据的时候，会通知刚刚阻塞的线程嗷！！！</p>
</li>
<li><p>创建channel：</p>
</li>
</ul>
<p><code>make(chan Type, capacity)</code></p>
<pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token comment">//定义一个channel</span>

   c <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">int</span><span class="token punctuation">)</span>

   <span class="token keyword">go</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">defer</span> fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"goroutine结束"</span><span class="token punctuation">)</span>
      time<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>Second<span class="token operator">*</span><span class="token number">5</span><span class="token punctuation">)</span>
      fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"goroutine正在执行"</span><span class="token punctuation">)</span>
      <span class="token comment">//发送数据给channel c</span>
      c <span class="token operator">&lt;-</span> <span class="token number">666</span>
   <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

   <span class="token comment">//接收c并且赋值给变量num</span>
   <span class="token comment">//这里会阻塞嗷！！！！因为上面sleep了，channel中啥都没有，主线程就阻塞在这里了嗷！！！</span>
   num <span class="token operator">:=</span> <span class="token operator">&lt;-</span> c
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"num = "</span><span class="token punctuation">,</span>num<span class="token punctuation">)</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"main goroutine 结束..."</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="无缓冲Channel："><a href="#无缓冲Channel：" class="headerlink" title="无缓冲Channel："></a>无缓冲Channel：</h3><p>示意图：</p>
<p><img src="C:\Users\Alexander\AppData\Roaming\Typora\typora-user-images\image-20211021190714968.png" alt="image-20211021190714968"></p>
<p>上面的代码其实就是无缓冲的channel嗷</p>
<h3 id="有缓冲Channel："><a href="#有缓冲Channel：" class="headerlink" title="有缓冲Channel："></a>有缓冲Channel：</h3><p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211021190751.png" alt="image-20211021190750932"></p>
<ul>
<li>channel满了塞数据就会阻塞，channel空了取数据就会阻塞。</li>
</ul>
<pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   c <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">int</span> <span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token comment">//带有缓冲的channel</span>

   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"len(c) = "</span><span class="token punctuation">,</span><span class="token function">len</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token punctuation">,</span> <span class="token string">" cap(c) = "</span><span class="token punctuation">,</span><span class="token function">cap</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span>

   <span class="token keyword">go</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">defer</span> fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"子go程结束"</span><span class="token punctuation">)</span>

      <span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
         c <span class="token operator">&lt;-</span> i
         fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"子go正在执行，发送的元素是："</span><span class="token punctuation">,</span>i<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

   time<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span>
   <span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
      num <span class="token operator">:=</span> <span class="token operator">&lt;-</span>c <span class="token comment">//从c中接受数据</span>
      fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"num = "</span><span class="token punctuation">,</span>num<span class="token punctuation">)</span>
   <span class="token punctuation">}</span>

   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"main结束了嗷！！！"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="关闭Channel："><a href="#关闭Channel：" class="headerlink" title="关闭Channel："></a>关闭Channel：</h3><ol>
<li>如果不关闭Channel：</li>
</ol>
<pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   c <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">int</span><span class="token punctuation">)</span>

   <span class="token keyword">go</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
         c <span class="token operator">&lt;-</span> i
      <span class="token punctuation">}</span>

      <span class="token comment">//close可以关闭一个channel</span>
      <span class="token comment">//close(c)</span>
      
   <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

   <span class="token keyword">for</span> <span class="token punctuation">{</span>
      <span class="token comment">//ok为true说明channel没有关闭，false的话channel已经关闭了嗷！！！</span>
      <span class="token keyword">if</span> data<span class="token punctuation">,</span> ok <span class="token operator">:=</span> <span class="token operator">&lt;-</span> c<span class="token punctuation">;</span>ok <span class="token punctuation">{</span>
         fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
         <span class="token keyword">break</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>

   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"Main Finished ... "</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211021191846.png" alt="image-20211021191845813"></p>
<p>因为子goroutine退出了，channel没有关闭，main在取数据的时候阻塞，又没有人叫它起来，gg了。</p>
<p>如果关闭了话！！！</p>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211021191959.png" alt="image-20211021191958941"></p>
<ul>
<li>Channel不像文件一样需要经常去关闭，只有当我们没有任何数据要发送了，才关闭channel</li>
<li><strong>关闭channel后再发数据会引发panic，并且接收立即返回零值</strong>。</li>
<li><strong>关闭channel后，可以继续从channel接收数据</strong></li>
<li>对于nil channel，无论收发都会被阻塞嗷！！！（比如声明了一个chan但是并没有make，就是nil咯orz）</li>
</ul>
<h3 id="Channel和range："><a href="#Channel和range：" class="headerlink" title="Channel和range："></a>Channel和range：</h3><ul>
<li>迭代操作Channel的时候我们使用range嗷！！！</li>
</ul>
<pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">for</span> data <span class="token operator">:=</span> <span class="token keyword">range</span> c<span class="token punctuation">{</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>非常好用嗷！！！有的话我就取，没有我就等，关了我就收！！！</p>
<h3 id="Channel和select："><a href="#Channel和select：" class="headerlink" title="Channel和select："></a>Channel和select：</h3><ul>
<li>单流程下一个go只能监控一个channel的状态，select可以监控多个channel的状态！！！</li>
<li>select一般和for搭配一起使用嗷！！！</li>
</ul>
<pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">fibonacci</span><span class="token punctuation">(</span>c <span class="token punctuation">,</span> quit <span class="token keyword">chan</span> <span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   x <span class="token punctuation">,</span> y <span class="token operator">:=</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span>
   <span class="token keyword">for</span>  <span class="token punctuation">{</span>
      <span class="token keyword">select</span> <span class="token punctuation">{</span>
      <span class="token keyword">case</span> c <span class="token operator">&lt;-</span> x<span class="token punctuation">:</span>
         <span class="token comment">//如果c可以写进去，则该case就会进来</span>
         x <span class="token operator">=</span> y
         y <span class="token operator">=</span> x <span class="token operator">+</span> y
      <span class="token keyword">case</span> <span class="token operator">&lt;-</span> quit<span class="token punctuation">:</span>
         <span class="token comment">//如果quit可以读，则该case就会进来</span>
         fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"quit"</span><span class="token punctuation">)</span>
         <span class="token keyword">return</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   c <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">int</span><span class="token punctuation">)</span>
   quit <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">int</span><span class="token punctuation">)</span>

   <span class="token keyword">go</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
         fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span> <span class="token operator">&lt;-</span> c<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>

      quit <span class="token operator">&lt;-</span> <span class="token number">0</span>
   <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

   <span class="token comment">//main go</span>
   <span class="token function">fibonacci</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>quit<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>多路Channel的一个监控功能嗷！！！</p>
<h1 id="GOMODULES"><a href="#GOMODULES" class="headerlink" title="GOMODULES"></a>GOMODULES</h1><h2 id="工作模式弊端"><a href="#工作模式弊端" class="headerlink" title="工作模式弊端"></a>工作模式弊端</h2><ul>
<li>Go Modules的出现淘汰了GoPath，例如之前GOPATH要求项目全写在$GOPATH下，很恼火，很不自由嗷！！！</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211021194903.png" alt="image-20211021194902854"></p>
<ul>
<li>cmd中输入go env可以查看go的环境变量</li>
<li>GOPAHT的弊端：<ol>
<li>没有版本控制的概念哈！！！无法指定拉取自己需要的版本的库之类的</li>
<li>无法同步一致第三方版本号</li>
<li>无法指定当前项目引用的第三方版本号</li>
</ol>
</li>
</ul>
<h2 id="GoModules模式"><a href="#GoModules模式" class="headerlink" title="GoModules模式"></a>GoModules模式</h2><ul>
<li><code>go mod help</code>可以得到go mod的全部指令的帮助文档。</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211021195641.png" alt="image-20211021195641167"></p>
<ul>
<li>go mod环境变量：</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211021195727.png" alt="image-20211021195727200"></p>
<ul>
<li>环境变量讲解：</li>
</ul>
<ol>
<li>GO111MODULE</li>
</ol>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211021195819.png" alt="image-20211021195819381"></p>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211022114233.png" alt="image-20211022114233438"></p>
<ol start="2">
<li>GOPROXY</li>
</ol>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211021200004.png" alt="image-20211021200003916"></p>
<p>这个本质上就是配置镜像源嗷！！！</p>
<p>注意这里七牛云后面还有个<code>,direct</code>，或者表示如果在前面的仓库中找不到，就会回源到模块版本的源地址去找（比如Github，如果再找不到的话，就会报错了嗷！！！）</p>
<ol start="3">
<li>GOSUMDB</li>
</ol>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211021200730.png" alt="image-20211021200730404"></p>
<p>校验拉取的第三方库是否完整。设置了GOPROXY，我们就不用担心这个原来的设置是外网的库拉，这个GOPROXY就会帮助我们自动校验嗷！！！</p>
<ol start="4">
<li>GONOPROXY/GONOSUMDB/GOPRIVATE</li>
</ol>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211021200943.png" alt="image-20211021200943334"></p>
<p>通过设置一个GOPRIVATE即可嗷！！！</p>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211021201542.png" alt="image-20211021201542414"></p>
<ul>
<li>小总结：</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211021201056.png" alt="image-20211021201056360"></p>
<p>环境变量设置：</p>
<p><code>go env -w 环境变量名=相应参数</code></p>
<h2 id="Go-Modules初始化项目"><a href="#Go-Modules初始化项目" class="headerlink" title="Go Modules初始化项目"></a>Go Modules初始化项目</h2><ul>
<li>步骤：<ol>
<li>创建对应的文件夹</li>
<li>进入文件夹中执行<code>go mod init 当前模块名称</code></li>
</ol>
</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211022112500.png" alt="image-20211022112500525"></p>
<p>后面导包的时候，项目的整体名称就是这个了嗷！！！</p>
<p>进入初始化好的go.mod文件看一眼</p>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211022112605.png" alt="image-20211022112604894"></p>
<p>可以看到这个项目的module名称还有go的版本号</p>
<ul>
<li>导入github的项目康康效果？</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211022112735.png" alt="image-20211022112734815"></p>
<ul>
<li>然后我们可以导入对应的包：</li>
</ul>
<ol>
<li>导入单个子模块：</li>
</ol>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211022112936.png" alt="image-20211022112936281"></p>
<p>直接找到对应的模块go get就可以拉下来了嗷！！！</p>
<ul>
<li>其实可以不用手动down的，你直接跑项目的时候go mod就会帮助我们自动down下来我们需要的依赖了嗷！！！</li>
</ul>
<ol start="2">
<li>下载整个模块：</li>
</ol>
<p><code>go get github.com/aceld/zinx</code></p>
<p>这样就把对应的项目的包全部都拉下来了嗷！！！</p>
<p>跑一把：</p>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211022113121.png" alt="image-20211022113121334"></p>
<ul>
<li>导完之后发现当前目录下多了一个go.sum文件嗷！！！</li>
<li>而且当我们访问go mod的时候：</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211022113317.png" alt="image-20211022113316814"></p>
<p>间接依赖，这里意味着，我只以来了这个包的子模块，不是整体依赖这个包嗷！！！</p>
<ul>
<li>我们再看看go.sum文件中的内容：</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211022113450.png" alt="image-20211022113450155"></p>
<p>第一个h1 + hash，第二个是gomod + hash。表达一共就只有这两种方式哈！！！</p>
<p>h1 + hash：对于整个包所有文件做哈希，这是为了保证整个包全部文件的完整性。</p>
<p>gomod + hash：表示对于mod文件进行的Hash，确保hash没有问题。</p>
<ul>
<li>刚刚下载的库再哪里呢？</li>
</ul>
<p><code>$GOPATH/pkg</code>这个包中，有一个mod模块，里面记录了我们的所有的不同的module的依赖包，打开对应的module就能够看到我们在对应的module中下载的依赖包了嗷！！！</p>
<ul>
<li><p>项目可以在任意的目录中，因为下载位置等都配置好了嗷！！！</p>
</li>
<li><p>summary：</p>
</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211022114630.png" alt="image-20211022114629646"></p>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211022114810.png" alt="image-20211022114810294"></p>
<h2 id="改变模块依赖关系"><a href="#改变模块依赖关系" class="headerlink" title="改变模块依赖关系"></a>改变模块依赖关系</h2><ul>
<li>比如确定要使用某个版本的依赖，这个版本才有对应的依赖和资源。</li>
<li>第一：可以更改go mod中的版本依赖，改回某个老版本。</li>
<li>第二：使用指令进行版本替换：</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211022145950.png" alt="image-20211022145950537"></p>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211022150021.png" alt="image-20211022150021521"></p>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211022150124.png" alt="image-20211022150124165"></p>
<p>你需要找到$GOPATH下对应的下载的包和对应的版本，然后进行replace替换操作嗷！！！</p>
<h1 id="即时通信系统小项目"><a href="#即时通信系统小项目" class="headerlink" title="即时通信系统小项目"></a>即时通信系统小项目</h1><ul>
<li>技术结构：</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211022150258.png" alt="image-20211022150258190"></p>
<p>OnlineMap：记录在线用户</p>
<p>OnlineMap旁边的channel：进行广播channel</p>
<h2 id="版本一：构建基础Server"><a href="#版本一：构建基础Server" class="headerlink" title="版本一：构建基础Server"></a>版本一：构建基础Server</h2><ul>
<li>新建一个文件夹</li>
</ul>
<ol>
<li>建立server.go文件，写Server这个类，这个类包含三个大方法和一个重要的结构：<ul>
<li>Server类型的定义</li>
<li>创建一个Server对象方法</li>
<li>启动一个Server服务方法</li>
<li>处理一个连接方法</li>
</ul>
</li>
</ol>
<ul>
<li>server.go：</li>
</ul>
<pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
   <span class="token string">"fmt"</span>
   <span class="token string">"net"</span>
<span class="token punctuation">)</span>

<span class="token comment">// Server 这个Server就是用于定义对应的结构体和方法的嗷！！！</span>
<span class="token keyword">type</span> Server <span class="token keyword">struct</span> <span class="token punctuation">{</span>
   Ip <span class="token builtin">string</span>
   Port <span class="token builtin">int</span>
<span class="token punctuation">}</span>

<span class="token comment">// NewServer 创建一个server的接口</span>
<span class="token keyword">func</span> <span class="token function">NewServer</span><span class="token punctuation">(</span>ip <span class="token builtin">string</span><span class="token punctuation">,</span> port <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">*</span>Server <span class="token punctuation">{</span>
   server <span class="token operator">:=</span> <span class="token operator">&amp;</span>Server<span class="token punctuation">{</span>
      Ip<span class="token punctuation">:</span> ip<span class="token punctuation">,</span>
      Port<span class="token punctuation">:</span> port<span class="token punctuation">,</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">return</span> server
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>this <span class="token operator">*</span>Server<span class="token punctuation">)</span> <span class="token function">Handler</span><span class="token punctuation">(</span>conn net<span class="token punctuation">.</span>Conn<span class="token punctuation">)</span>  <span class="token punctuation">{</span>
   <span class="token comment">//...用于对接当前链接的业务</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"连接建立成功"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>


<span class="token comment">// Start 启动服务器的端口</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>this <span class="token operator">*</span>Server<span class="token punctuation">)</span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token comment">// socket listen</span>
   listener <span class="token punctuation">,</span> err <span class="token operator">:=</span> net<span class="token punctuation">.</span><span class="token function">Listen</span><span class="token punctuation">(</span><span class="token string">"tcp"</span><span class="token punctuation">,</span>fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">"%s:%d"</span><span class="token punctuation">,</span>this<span class="token punctuation">.</span>Ip<span class="token punctuation">,</span>this<span class="token punctuation">.</span>Port<span class="token punctuation">)</span><span class="token punctuation">)</span>
   <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
      fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"net.Listen error : "</span><span class="token punctuation">,</span>err<span class="token punctuation">)</span>
      <span class="token keyword">return</span>
   <span class="token punctuation">}</span>

   <span class="token comment">//close listen socket</span>
   <span class="token keyword">defer</span> listener<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

   <span class="token keyword">for</span> <span class="token punctuation">{</span>
      <span class="token comment">//accept</span>
      conn <span class="token punctuation">,</span> err <span class="token operator">:=</span> listener<span class="token punctuation">.</span><span class="token function">Accept</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
         fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"listener accept error : "</span><span class="token punctuation">,</span>err<span class="token punctuation">)</span>
         <span class="token keyword">continue</span>
      <span class="token punctuation">}</span>

      <span class="token comment">//do handler</span>
      <span class="token keyword">go</span> this<span class="token punctuation">.</span><span class="token function">Handler</span><span class="token punctuation">(</span>conn<span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>main.go:</li>
</ul>
<pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">package</span> main

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   server <span class="token operator">:=</span> <span class="token function">NewServer</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span><span class="token number">8888</span><span class="token punctuation">)</span>
   server<span class="token punctuation">.</span><span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>







<h2 id="版本二：用户上线功能"><a href="#版本二：用户上线功能" class="headerlink" title="版本二：用户上线功能"></a>版本二：用户上线功能</h2><p>还需要补充OnlineMap和Message这两个属性：</p>
<ul>
<li><p>OnlineMap：记录哪些用户在线。每一个用户实际上都绑定一个channel，这个channel是用于给client发消息的嗷，用户在监听channel，如果有数据会立刻把数据给client！！！</p>
</li>
<li><p>Message：本质上是server的一个channel，把消息广播嗷！！！</p>
</li>
<li><p>流程图：</p>
</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211023094952.png" alt="image-20211023094951712"></p>
<ul>
<li>重点在于广播功能的实现：</li>
</ul>
<p>新增User.go：</p>
<pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">"net"</span>

<span class="token keyword">type</span> User <span class="token keyword">struct</span> <span class="token punctuation">{</span>
   Name <span class="token builtin">string</span>
   Addr <span class="token builtin">string</span>
   C <span class="token keyword">chan</span> <span class="token builtin">string</span>
   conn net<span class="token punctuation">.</span>Conn
<span class="token punctuation">}</span>

<span class="token comment">// NewUser 创建一个用户的API</span>
<span class="token keyword">func</span> <span class="token function">NewUser</span><span class="token punctuation">(</span>conn net<span class="token punctuation">.</span>Conn<span class="token punctuation">)</span> <span class="token operator">*</span>User<span class="token punctuation">{</span>
   userAddr <span class="token operator">:=</span> conn<span class="token punctuation">.</span><span class="token function">RemoteAddr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

   user <span class="token operator">:=</span> <span class="token operator">&amp;</span>User<span class="token punctuation">{</span>
      Name<span class="token punctuation">:</span> userAddr<span class="token punctuation">,</span>
      Addr<span class="token punctuation">:</span> userAddr<span class="token punctuation">,</span>
      C<span class="token punctuation">:</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      conn<span class="token punctuation">:</span> conn<span class="token punctuation">,</span>
   <span class="token punctuation">}</span>

   <span class="token comment">//启动监听当前user channel消息的goroutine</span>
   <span class="token keyword">go</span> user<span class="token punctuation">.</span><span class="token function">ListenMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

   <span class="token keyword">return</span> user
<span class="token punctuation">}</span>

<span class="token comment">// ListenMessage 监听当前User channel的方法，一旦有消息就直接发送给client</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>this <span class="token operator">*</span>User<span class="token punctuation">)</span> <span class="token function">ListenMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">for</span> <span class="token punctuation">{</span>
      msg <span class="token operator">:=</span> <span class="token operator">&lt;-</span> this<span class="token punctuation">.</span>C

      this<span class="token punctuation">.</span>conn<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>msg<span class="token operator">+</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>修改server.go</p>
<pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
   <span class="token string">"fmt"</span>
   <span class="token string">"net"</span>
   <span class="token string">"sync"</span>
<span class="token punctuation">)</span>

<span class="token comment">// Server 这个Server就是用于定义对应的结构体和方法的嗷！！！</span>
<span class="token keyword">type</span> Server <span class="token keyword">struct</span> <span class="token punctuation">{</span>
   Ip <span class="token builtin">string</span>
   Port <span class="token builtin">int</span>

   <span class="token comment">//子啊先用户的列表</span>
   OnlineMap <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">*</span>User
   mapLock sync<span class="token punctuation">.</span>RWMutex

   <span class="token comment">//消息广播的channel</span>
   Message <span class="token keyword">chan</span> <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token comment">// NewServer 创建一个server的接口</span>
<span class="token keyword">func</span> <span class="token function">NewServer</span><span class="token punctuation">(</span>ip <span class="token builtin">string</span><span class="token punctuation">,</span> port <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">*</span>Server <span class="token punctuation">{</span>
   server <span class="token operator">:=</span> <span class="token operator">&amp;</span>Server<span class="token punctuation">{</span>
      Ip<span class="token punctuation">:</span> ip<span class="token punctuation">,</span>
      Port<span class="token punctuation">:</span> port<span class="token punctuation">,</span>
      OnlineMap<span class="token punctuation">:</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">*</span>User<span class="token punctuation">)</span><span class="token punctuation">,</span>
      Message<span class="token punctuation">:</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">return</span> server
<span class="token punctuation">}</span>

<span class="token comment">// BroadCast 广播消息方法</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>this <span class="token operator">*</span>Server<span class="token punctuation">)</span> <span class="token function">BroadCast</span><span class="token punctuation">(</span>user <span class="token operator">*</span>User<span class="token punctuation">,</span> msg <span class="token builtin">string</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>
   sendMsg <span class="token operator">:=</span> <span class="token string">"["</span> <span class="token operator">+</span> user<span class="token punctuation">.</span>Addr <span class="token operator">+</span> <span class="token string">"]"</span> <span class="token operator">+</span> user<span class="token punctuation">.</span>Name <span class="token operator">+</span> <span class="token string">":"</span> <span class="token operator">+</span> msg
   this<span class="token punctuation">.</span>Message <span class="token operator">&lt;-</span> sendMsg
<span class="token punctuation">}</span>

<span class="token comment">// ListenMessage 监听Message广播消息channel的goroutine,一旦有消息就发送给全部的在线User</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>this <span class="token operator">*</span>Server<span class="token punctuation">)</span> <span class="token function">ListenMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">for</span> <span class="token punctuation">{</span>
      msg <span class="token operator">:=</span> <span class="token operator">&lt;-</span> this<span class="token punctuation">.</span>Message

      <span class="token comment">//将message发送给全部的在线User</span>
      this<span class="token punctuation">.</span>mapLock<span class="token punctuation">.</span><span class="token function">Lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

      <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> cli <span class="token operator">:=</span> <span class="token keyword">range</span> this<span class="token punctuation">.</span>OnlineMap<span class="token punctuation">{</span>
         cli<span class="token punctuation">.</span>C <span class="token operator">&lt;-</span> msg
      <span class="token punctuation">}</span>

      this<span class="token punctuation">.</span>mapLock<span class="token punctuation">.</span><span class="token function">Unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token comment">// Handler 处理连接的方法</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>this <span class="token operator">*</span>Server<span class="token punctuation">)</span> <span class="token function">Handler</span><span class="token punctuation">(</span>conn net<span class="token punctuation">.</span>Conn<span class="token punctuation">)</span>  <span class="token punctuation">{</span>
   <span class="token comment">//...用于对接当前链接的业务</span>
   <span class="token comment">//fmt.Println("连接建立成功")</span>

   user <span class="token operator">:=</span> <span class="token function">NewUser</span><span class="token punctuation">(</span>conn<span class="token punctuation">)</span>

   <span class="token comment">//用户上线，把用户加入到onlineMap中，并且广播消息</span>
   this<span class="token punctuation">.</span>mapLock<span class="token punctuation">.</span><span class="token function">Lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   this<span class="token punctuation">.</span>OnlineMap<span class="token punctuation">[</span>user<span class="token punctuation">.</span>Name<span class="token punctuation">]</span> <span class="token operator">=</span> user
   this<span class="token punctuation">.</span>mapLock<span class="token punctuation">.</span><span class="token function">Unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

   <span class="token comment">//广播当前用户上线消息</span>
   this<span class="token punctuation">.</span><span class="token function">BroadCast</span><span class="token punctuation">(</span>user<span class="token punctuation">,</span><span class="token string">"已经上线"</span><span class="token punctuation">)</span>

   <span class="token comment">//当前handler阻塞，为了防止这个死了之后，go程就挂了</span>
   <span class="token keyword">select</span> <span class="token punctuation">{</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token comment">// Start 启动服务器的端口</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>this <span class="token operator">*</span>Server<span class="token punctuation">)</span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token comment">// socket listen</span>
   listener <span class="token punctuation">,</span> err <span class="token operator">:=</span> net<span class="token punctuation">.</span><span class="token function">Listen</span><span class="token punctuation">(</span><span class="token string">"tcp"</span><span class="token punctuation">,</span>fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">"%s:%d"</span><span class="token punctuation">,</span>this<span class="token punctuation">.</span>Ip<span class="token punctuation">,</span>this<span class="token punctuation">.</span>Port<span class="token punctuation">)</span><span class="token punctuation">)</span>
   <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
      fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"net.Listen error : "</span><span class="token punctuation">,</span>err<span class="token punctuation">)</span>
      <span class="token keyword">return</span>
   <span class="token punctuation">}</span>

   <span class="token comment">//close listen socket</span>
   <span class="token keyword">defer</span> listener<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

   <span class="token comment">//启动监听Message的goroutine</span>
   <span class="token keyword">go</span> this<span class="token punctuation">.</span><span class="token function">ListenMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

   <span class="token keyword">for</span> <span class="token punctuation">{</span>
      <span class="token comment">//accept</span>
      conn <span class="token punctuation">,</span> err <span class="token operator">:=</span> listener<span class="token punctuation">.</span><span class="token function">Accept</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
         fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"listener accept error : "</span><span class="token punctuation">,</span>err<span class="token punctuation">)</span>
         <span class="token keyword">continue</span>
      <span class="token punctuation">}</span>

      <span class="token comment">//do handler</span>
      <span class="token keyword">go</span> this<span class="token punctuation">.</span><span class="token function">Handler</span><span class="token punctuation">(</span>conn<span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>





<h2 id="版本三：用户消息广播机制"><a href="#版本三：用户消息广播机制" class="headerlink" title="版本三：用户消息广播机制"></a>版本三：用户消息广播机制</h2><ul>
<li>其实上面已经完成了相关的广播功能的编写了</li>
<li>我们接下来需要的就是编写对应的函数，把相应的用户消息放入我们的消息队列中即可</li>
</ul>
<h2 id="版本四：用户业务层封装"><a href="#版本四：用户业务层封装" class="headerlink" title="版本四：用户业务层封装"></a>版本四：用户业务层封装</h2><ul>
<li>把代码进行合并，整理成函数嗷，是谁负责的，例如用户的登录和退出，就封装在哪个类的方法中嗷！！！！同时通过数据结构中的指针，把用户和Service串起来，方便我们的操作嗷！！！</li>
</ul>
<pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token comment">//用户的上线业务</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>this <span class="token operator">*</span>User<span class="token punctuation">)</span> <span class="token function">Online</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

   <span class="token comment">//用户上线,将用户加入到onlineMap中</span>
   this<span class="token punctuation">.</span>server<span class="token punctuation">.</span>mapLock<span class="token punctuation">.</span><span class="token function">Lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   this<span class="token punctuation">.</span>server<span class="token punctuation">.</span>OnlineMap<span class="token punctuation">[</span>this<span class="token punctuation">.</span>Name<span class="token punctuation">]</span> <span class="token operator">=</span> this
   this<span class="token punctuation">.</span>server<span class="token punctuation">.</span>mapLock<span class="token punctuation">.</span><span class="token function">Unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

   <span class="token comment">//广播当前用户上线消息</span>
   this<span class="token punctuation">.</span>server<span class="token punctuation">.</span><span class="token function">BroadCast</span><span class="token punctuation">(</span>this<span class="token punctuation">,</span> <span class="token string">"已上线"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">//用户的下线业务</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>this <span class="token operator">*</span>User<span class="token punctuation">)</span> <span class="token function">Offline</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

   <span class="token comment">//用户下线,将用户从onlineMap中删除</span>
   this<span class="token punctuation">.</span>server<span class="token punctuation">.</span>mapLock<span class="token punctuation">.</span><span class="token function">Lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token function">delete</span><span class="token punctuation">(</span>this<span class="token punctuation">.</span>server<span class="token punctuation">.</span>OnlineMap<span class="token punctuation">,</span> this<span class="token punctuation">.</span>Name<span class="token punctuation">)</span>
   this<span class="token punctuation">.</span>server<span class="token punctuation">.</span>mapLock<span class="token punctuation">.</span><span class="token function">Unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

   <span class="token comment">//广播当前用户上线消息</span>
   this<span class="token punctuation">.</span>server<span class="token punctuation">.</span><span class="token function">BroadCast</span><span class="token punctuation">(</span>this<span class="token punctuation">,</span> <span class="token string">"下线"</span><span class="token punctuation">)</span>

<span class="token punctuation">}</span>

<span class="token comment">//用户处理消息的业务</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>this <span class="token operator">*</span>User<span class="token punctuation">)</span> <span class="token function">DoMessage</span><span class="token punctuation">(</span>msg <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   this<span class="token punctuation">.</span>server<span class="token punctuation">.</span><span class="token function">BroadCast</span><span class="token punctuation">(</span>this<span class="token punctuation">,</span> msg<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>上面就是重构后提取出来的用户的业务嗷！！！</p>
<pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">func</span> <span class="token punctuation">(</span>this <span class="token operator">*</span>Server<span class="token punctuation">)</span> <span class="token function">Handler</span><span class="token punctuation">(</span>conn net<span class="token punctuation">.</span>Conn<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token comment">//...当前链接的业务</span>
   <span class="token comment">//fmt.Println("链接建立成功")</span>

   user <span class="token operator">:=</span> <span class="token function">NewUser</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> this<span class="token punctuation">)</span>

   user<span class="token punctuation">.</span><span class="token function">Online</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

   <span class="token comment">//接受客户端发送的消息</span>
   <span class="token keyword">go</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      buf <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> <span class="token number">4096</span><span class="token punctuation">)</span>
      <span class="token keyword">for</span> <span class="token punctuation">{</span>
         n<span class="token punctuation">,</span> err <span class="token operator">:=</span> conn<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span>
         <span class="token keyword">if</span> n <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>
            user<span class="token punctuation">.</span><span class="token function">Offline</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span>
         <span class="token punctuation">}</span>

         <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token operator">&amp;&amp;</span> err <span class="token operator">!=</span> io<span class="token punctuation">.</span>EOF <span class="token punctuation">{</span>
            fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"Conn Read err:"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
            <span class="token keyword">return</span>
         <span class="token punctuation">}</span>

         <span class="token comment">//提取用户的消息(去除'\n')</span>
         msg <span class="token operator">:=</span> <span class="token function">string</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token punctuation">:</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

         <span class="token comment">//用户针对msg进行消息处理</span>
         user<span class="token punctuation">.</span><span class="token function">DoMessage</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

   <span class="token comment">//当前handler阻塞</span>
   <span class="token keyword">select</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>上面就是重构后提取出来的service的业务嗷！！！</p>
<p>以及把User和Server（正向一对一，反向一对多），分别使用指针和Map的方式将两者穿起来，方便我们后续的操作嗷！！！</p>
<h2 id="版本五：在线用户查询"><a href="#版本五：在线用户查询" class="headerlink" title="版本五：在线用户查询"></a>版本五：在线用户查询</h2><ul>
<li>添加在用户的DoMessage方法中，对于用户输入的消息进行判断，如果为”who”，就返回所有用户信息即可嗷！！！</li>
</ul>
<pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token comment">//专门用于给当前用户发消息的嗷！！！</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>this <span class="token operator">*</span>User<span class="token punctuation">)</span> <span class="token function">SendMsg</span><span class="token punctuation">(</span>msg <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   this<span class="token punctuation">.</span>conn<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">//用户处理消息的业务</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>this <span class="token operator">*</span>User<span class="token punctuation">)</span> <span class="token function">DoMessage</span><span class="token punctuation">(</span>msg <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">if</span> msg <span class="token operator">==</span> <span class="token string">"who"</span><span class="token punctuation">{</span>
      <span class="token comment">//查询在线的用户都有哪些</span>
      this<span class="token punctuation">.</span>server<span class="token punctuation">.</span>mapLock<span class="token punctuation">.</span><span class="token function">Lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> user <span class="token operator">:=</span> <span class="token keyword">range</span> this<span class="token punctuation">.</span>server<span class="token punctuation">.</span>OnlineMap<span class="token punctuation">{</span>
         onlineMsg <span class="token operator">:=</span> <span class="token string">"["</span> <span class="token operator">+</span> user<span class="token punctuation">.</span>Addr <span class="token operator">+</span> <span class="token string">"]"</span> <span class="token operator">+</span> user<span class="token punctuation">.</span>Name <span class="token operator">+</span> <span class="token string">":"</span> <span class="token operator">+</span> <span class="token string">"在线...\n"</span>
         this<span class="token punctuation">.</span><span class="token function">SendMsg</span><span class="token punctuation">(</span>onlineMsg<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      this<span class="token punctuation">.</span>server<span class="token punctuation">.</span>mapLock<span class="token punctuation">.</span><span class="token function">Unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

   <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      this<span class="token punctuation">.</span>server<span class="token punctuation">.</span><span class="token function">BroadCast</span><span class="token punctuation">(</span>this<span class="token punctuation">,</span> msg<span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="版本六：修改用户名"><a href="#版本六：修改用户名" class="headerlink" title="版本六：修改用户名"></a>版本六：修改用户名</h2><ul>
<li>定义一下：例如：<code>rename|兔子</code>就是当前用户名重命名为兔子！！！</li>
<li>和上面一样，都要使用DoMessage来判断处理</li>
</ul>
<pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token comment">//专门用于给当前用户发消息的嗷！！！</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>this <span class="token operator">*</span>User<span class="token punctuation">)</span> <span class="token function">SendMsg</span><span class="token punctuation">(</span>msg <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   this<span class="token punctuation">.</span>conn<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">//用户处理消息的业务</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>this <span class="token operator">*</span>User<span class="token punctuation">)</span> <span class="token function">DoMessage</span><span class="token punctuation">(</span>msg <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">if</span> msg <span class="token operator">==</span> <span class="token string">"who"</span><span class="token punctuation">{</span>
      <span class="token comment">//查询在线的用户都有哪些</span>
      this<span class="token punctuation">.</span>server<span class="token punctuation">.</span>mapLock<span class="token punctuation">.</span><span class="token function">Lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> user <span class="token operator">:=</span> <span class="token keyword">range</span> this<span class="token punctuation">.</span>server<span class="token punctuation">.</span>OnlineMap<span class="token punctuation">{</span>
         onlineMsg <span class="token operator">:=</span> <span class="token string">"["</span> <span class="token operator">+</span> user<span class="token punctuation">.</span>Addr <span class="token operator">+</span> <span class="token string">"]"</span> <span class="token operator">+</span> user<span class="token punctuation">.</span>Name <span class="token operator">+</span> <span class="token string">":"</span> <span class="token operator">+</span> <span class="token string">"在线...\n"</span>
         this<span class="token punctuation">.</span><span class="token function">SendMsg</span><span class="token punctuation">(</span>onlineMsg<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      this<span class="token punctuation">.</span>server<span class="token punctuation">.</span>mapLock<span class="token punctuation">.</span><span class="token function">Unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

   <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token function">len</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">7</span> <span class="token operator">&amp;&amp;</span> msg<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"rename|"</span> <span class="token punctuation">{</span>
      <span class="token comment">//消息格式：rename|张山</span>
      newName <span class="token operator">:=</span> strings<span class="token punctuation">.</span><span class="token function">Split</span><span class="token punctuation">(</span>msg<span class="token punctuation">,</span><span class="token string">"|"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>

      <span class="token comment">//判断name是否存在</span>
      <span class="token boolean">_</span><span class="token punctuation">,</span> ok <span class="token operator">:=</span> this<span class="token punctuation">.</span>server<span class="token punctuation">.</span>OnlineMap<span class="token punctuation">[</span>newName<span class="token punctuation">]</span>
      <span class="token keyword">if</span> ok <span class="token punctuation">{</span>
         this<span class="token punctuation">.</span><span class="token function">SendMsg</span><span class="token punctuation">(</span><span class="token string">"当前用户名被使用了！！！\n"</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
         <span class="token comment">//修改服务器端的名字</span>
         this<span class="token punctuation">.</span>server<span class="token punctuation">.</span>mapLock<span class="token punctuation">.</span><span class="token function">Lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
         <span class="token function">delete</span><span class="token punctuation">(</span>this<span class="token punctuation">.</span>server<span class="token punctuation">.</span>OnlineMap<span class="token punctuation">,</span>this<span class="token punctuation">.</span>Name<span class="token punctuation">)</span>
         this<span class="token punctuation">.</span>server<span class="token punctuation">.</span>OnlineMap<span class="token punctuation">[</span>newName<span class="token punctuation">]</span> <span class="token operator">=</span> this
         this<span class="token punctuation">.</span>server<span class="token punctuation">.</span>mapLock<span class="token punctuation">.</span><span class="token function">Unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

         <span class="token comment">//修改用户端的名字</span>
         this<span class="token punctuation">.</span>Name <span class="token operator">=</span> newName
         this<span class="token punctuation">.</span><span class="token function">SendMsg</span><span class="token punctuation">(</span><span class="token string">"您已经成功更新用户名为："</span> <span class="token operator">+</span> this<span class="token punctuation">.</span>Name <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      this<span class="token punctuation">.</span>server<span class="token punctuation">.</span><span class="token function">BroadCast</span><span class="token punctuation">(</span>this<span class="token punctuation">,</span> msg<span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>





<h2 id="版本七：超时强踢功能"><a href="#版本七：超时强踢功能" class="headerlink" title="版本七：超时强踢功能"></a>版本七：超时强踢功能</h2><ul>
<li>首先应该记录一个用户的在线时间嗷！！！</li>
<li>用到了select语法之类的 ，用到了两个channel嗷！！！</li>
</ul>
<pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">func</span> <span class="token punctuation">(</span>this <span class="token operator">*</span>Server<span class="token punctuation">)</span> <span class="token function">Handler</span><span class="token punctuation">(</span>conn net<span class="token punctuation">.</span>Conn<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//...当前链接的业务</span>
    <span class="token comment">//fmt.Println("链接建立成功")</span>
 
    user <span class="token operator">:=</span> <span class="token function">NewUser</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> this<span class="token punctuation">)</span>
 
    user<span class="token punctuation">.</span><span class="token function">Online</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 
    <span class="token comment">//监听用户是否活跃的channel</span>
    isLive <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">bool</span><span class="token punctuation">)</span>
 
    <span class="token comment">//接受客户端发送的消息</span>
    <span class="token keyword">go</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        buf <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> <span class="token number">4096</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> <span class="token punctuation">{</span>
            n<span class="token punctuation">,</span> err <span class="token operator">:=</span> conn<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span>
            <span class="token keyword">if</span> n <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>
                user<span class="token punctuation">.</span><span class="token function">Offline</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span>
            <span class="token punctuation">}</span>
 
            <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token operator">&amp;&amp;</span> err <span class="token operator">!=</span> io<span class="token punctuation">.</span>EOF <span class="token punctuation">{</span>
                fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"Conn Read err:"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
                <span class="token keyword">return</span>
            <span class="token punctuation">}</span>
 
            <span class="token comment">//提取用户的消息(去除'\n')</span>
            msg <span class="token operator">:=</span> <span class="token function">string</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token punctuation">:</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
 
            <span class="token comment">//用户针对msg进行消息处理</span>
            user<span class="token punctuation">.</span><span class="token function">DoMessage</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span>
 
            <span class="token comment">//用户的任意消息，代表当前用户是一个活跃的</span>
            isLive <span class="token operator">&lt;-</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 
    <span class="token comment">//当前handler阻塞</span>
    <span class="token keyword">for</span> <span class="token punctuation">{</span>
        <span class="token keyword">select</span> <span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token operator">&lt;-</span>isLive<span class="token punctuation">:</span>
            <span class="token comment">//当前用户是活跃的，应该重置定时器</span>
            <span class="token comment">//不做任何事情，为了激活select，更新下面的定时器</span>
 
        <span class="token keyword">case</span> <span class="token operator">&lt;-</span>time<span class="token punctuation">.</span><span class="token function">After</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>Second <span class="token operator">*</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment">//已经超时</span>
            <span class="token comment">//将当前的User强制的关闭</span>
 
            user<span class="token punctuation">.</span><span class="token function">SendMsg</span><span class="token punctuation">(</span><span class="token string">"你被踢了"</span><span class="token punctuation">)</span>
 
            <span class="token comment">//销毁用的资源</span>
            <span class="token function">close</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>C<span class="token punctuation">)</span>
 
            <span class="token comment">//关闭连接</span>
            conn<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 
            <span class="token comment">//退出当前Handler</span>
            <span class="token keyword">return</span> <span class="token comment">//runtime.Goexit()</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>





<h2 id="版本八：私聊功能"><a href="#版本八：私聊功能" class="headerlink" title="版本八：私聊功能"></a>版本八：私聊功能</h2><ul>
<li>和之前一样，修改DOMESSAGE，类似于自己定义通信协议嗷！！！</li>
<li>例如：<code>to|用户名|信息</code>这种方式，进行判断即可嗷！！！从全局的用户列表中，找到对应的用户，把他的Channel拿出来，把我要发的信息塞进去即可嗷！！！</li>
</ul>
<pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token comment">//用户处理消息的业务</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>this <span class="token operator">*</span>User<span class="token punctuation">)</span> <span class="token function">DoMessage</span><span class="token punctuation">(</span>msg <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> msg <span class="token operator">==</span> <span class="token string">"who"</span> <span class="token punctuation">{</span>
        <span class="token comment">//查询当前在线用户都有哪些</span>
 
        this<span class="token punctuation">.</span>server<span class="token punctuation">.</span>mapLock<span class="token punctuation">.</span><span class="token function">Lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> user <span class="token operator">:=</span> <span class="token keyword">range</span> this<span class="token punctuation">.</span>server<span class="token punctuation">.</span>OnlineMap <span class="token punctuation">{</span>
            onlineMsg <span class="token operator">:=</span> <span class="token string">"["</span> <span class="token operator">+</span> user<span class="token punctuation">.</span>Addr <span class="token operator">+</span> <span class="token string">"]"</span> <span class="token operator">+</span> user<span class="token punctuation">.</span>Name <span class="token operator">+</span> <span class="token string">":"</span> <span class="token operator">+</span> <span class="token string">"在线...\n"</span>
            this<span class="token punctuation">.</span><span class="token function">SendMsg</span><span class="token punctuation">(</span>onlineMsg<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        this<span class="token punctuation">.</span>server<span class="token punctuation">.</span>mapLock<span class="token punctuation">.</span><span class="token function">Unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token function">len</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">7</span> <span class="token operator">&amp;&amp;</span> msg<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"rename|"</span> <span class="token punctuation">{</span>
        <span class="token comment">//消息格式: rename|张三</span>
        newName <span class="token operator">:=</span> strings<span class="token punctuation">.</span><span class="token function">Split</span><span class="token punctuation">(</span>msg<span class="token punctuation">,</span> <span class="token string">"|"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
 
        <span class="token comment">//判断name是否存在</span>
        <span class="token boolean">_</span><span class="token punctuation">,</span> ok <span class="token operator">:=</span> this<span class="token punctuation">.</span>server<span class="token punctuation">.</span>OnlineMap<span class="token punctuation">[</span>newName<span class="token punctuation">]</span>
        <span class="token keyword">if</span> ok <span class="token punctuation">{</span>
            this<span class="token punctuation">.</span><span class="token function">SendMsg</span><span class="token punctuation">(</span><span class="token string">"当前用户名被使用\n"</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            this<span class="token punctuation">.</span>server<span class="token punctuation">.</span>mapLock<span class="token punctuation">.</span><span class="token function">Lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token function">delete</span><span class="token punctuation">(</span>this<span class="token punctuation">.</span>server<span class="token punctuation">.</span>OnlineMap<span class="token punctuation">,</span> this<span class="token punctuation">.</span>Name<span class="token punctuation">)</span>
            this<span class="token punctuation">.</span>server<span class="token punctuation">.</span>OnlineMap<span class="token punctuation">[</span>newName<span class="token punctuation">]</span> <span class="token operator">=</span> this
            this<span class="token punctuation">.</span>server<span class="token punctuation">.</span>mapLock<span class="token punctuation">.</span><span class="token function">Unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 
            this<span class="token punctuation">.</span>Name <span class="token operator">=</span> newName
            this<span class="token punctuation">.</span><span class="token function">SendMsg</span><span class="token punctuation">(</span><span class="token string">"您已经更新用户名:"</span> <span class="token operator">+</span> this<span class="token punctuation">.</span>Name <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
 
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token function">len</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">4</span> <span class="token operator">&amp;&amp;</span> msg<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"to|"</span> <span class="token punctuation">{</span>
        <span class="token comment">//消息格式:  to|张三|消息内容</span>
 
        <span class="token comment">//1 获取对方的用户名</span>
        remoteName <span class="token operator">:=</span> strings<span class="token punctuation">.</span><span class="token function">Split</span><span class="token punctuation">(</span>msg<span class="token punctuation">,</span> <span class="token string">"|"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
        <span class="token keyword">if</span> remoteName <span class="token operator">==</span> <span class="token string">""</span> <span class="token punctuation">{</span>
            this<span class="token punctuation">.</span><span class="token function">SendMsg</span><span class="token punctuation">(</span><span class="token string">"消息格式不正确，请使用 \"to|张三|你好啊\"格式。\n"</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span>
        <span class="token punctuation">}</span>
 
        <span class="token comment">//2 根据用户名 得到对方User对象</span>
        remoteUser<span class="token punctuation">,</span> ok <span class="token operator">:=</span> this<span class="token punctuation">.</span>server<span class="token punctuation">.</span>OnlineMap<span class="token punctuation">[</span>remoteName<span class="token punctuation">]</span>
        <span class="token keyword">if</span> <span class="token operator">!</span>ok <span class="token punctuation">{</span>
            this<span class="token punctuation">.</span><span class="token function">SendMsg</span><span class="token punctuation">(</span><span class="token string">"该用户名不不存在\n"</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span>
        <span class="token punctuation">}</span>
 
        <span class="token comment">//3 获取消息内容，通过对方的User对象将消息内容发送过去</span>
        content <span class="token operator">:=</span> strings<span class="token punctuation">.</span><span class="token function">Split</span><span class="token punctuation">(</span>msg<span class="token punctuation">,</span> <span class="token string">"|"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>
        <span class="token keyword">if</span> content <span class="token operator">==</span> <span class="token string">""</span> <span class="token punctuation">{</span>
            this<span class="token punctuation">.</span><span class="token function">SendMsg</span><span class="token punctuation">(</span><span class="token string">"无消息内容，请重发\n"</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span>
        <span class="token punctuation">}</span>
        remoteUser<span class="token punctuation">.</span><span class="token function">SendMsg</span><span class="token punctuation">(</span>this<span class="token punctuation">.</span>Name <span class="token operator">+</span> <span class="token string">"对您说:"</span> <span class="token operator">+</span> content<span class="token punctuation">)</span>
 
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        this<span class="token punctuation">.</span>server<span class="token punctuation">.</span><span class="token function">BroadCast</span><span class="token punctuation">(</span>this<span class="token punctuation">,</span> msg<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>





<h2 id="版本九：客户端实现"><a href="#版本九：客户端实现" class="headerlink" title="版本九：客户端实现"></a>版本九：客户端实现</h2><ul>
<li>新建Client.go嗷！！！</li>
</ul>
<pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">package</span> main
 
<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">"flag"</span>
    <span class="token string">"fmt"</span>
    <span class="token string">"io"</span>
    <span class="token string">"net"</span>
    <span class="token string">"os"</span>
<span class="token punctuation">)</span>
 
<span class="token keyword">type</span> Client <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    ServerIp   <span class="token builtin">string</span>
    ServerPort <span class="token builtin">int</span>
    Name       <span class="token builtin">string</span>
    conn       net<span class="token punctuation">.</span>Conn
    flag       <span class="token builtin">int</span> <span class="token comment">//当前client的模式</span>
<span class="token punctuation">}</span>
 
<span class="token keyword">func</span> <span class="token function">NewClient</span><span class="token punctuation">(</span>serverIp <span class="token builtin">string</span><span class="token punctuation">,</span> serverPort <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">*</span>Client <span class="token punctuation">{</span>
    <span class="token comment">//创建客户端对象</span>
    client <span class="token operator">:=</span> <span class="token operator">&amp;</span>Client<span class="token punctuation">{</span>
        ServerIp<span class="token punctuation">:</span>   serverIp<span class="token punctuation">,</span>
        ServerPort<span class="token punctuation">:</span> serverPort<span class="token punctuation">,</span>
        flag<span class="token punctuation">:</span>       <span class="token number">999</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
 
    <span class="token comment">//链接server</span>
    conn<span class="token punctuation">,</span> err <span class="token operator">:=</span> net<span class="token punctuation">.</span><span class="token function">Dial</span><span class="token punctuation">(</span><span class="token string">"tcp"</span><span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">"%s:%d"</span><span class="token punctuation">,</span> serverIp<span class="token punctuation">,</span> serverPort<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"net.Dial error:"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">nil</span>
    <span class="token punctuation">}</span>
 
    client<span class="token punctuation">.</span>conn <span class="token operator">=</span> conn
 
    <span class="token comment">//返回对象</span>
    <span class="token keyword">return</span> client
<span class="token punctuation">}</span>
 
<span class="token comment">//处理server回应的消息， 直接显示到标准输出即可</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>client <span class="token operator">*</span>Client<span class="token punctuation">)</span> <span class="token function">DealResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//一旦client.conn有数据，就直接copy到stdout标准输出上, 永久阻塞监听</span>
    io<span class="token punctuation">.</span><span class="token function">Copy</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>Stdout<span class="token punctuation">,</span> client<span class="token punctuation">.</span>conn<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
 
<span class="token keyword">func</span> <span class="token punctuation">(</span>client <span class="token operator">*</span>Client<span class="token punctuation">)</span> <span class="token function">menu</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">bool</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> flag <span class="token builtin">int</span>
 
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"1.公聊模式"</span><span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"2.私聊模式"</span><span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"3.更新用户名"</span><span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"0.退出"</span><span class="token punctuation">)</span>
 
    fmt<span class="token punctuation">.</span><span class="token function">Scanln</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>flag<span class="token punctuation">)</span>
 
    <span class="token keyword">if</span> flag <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> flag <span class="token operator">&lt;=</span> <span class="token number">3</span> <span class="token punctuation">{</span>
        client<span class="token punctuation">.</span>flag <span class="token operator">=</span> flag
        <span class="token keyword">return</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"&gt;&gt;&gt;&gt;请输入合法范围内的数字&lt;&lt;&lt;&lt;"</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
 
<span class="token punctuation">}</span>
 
<span class="token comment">//查询在线用户</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>client <span class="token operator">*</span>Client<span class="token punctuation">)</span> <span class="token function">SelectUsers</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    sendMsg <span class="token operator">:=</span> <span class="token string">"who\n"</span>
    <span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span>conn<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>sendMsg<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"conn Write err:"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
 
<span class="token comment">//私聊模式</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>client <span class="token operator">*</span>Client<span class="token punctuation">)</span> <span class="token function">PrivateChat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> remoteName <span class="token builtin">string</span>
    <span class="token keyword">var</span> chatMsg <span class="token builtin">string</span>
 
    client<span class="token punctuation">.</span><span class="token function">SelectUsers</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"&gt;&gt;&gt;&gt;请输入聊天对象[用户名], exit退出:"</span><span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Scanln</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>remoteName<span class="token punctuation">)</span>
 
    <span class="token keyword">for</span> remoteName <span class="token operator">!=</span> <span class="token string">"exit"</span> <span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"&gt;&gt;&gt;&gt;请输入消息内容, exit退出:"</span><span class="token punctuation">)</span>
        fmt<span class="token punctuation">.</span><span class="token function">Scanln</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>chatMsg<span class="token punctuation">)</span>
 
        <span class="token keyword">for</span> chatMsg <span class="token operator">!=</span> <span class="token string">"exit"</span> <span class="token punctuation">{</span>
            <span class="token comment">//消息不为空则发送</span>
            <span class="token keyword">if</span> <span class="token function">len</span><span class="token punctuation">(</span>chatMsg<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token punctuation">{</span>
                sendMsg <span class="token operator">:=</span> <span class="token string">"to|"</span> <span class="token operator">+</span> remoteName <span class="token operator">+</span> <span class="token string">"|"</span> <span class="token operator">+</span> chatMsg <span class="token operator">+</span> <span class="token string">"\n\n"</span>
                <span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span>conn<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>sendMsg<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
                    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"conn Write err:"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
                    <span class="token keyword">break</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
 
            chatMsg <span class="token operator">=</span> <span class="token string">""</span>
            fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"&gt;&gt;&gt;&gt;请输入消息内容, exit退出:"</span><span class="token punctuation">)</span>
            fmt<span class="token punctuation">.</span><span class="token function">Scanln</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>chatMsg<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
 
        client<span class="token punctuation">.</span><span class="token function">SelectUsers</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"&gt;&gt;&gt;&gt;请输入聊天对象[用户名], exit退出:"</span><span class="token punctuation">)</span>
        fmt<span class="token punctuation">.</span><span class="token function">Scanln</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>remoteName<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
 
<span class="token keyword">func</span> <span class="token punctuation">(</span>client <span class="token operator">*</span>Client<span class="token punctuation">)</span> <span class="token function">PublicChat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//提示用户输入消息</span>
    <span class="token keyword">var</span> chatMsg <span class="token builtin">string</span>
 
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"&gt;&gt;&gt;&gt;请输入聊天内容，exit退出."</span><span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Scanln</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>chatMsg<span class="token punctuation">)</span>
 
    <span class="token keyword">for</span> chatMsg <span class="token operator">!=</span> <span class="token string">"exit"</span> <span class="token punctuation">{</span>
        <span class="token comment">//发给服务器</span>
 
        <span class="token comment">//消息不为空则发送</span>
        <span class="token keyword">if</span> <span class="token function">len</span><span class="token punctuation">(</span>chatMsg<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token punctuation">{</span>
            sendMsg <span class="token operator">:=</span> chatMsg <span class="token operator">+</span> <span class="token string">"\n"</span>
            <span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span>conn<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>sendMsg<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
                fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"conn Write err:"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
                <span class="token keyword">break</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
 
        chatMsg <span class="token operator">=</span> <span class="token string">""</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"&gt;&gt;&gt;&gt;请输入聊天内容，exit退出."</span><span class="token punctuation">)</span>
        fmt<span class="token punctuation">.</span><span class="token function">Scanln</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>chatMsg<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
 
<span class="token punctuation">}</span>
 
<span class="token keyword">func</span> <span class="token punctuation">(</span>client <span class="token operator">*</span>Client<span class="token punctuation">)</span> <span class="token function">UpdateName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">bool</span> <span class="token punctuation">{</span>
 
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"&gt;&gt;&gt;&gt;请输入用户名:"</span><span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Scanln</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>client<span class="token punctuation">.</span>Name<span class="token punctuation">)</span>
 
    sendMsg <span class="token operator">:=</span> <span class="token string">"rename|"</span> <span class="token operator">+</span> client<span class="token punctuation">.</span>Name <span class="token operator">+</span> <span class="token string">"\n"</span>
    <span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span>conn<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>sendMsg<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"conn.Write err:"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
 
    <span class="token keyword">return</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
 
<span class="token keyword">func</span> <span class="token punctuation">(</span>client <span class="token operator">*</span>Client<span class="token punctuation">)</span> <span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> client<span class="token punctuation">.</span>flag <span class="token operator">!=</span> <span class="token number">0</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> client<span class="token punctuation">.</span><span class="token function">menu</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token boolean">true</span> <span class="token punctuation">{</span>
        <span class="token punctuation">}</span>
 
        <span class="token comment">//根据不同的模式处理不同的业务</span>
        <span class="token keyword">switch</span> client<span class="token punctuation">.</span>flag <span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token number">1</span><span class="token punctuation">:</span>
            <span class="token comment">//公聊模式</span>
            client<span class="token punctuation">.</span><span class="token function">PublicChat</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">break</span>
        <span class="token keyword">case</span> <span class="token number">2</span><span class="token punctuation">:</span>
            <span class="token comment">//私聊模式</span>
            client<span class="token punctuation">.</span><span class="token function">PrivateChat</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">break</span>
        <span class="token keyword">case</span> <span class="token number">3</span><span class="token punctuation">:</span>
            <span class="token comment">//更新用户名</span>
            client<span class="token punctuation">.</span><span class="token function">UpdateName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">break</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
 
<span class="token keyword">var</span> serverIp <span class="token builtin">string</span>
<span class="token keyword">var</span> serverPort <span class="token builtin">int</span>
 
<span class="token comment">//./client -ip 127.0.0.1 -port 8888</span>
<span class="token keyword">func</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    flag<span class="token punctuation">.</span><span class="token function">StringVar</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>serverIp<span class="token punctuation">,</span> <span class="token string">"ip"</span><span class="token punctuation">,</span> <span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span> <span class="token string">"设置服务器IP地址(默认是127.0.0.1)"</span><span class="token punctuation">)</span>
    flag<span class="token punctuation">.</span><span class="token function">IntVar</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>serverPort<span class="token punctuation">,</span> <span class="token string">"port"</span><span class="token punctuation">,</span> <span class="token number">8888</span><span class="token punctuation">,</span> <span class="token string">"设置服务器端口(默认是8888)"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
 
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//命令行解析</span>
    flag<span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 
    client <span class="token operator">:=</span> <span class="token function">NewClient</span><span class="token punctuation">(</span>serverIp<span class="token punctuation">,</span> serverPort<span class="token punctuation">)</span>
    <span class="token keyword">if</span> client <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"&gt;&gt;&gt;&gt;&gt; 链接服务器失败..."</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
 
    <span class="token comment">//单独开启一个goroutine去处理server的回执消息</span>
    <span class="token keyword">go</span> client<span class="token punctuation">.</span><span class="token function">DealResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"&gt;&gt;&gt;&gt;&gt;链接服务器成功..."</span><span class="token punctuation">)</span>
 
    <span class="token comment">//启动客户端的业务</span>
    client<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>Init的使用，Init是一个非常有意思的东西，可以指定某些参数的值为定值，同时init()会在main之前执行嗷！！！</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211025154852.png" alt="image-20211025154843964"></p>
<h1 id="Golang生态拓展介绍"><a href="#Golang生态拓展介绍" class="headerlink" title="Golang生态拓展介绍"></a>Golang生态拓展介绍</h1><ol>
<li>Web框架：<ul>
<li>beego</li>
<li>gin</li>
<li>echo</li>
<li>lris</li>
</ul>
</li>
<li>微服务框架：<ul>
<li>Go kit</li>
<li>Istio</li>
</ul>
</li>
<li>容器编排：<ul>
<li>K8S</li>
<li>swarm</li>
</ul>
</li>
<li>服务发现：<ul>
<li>Consul</li>
</ul>
</li>
<li>存储引擎：<ul>
<li>etcd</li>
<li>tidb</li>
</ul>
</li>
<li>静态建站：<ul>
<li>hugo</li>
</ul>
</li>
<li>中间键：<ul>
<li>nsg</li>
<li>zinx</li>
<li>Leaf</li>
<li>gRPC</li>
<li>codis</li>
</ul>
</li>
<li>爬虫框架：<ul>
<li>go query</li>
</ul>
</li>
</ol>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://example.com">Alexander Liu</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2021/10/12/chu-shi-go-yu-yan/">http://example.com/2021/10/12/chu-shi-go-yu-yan/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">兔の博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%A4%A7%E4%B8%89%E8%87%AA%E5%AD%A6/">大三自学</a></div><div class="post_share"><div class="social-share" data-image="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/10/16/lun-wen-jing-du/"><img class="prev-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">论文精读之MapReduce</div></div></a></div><div class="next-post pull-right"><a href="/2021/09/27/java-da-han-chang-wen-mian-shi-ti-2/"><img class="next-cover" src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211012103611.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Java常问面试题总结与提高2</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2021/08/05/java-da-han-chang-wen-mian-shi-ti/" title="Java常问面试题总结与提高"><img class="cover" src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211012103611.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-08-05</div><div class="title">Java常问面试题总结与提高</div></div></a></div><div><a href="/2021/09/27/java-da-han-chang-wen-mian-shi-ti-2/" title="Java常问面试题总结与提高2"><img class="cover" src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/img/20211012103611.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-09-27</div><div class="title">Java常问面试题总结与提高2</div></div></a></div><div><a href="/2022/01/16/ml-ru-men/" title="ML入门"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-01-16</div><div class="title">ML入门</div></div></a></div><div><a href="/2021/12/28/da-shu-ju-fen-xi-yu-zhi-neng-ji-suan-qi-mo-fu-xi-3/" title="大数据分析与智能计算期末复习3"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-12-28</div><div class="title">大数据分析与智能计算期末复习3</div></div></a></div><div><a href="/2021/09/14/da-shu-ju-fen-xi-ke-cheng/" title="大数据分析课程"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-09-14</div><div class="title">大数据分析课程</div></div></a></div><div><a href="/2021/12/20/da-shu-ju-fen-xi-yu-zhi-neng-ji-suan-qi-mo-fu-xi/" title="大数据分析与智能计算期末复习"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-12-20</div><div class="title">大数据分析与智能计算期末复习</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Alexander Liu</div><div class="author-info__description">欢迎来到兔子的小窝，这里是兔子的一些笔记分享</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">75</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">15</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Go%E9%9D%9E%E5%B8%B8%E6%9C%89%E6%84%8F%E6%80%9D%E7%9A%84%E4%B8%80%E9%97%A8%E8%AF%AD%E8%A8%80%EF%BC%8C%E8%BF%99%E4%B8%80%E6%AC%A1%E7%9A%84%E5%AD%A6%E4%B9%A0%E5%81%8F%E5%90%91%E4%BA%8E%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%EF%BC%8C%E5%90%8E%E9%9D%A2%E5%8F%AF%E8%83%BD%E8%BF%98%E4%BC%9A%E6%8E%A5%E8%A7%A6%E5%B7%A5%E7%A8%8B%E9%A1%B9%E7%9B%AE%EF%BC%8C%E6%80%BB%E4%B9%8B%E5%85%88%E6%8A%8A%E5%9F%BA%E7%A1%80%E6%89%93%E5%A5%BD%EF%BC%81%EF%BC%81%EF%BC%81"><span class="toc-number">1.</span> <span class="toc-text">Go非常有意思的一门语言，这一次的学习偏向于基础知识，后面可能还会接触工程项目，总之先把基础打好！！！</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE"><span class="toc-number">2.</span> <span class="toc-text">基础环境配置</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B7%E4%BD%93%E6%AD%A5%E9%AA%A4%EF%BC%9A"><span class="toc-number">2.1.</span> <span class="toc-text">具体步骤：</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Go%E7%9A%84%E5%BA%8F%E8%A8%80"><span class="toc-number">3.</span> <span class="toc-text">Go的序言</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BC%98%E5%8A%BF%EF%BC%9A"><span class="toc-number">3.1.</span> <span class="toc-text">优势：</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%83%A8%E7%BD%B2%E7%AE%80%E5%8D%95%EF%BC%9A"><span class="toc-number">3.1.1.</span> <span class="toc-text">部署简单：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%99%E6%80%81%E7%B1%BB%E5%9E%8B%E8%AF%AD%E8%A8%80%EF%BC%9A"><span class="toc-number">3.1.2.</span> <span class="toc-text">静态类型语言：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%AD%E8%A8%80%E5%B1%82%E9%9D%A2%E7%9A%84%E5%B9%B6%E5%8F%91%EF%BC%9A"><span class="toc-number">3.1.3.</span> <span class="toc-text">语言层面的并发：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%BA%E5%A4%A7%E7%9A%84%E6%A0%87%E5%87%86%E5%8C%96%EF%BC%9A"><span class="toc-number">3.1.4.</span> <span class="toc-text">强大的标准化：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E6%98%93%E5%AD%A6%EF%BC%9A"><span class="toc-number">3.1.5.</span> <span class="toc-text">简单易学：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%A7%E5%8E%82%E9%A2%86%E5%86%9B%EF%BC%9A"><span class="toc-number">3.1.6.</span> <span class="toc-text">大厂领军：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%82%E7%94%A8%E9%A2%86%E5%9F%9F%EF%BC%9A"><span class="toc-number">3.2.</span> <span class="toc-text">适用领域：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8D%E8%B6%B3%EF%BC%9A"><span class="toc-number">3.3.</span> <span class="toc-text">不足：</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%AE%A4%E8%AF%86Go%E7%A8%8B%E5%BA%8F"><span class="toc-number">4.</span> <span class="toc-text">认识Go程序</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%AD%E6%B3%95%EF%BC%9A"><span class="toc-number">4.1.</span> <span class="toc-text">语法：</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E7%A8%8B%E5%BA%8F%E5%85%A5%E9%97%A8%EF%BC%9A"><span class="toc-number">4.1.1.</span> <span class="toc-text">简单程序入门：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%98%E9%87%8F%E5%A3%B0%E6%98%8E%EF%BC%9A"><span class="toc-number">4.1.2.</span> <span class="toc-text">变量声明：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Const%E4%B8%8EIota%E7%9F%A5%E8%AF%86%E7%82%B9%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">4.1.3.</span> <span class="toc-text">Const与Iota知识点注意事项</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E7%9A%84%E5%A4%9A%E8%BF%94%E5%9B%9E%E5%80%BC%E4%B8%89%E7%A7%8D%E5%86%99%E6%B3%95"><span class="toc-number">4.1.4.</span> <span class="toc-text">函数的多返回值三种写法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Import%E5%AF%BC%E5%8C%85%E8%B7%AF%E5%BE%84%E5%92%8CInit%E6%96%B9%E6%B3%95"><span class="toc-number">4.1.5.</span> <span class="toc-text">Import导包路径和Init方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Import%E5%8C%BF%E5%90%8D%E5%8F%8A%E5%88%AB%E5%90%8D%E5%AF%BC%E5%8C%85%E6%96%B9%E5%BC%8F"><span class="toc-number">4.1.6.</span> <span class="toc-text">Import匿名及别名导包方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Golang%E4%B8%AD%E7%9A%84%E6%8C%87%E9%92%88%E9%80%9F%E9%80%9A"><span class="toc-number">4.1.7.</span> <span class="toc-text">Golang中的指针速通</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#defer%E8%AF%AD%E5%8F%A5"><span class="toc-number">4.1.8.</span> <span class="toc-text">defer语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Go%E4%B8%AD%E7%9A%84Slice"><span class="toc-number">4.1.9.</span> <span class="toc-text">Go中的Slice</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Slice%E7%9A%84%E5%A3%B0%E6%98%8E%E6%96%B9%E5%BC%8F"><span class="toc-number">4.1.9.1.</span> <span class="toc-text">Slice的声明方式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Slice%E7%9A%84%E4%BD%BF%E7%94%A8%E6%96%B9%E5%BC%8F"><span class="toc-number">4.1.9.2.</span> <span class="toc-text">Slice的使用方式</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Go%E4%B8%AD%E7%9A%84Map"><span class="toc-number">4.1.10.</span> <span class="toc-text">Go中的Map</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Map%E7%9A%84%E5%A3%B0%E6%98%8E%E6%96%B9%E5%BC%8F"><span class="toc-number">4.1.10.1.</span> <span class="toc-text">Map的声明方式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Map%E7%9A%84%E4%BD%BF%E7%94%A8%E6%96%B9%E5%BC%8F"><span class="toc-number">4.1.10.2.</span> <span class="toc-text">Map的使用方式</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#struct%E7%9A%84%E5%9F%BA%E6%9C%AC%E5%AE%9A%E4%B9%89%E5%92%8C%E4%BD%BF%E7%94%A8"><span class="toc-number">4.1.11.</span> <span class="toc-text">struct的基本定义和使用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%B1%BB%E7%9A%84%E8%A1%A8%E7%A4%BA%EF%BC%9A"><span class="toc-number">4.1.11.1.</span> <span class="toc-text">类的表示：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%B1%BB%E7%9A%84%E7%BB%A7%E6%89%BF%EF%BC%9A"><span class="toc-number">4.1.11.2.</span> <span class="toc-text">类的继承：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Interface%E7%9A%84%E5%9F%BA%E6%9C%AC%E5%AE%9A%E4%B9%89%E5%92%8C%E4%BD%BF%E7%94%A8"><span class="toc-number">4.1.12.</span> <span class="toc-text">Interface的基本定义和使用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%9A%E6%80%81%E7%9A%84%E5%AE%9E%E7%8E%B0%EF%BC%9A"><span class="toc-number">4.1.12.1.</span> <span class="toc-text">多态的实现：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%9A%E7%94%A8%E4%B8%87%E8%83%BD%E7%B1%BB%E5%9E%8B%EF%BC%88%E7%A9%BA%E6%8E%A5%E5%8F%A3%EF%BC%89%EF%BC%9A"><span class="toc-number">4.1.12.2.</span> <span class="toc-text">通用万能类型（空接口）：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Reflect%E5%8F%8D%E5%B0%84%E6%9C%BA%E5%88%B6"><span class="toc-number">4.1.13.</span> <span class="toc-text">Reflect反射机制</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%8D%E5%B0%84%E8%A7%A3%E6%9E%90%E7%BB%93%E6%9E%84%E4%BD%93%E6%A0%87%E7%AD%BEtag"><span class="toc-number">4.1.13.1.</span> <span class="toc-text">反射解析结构体标签tag</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%93%E6%9E%84%E4%BD%93%E6%A0%87%E7%AD%BE%E5%9C%A8JSON%E4%B8%AD%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">4.1.13.2.</span> <span class="toc-text">结构体标签在JSON中的使用</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GoRoutine"><span class="toc-number">5.</span> <span class="toc-text">GoRoutine</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%BE%E8%AE%A1%E7%AD%96%E7%95%A5%EF%BC%9A"><span class="toc-number">5.1.</span> <span class="toc-text">设计策略：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9B%E5%BB%BAGoRoutine%EF%BC%9A"><span class="toc-number">5.2.</span> <span class="toc-text">创建GoRoutine：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%9A%E4%BF%A1%E6%9C%BA%E5%88%B6Channel%EF%BC%9A"><span class="toc-number">5.3.</span> <span class="toc-text">通信机制Channel：</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E7%BC%93%E5%86%B2Channel%EF%BC%9A"><span class="toc-number">5.3.1.</span> <span class="toc-text">无缓冲Channel：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%89%E7%BC%93%E5%86%B2Channel%EF%BC%9A"><span class="toc-number">5.3.2.</span> <span class="toc-text">有缓冲Channel：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B3%E9%97%ADChannel%EF%BC%9A"><span class="toc-number">5.3.3.</span> <span class="toc-text">关闭Channel：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Channel%E5%92%8Crange%EF%BC%9A"><span class="toc-number">5.3.4.</span> <span class="toc-text">Channel和range：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Channel%E5%92%8Cselect%EF%BC%9A"><span class="toc-number">5.3.5.</span> <span class="toc-text">Channel和select：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GOMODULES"><span class="toc-number">6.</span> <span class="toc-text">GOMODULES</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F%E5%BC%8A%E7%AB%AF"><span class="toc-number">6.1.</span> <span class="toc-text">工作模式弊端</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GoModules%E6%A8%A1%E5%BC%8F"><span class="toc-number">6.2.</span> <span class="toc-text">GoModules模式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Go-Modules%E5%88%9D%E5%A7%8B%E5%8C%96%E9%A1%B9%E7%9B%AE"><span class="toc-number">6.3.</span> <span class="toc-text">Go Modules初始化项目</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%94%B9%E5%8F%98%E6%A8%A1%E5%9D%97%E4%BE%9D%E8%B5%96%E5%85%B3%E7%B3%BB"><span class="toc-number">6.4.</span> <span class="toc-text">改变模块依赖关系</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%B3%E6%97%B6%E9%80%9A%E4%BF%A1%E7%B3%BB%E7%BB%9F%E5%B0%8F%E9%A1%B9%E7%9B%AE"><span class="toc-number">7.</span> <span class="toc-text">即时通信系统小项目</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%88%E6%9C%AC%E4%B8%80%EF%BC%9A%E6%9E%84%E5%BB%BA%E5%9F%BA%E7%A1%80Server"><span class="toc-number">7.1.</span> <span class="toc-text">版本一：构建基础Server</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%88%E6%9C%AC%E4%BA%8C%EF%BC%9A%E7%94%A8%E6%88%B7%E4%B8%8A%E7%BA%BF%E5%8A%9F%E8%83%BD"><span class="toc-number">7.2.</span> <span class="toc-text">版本二：用户上线功能</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%88%E6%9C%AC%E4%B8%89%EF%BC%9A%E7%94%A8%E6%88%B7%E6%B6%88%E6%81%AF%E5%B9%BF%E6%92%AD%E6%9C%BA%E5%88%B6"><span class="toc-number">7.3.</span> <span class="toc-text">版本三：用户消息广播机制</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%88%E6%9C%AC%E5%9B%9B%EF%BC%9A%E7%94%A8%E6%88%B7%E4%B8%9A%E5%8A%A1%E5%B1%82%E5%B0%81%E8%A3%85"><span class="toc-number">7.4.</span> <span class="toc-text">版本四：用户业务层封装</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%88%E6%9C%AC%E4%BA%94%EF%BC%9A%E5%9C%A8%E7%BA%BF%E7%94%A8%E6%88%B7%E6%9F%A5%E8%AF%A2"><span class="toc-number">7.5.</span> <span class="toc-text">版本五：在线用户查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%88%E6%9C%AC%E5%85%AD%EF%BC%9A%E4%BF%AE%E6%94%B9%E7%94%A8%E6%88%B7%E5%90%8D"><span class="toc-number">7.6.</span> <span class="toc-text">版本六：修改用户名</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%88%E6%9C%AC%E4%B8%83%EF%BC%9A%E8%B6%85%E6%97%B6%E5%BC%BA%E8%B8%A2%E5%8A%9F%E8%83%BD"><span class="toc-number">7.7.</span> <span class="toc-text">版本七：超时强踢功能</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%88%E6%9C%AC%E5%85%AB%EF%BC%9A%E7%A7%81%E8%81%8A%E5%8A%9F%E8%83%BD"><span class="toc-number">7.8.</span> <span class="toc-text">版本八：私聊功能</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%88%E6%9C%AC%E4%B9%9D%EF%BC%9A%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%AE%9E%E7%8E%B0"><span class="toc-number">7.9.</span> <span class="toc-text">版本九：客户端实现</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Golang%E7%94%9F%E6%80%81%E6%8B%93%E5%B1%95%E4%BB%8B%E7%BB%8D"><span class="toc-number">8.</span> <span class="toc-text">Golang生态拓展介绍</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/12/07/cao-zuo-xi-tong-gai-shu/" title="1. 南京大学操作系统概述"><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/blog_img/img/202212071136497.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="1. 南京大学操作系统概述"/></a><div class="content"><a class="title" href="/2022/12/07/cao-zuo-xi-tong-gai-shu/" title="1. 南京大学操作系统概述">1. 南京大学操作系统概述</a><time datetime="2022-12-07T03:35:42.000Z" title="发表于 2022-12-07 11:35:42">2022-12-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/12/05/cpu-cache-xue-xi/" title="CPU Cache 学习"><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/blog_img/img/202212051319709.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CPU Cache 学习"/></a><div class="content"><a class="title" href="/2022/12/05/cpu-cache-xue-xi/" title="CPU Cache 学习">CPU Cache 学习</a><time datetime="2022-12-05T04:14:46.000Z" title="发表于 2022-12-05 12:14:46">2022-12-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/01/16/ml-ru-men/" title="ML入门"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ML入门"/></a><div class="content"><a class="title" href="/2022/01/16/ml-ru-men/" title="ML入门">ML入门</a><time datetime="2022-01-16T11:11:14.000Z" title="发表于 2022-01-16 19:11:14">2022-01-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/12/28/da-shu-ju-fen-xi-yu-zhi-neng-ji-suan-qi-mo-fu-xi-3/" title="大数据分析与智能计算期末复习3"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="大数据分析与智能计算期末复习3"/></a><div class="content"><a class="title" href="/2021/12/28/da-shu-ju-fen-xi-yu-zhi-neng-ji-suan-qi-mo-fu-xi-3/" title="大数据分析与智能计算期末复习3">大数据分析与智能计算期末复习3</a><time datetime="2021-12-28T14:05:22.000Z" title="发表于 2021-12-28 22:05:22">2021-12-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/12/24/da-shu-ju-fen-xi-yu-zhi-neng-ji-suan-qi-mo-fu-xi-2/" title="大数据分析与智能计算期末复习2"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="大数据分析与智能计算期末复习2"/></a><div class="content"><a class="title" href="/2021/12/24/da-shu-ju-fen-xi-yu-zhi-neng-ji-suan-qi-mo-fu-xi-2/" title="大数据分析与智能计算期末复习2">大数据分析与智能计算期末复习2</a><time datetime="2021-12-24T07:59:54.000Z" title="发表于 2021-12-24 15:59:54">2021-12-24</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By Alexander Liu</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>