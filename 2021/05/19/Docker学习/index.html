<!DOCTYPE HTML>
<html lang="en">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="Docker学习, Hexo">
    <meta name="description" content="B站狂神说docker教程，SpringMVC太干了听不下去，先听会儿这个转换心情。



Docker入门Docker为啥会出现
开发 —&amp;gt; 上线 ， 两套环境！应用环境，应用配置！

问题：我在我都电脑上可以跑哇？？？

版本更新">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>Docker学习 | Hexo</title>
    <link rel="icon" type="image/png" href="/favicon.png">
    


    <!-- bg-cover style     -->



<link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
<link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
<link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
<link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
<link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
<link rel="stylesheet" type="text/css" href="/css/matery.css">
<link rel="stylesheet" type="text/css" href="/css/my.css">
<link rel="stylesheet" type="text/css" href="/css/dark.css" media="none" onload="if(media!='all')media='all'">




    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
    <link rel="stylesheet" href="/css/post.css">




    
        <link rel="stylesheet" type="text/css" href="/css/reward.css">
    



    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 6.2.0"></head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">Hexo</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>Index</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>Tags</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>Categories</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>Archives</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>About</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>Contact</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>Friends</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="Search" style="zoom: 0.85;"></i>
    </a>
  </li>
  <li>
    <a href="javascript:;" class="waves-effect waves-light" onclick="switchNightMode()" title="深色/浅色模式" >
      <i id="sum-moon-icon" class="fas fa-sun" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">Hexo</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			Index
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			Tags
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			Categories
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			Archives
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			About
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			Contact
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			Friends
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/blinkfox/hexo-theme-matery" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/blinkfox/hexo-theme-matery" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/10.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">Docker学习</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/%E5%90%8E%E7%AB%AF/">
                                <span class="chip bg-color">后端</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>Publish Date:&nbsp;&nbsp;
                    2021-05-19
                </div>
                

                

                

                

                
            </div>
        </div>
        <hr class="clearfix">

        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="B站狂神说docker教程，SpringMVC太干了听不下去，先听会儿这个转换心情。"><a href="#B站狂神说docker教程，SpringMVC太干了听不下去，先听会儿这个转换心情。" class="headerlink" title="B站狂神说docker教程，SpringMVC太干了听不下去，先听会儿这个转换心情。"></a>B站狂神说docker教程，SpringMVC太干了听不下去，先听会儿这个转换心情。</h1><span id="more"></span>



<h1 id="Docker入门"><a href="#Docker入门" class="headerlink" title="Docker入门"></a>Docker入门</h1><h2 id="Docker为啥会出现"><a href="#Docker为啥会出现" class="headerlink" title="Docker为啥会出现"></a>Docker为啥会出现</h2><ul>
<li><p>开发 —&gt; 上线 ， 两套环境！应用环境，应用配置！</p>
</li>
<li><p>问题：我在我都电脑上可以跑哇？？？</p>
</li>
<li><p>版本更新，导致服务不可用，运维裂开来。</p>
</li>
<li><p>开发即运维。</p>
</li>
</ul>
<blockquote>
<ul>
<li>发布一个项目 jar + (Redis MySQL jdk ES) , 环境和项目打包，项目带上环境安装打包</li>
<li>传统：<ul>
<li>传统：开发jar , 运维来做</li>
<li>现在：开发打包部署上线，一套流程完成</li>
</ul>
</li>
<li>Docker为上面问题提供了解决方案嗷！！！</li>
<li>Docker仓库就类似于镜像，环境和内部打包好了就上线到商店里面，有需要下载下来就可以直接跑的嗷！</li>
</ul>
</blockquote>
<ul>
<li>隔离是docker的核心思想，每个箱子是相互隔离的。</li>
<li>docker的隔离机制可以充分利用服务器资源，端口冲突的问题也可以通过docker来解决。</li>
<li>本质：新的技术的出现都是为了解决问题。</li>
</ul>
<h2 id="Docker的历史"><a href="#Docker的历史" class="headerlink" title="Docker的历史"></a>Docker的历史</h2><ul>
<li>2010年一帮人搞了一个容器化技术，命名为Docker。为了解决类似于VMWare，太重量的东西。</li>
<li>2013年Docker开源了，Docker是真的非常好用哦！！！每一个月Docker都会更新一个版本。</li>
<li>2014年4月9日，Docker1.0发布。</li>
<li>为啥火？容器技术出现之前，使用虚拟机技术。</li>
</ul>
<blockquote>
<p>虚拟机：win10上装一个VMWare，子电脑，可以虚拟电脑，但是太大了笨重。</p>
<p>Docker：容器技术，本质上也是虚拟化技术，但是轻量级。镜像（最核心的环境），十分小巧，运行镜像就可以了。小巧。（几兆，几十兆就可以启动，秒级启动，爽啦。）</p>
</blockquote>
<ul>
<li>Docker是基于go语言开发的开源项目。</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://docs.docker.com/get-docker/">docker的官方文档</a>，这个文档超级详细，力赞。</p>
<p><a target="_blank" rel="noopener" href="https://hub.docker.com/">dockerhub官网</a>，和github是一样的，和github很像，push pull都有。</p>
<h2 id="Docker能干啥"><a href="#Docker能干啥" class="headerlink" title="Docker能干啥"></a>Docker能干啥</h2><ul>
<li>虚拟机技术的缺点：<ul>
<li>资源占用多</li>
<li>冗余步骤多</li>
<li>启动很慢</li>
</ul>
</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210521172228.png" alt="image-20210521172228149"></p>
<ul>
<li>容器化技术：<ul>
<li>不是模拟一个完整的容器：</li>
</ul>
</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210521172330.png" alt="image-20210521172330732"></p>
<ul>
<li>容器没有自己的内核，也没有虚拟我们的硬件，所以就轻便了。</li>
<li>每个容器相互隔离的，不影响的。</li>
<li>应用更加快速的交付和部署。</li>
<li>更加便捷的升级和扩缩容量。</li>
<li>更加简单的系统运维。</li>
<li>更高效的计算资源利用，Docker是内核级别的虚拟化嗷，可以将服务器的性能压榨到极致。</li>
</ul>
<h2 id="Docker的架构"><a href="#Docker的架构" class="headerlink" title="Docker的架构"></a>Docker的架构</h2><p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210521173517.png" alt="image-20210521173517895"></p>
<ul>
<li>从左到右为服务端，客户端和仓库。</li>
</ul>
<h3 id="镜像-image-："><a href="#镜像-image-：" class="headerlink" title="镜像( image )："></a>镜像( image )：</h3><ul>
<li>docker镜像就好比是一个模板，可以通过这个模板来创建容器服务，tomcat -&gt; run -&gt; 容器。一个镜像可以创建多个容器。</li>
</ul>
<h3 id="容器-container-："><a href="#容器-container-：" class="headerlink" title="容器( container )："></a>容器( container )：</h3><ul>
<li>Docker利用容器技术，独立运行一个或者一个组运用，通过镜像来创建。</li>
<li>启动，停止，删除，基本命令</li>
<li>目前就可以把这个容器理解为一个简易的linux系统</li>
</ul>
<h3 id="仓库-repository-："><a href="#仓库-repository-：" class="headerlink" title="仓库(  repository )："></a>仓库(  repository )：</h3><ul>
<li>仓库就是存放镜像的地方。</li>
<li>仓库分为公有仓库和私有仓库。</li>
<li>Docker Hub 默认是国外的，要配置镜像加速的嗷！</li>
</ul>
<h2 id="安装Docker："><a href="#安装Docker：" class="headerlink" title="安装Docker："></a>安装Docker：</h2><blockquote>
<p>环境准备：</p>
<ul>
<li>Linux基础</li>
<li>CentOS 7.6</li>
<li>使用Xshell连接远程服务器进行操作</li>
</ul>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1og4y1q7M4?p=6">Docker安装教程</a></p>
<ul>
<li>可以在腾讯云上实操嗷！！！</li>
</ul>
<h3 id="安装步骤："><a href="#安装步骤：" class="headerlink" title="安装步骤："></a>安装步骤：</h3><blockquote>
<p>查看现在发行的版本：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/os-release</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">上面这个可以查看内核版本</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">下面是显示出来的系统版本，要7以上</span></span><br><span class="line">NAME=&quot;CentOS Linux&quot;</span><br><span class="line">VERSION=&quot;7 (Core)&quot;</span><br><span class="line">ID=&quot;centos&quot;</span><br><span class="line">ID_LIKE=&quot;rhel fedora&quot;</span><br><span class="line">VERSION_ID=&quot;7&quot;</span><br><span class="line">PRETTY_NAME=&quot;CentOS Linux 7 (Core)&quot;</span><br><span class="line">ANSI_COLOR=&quot;0;31&quot;</span><br><span class="line">CPE_NAME=&quot;cpe:/o:centos:centos:7&quot;</span><br><span class="line">HOME_URL=&quot;https://www.centos.org/&quot;</span><br><span class="line">BUG_REPORT_URL=&quot;https://bugs.centos.org/&quot;</span><br><span class="line"></span><br><span class="line">CENTOS_MANTISBT_PROJECT=&quot;CentOS-7&quot;</span><br><span class="line">CENTOS_MANTISBT_PROJECT_VERSION=&quot;7&quot;</span><br><span class="line">REDHAT_SUPPORT_PRODUCT=&quot;centos&quot;</span><br><span class="line">REDHAT_SUPPORT_PRODUCT_VERSION=&quot;7&quot;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>帮助文档中选择对应的系统进行安装：</p>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210522160147.png" alt="image-20210522160140340"></p>
<ul>
<li>接着这里的步骤一步步往下走就好了嗷！！！</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">1. 卸载旧的版本</span></span><br><span class="line"> sudo yum remove docker \</span><br><span class="line">                  docker-client \</span><br><span class="line">                  docker-client-latest \</span><br><span class="line">                  docker-common \</span><br><span class="line">                  docker-latest \</span><br><span class="line">                  docker-latest-logrotate \</span><br><span class="line">                  docker-logrotate \</span><br><span class="line">                  docker-engine</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">2.需要的安装包</span></span><br><span class="line"> sudo yum install -y yum-utils</span><br><span class="line"> </span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"> # </span><span class="language-bash">3.设置镜像仓库，这一步不建议用国外的网站，这里找国内的来用嗷！！！！（不推荐，看下一条嗷！！！）</span></span><br><span class="line"> sudo yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">3.改用国内的镜像（阿里云镜像）来设置仓库地址：</span></span><br><span class="line"> sudo yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">更新yum软件包索引</span></span><br><span class="line">yum makecache fast</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">4.安装docker相关的好东西</span></span><br><span class="line"> sudo yum install docker-ce docker-ce-cli containerd.io</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">docker-ce 是社区版的，ee是企业版的，推荐使用ce。到这里安装就结束了</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">5. 启动docker</span></span><br><span class="line">sudo systemctl start docker</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">6. 运行hello-world 映像来验证是否正确安装了Docker Engine 。</span></span><br><span class="line">sudo docker run hello-world</span><br></pre></td></tr></table></figure>

<ul>
<li>如果要安装指定版本的话，官网有教程哦：</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210522161646.png" alt="image-20210522161646888"></p>
<ul>
<li>当显示下面的内容的时候，docker安装成功：<ul>
<li>执行docker run hello-world：<ul>
<li><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210522161855.png" alt="image-20210522161855830"></li>
</ul>
</li>
<li>使用docker version查看docker版本：<ul>
<li><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210522161921.png" alt="image-20210522161921240"></li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="Docker-run-hello-world："><a href="#Docker-run-hello-world：" class="headerlink" title="Docker run hello-world："></a>Docker run hello-world：</h3><ul>
<li>首先Unable to find image ， 就是没有找到这个镜像</li>
<li>其次就去网上pull hello-world这个东西了。</li>
<li>下载完成之后再执行这个镜像，显示执行结果：</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210522162121.png" alt="image-20210522162121571"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看下载的hello-image镜像</span></span><br><span class="line">docker images</span><br></pre></td></tr></table></figure>

<ul>
<li>结果如下：</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210522162332.png" alt="image-20210522162332833"></p>
<h3 id="卸载docker："><a href="#卸载docker：" class="headerlink" title="卸载docker："></a>卸载docker：</h3><ol>
<li><p>卸载Docker Engine，CLI和Containerd软件包：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo yum remove docker-ce docker-ce-cli containerd.io</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>主机上的映像，容器，卷或自定义配置文件不会自动删除。要删除所有图像，容器和卷：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo <span class="built_in">rm</span> -rf /var/lib/docker</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo <span class="built_in">rm</span> -rf /var/lib/containerd</span></span><br></pre></td></tr></table></figure></li>
</ol>
<p>您必须手动删除所有已编辑的配置文件。</p>
<ul>
<li>官方文档真香啊！！！</li>
</ul>
<h3 id="配置腾讯云加速："><a href="#配置腾讯云加速：" class="headerlink" title="配置腾讯云加速："></a>配置腾讯云加速：</h3><p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/document/product/1207/45596">腾讯云官方文档</a></p>
<ul>
<li><p>适用于 Linux 操作系统实例：</p>
<ol>
<li><p>执行以下命令，打开配置文件。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/docker/daemon.json</span><br></pre></td></tr></table></figure>

<p>切换至编辑模式，添加以下内容，并保存。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">     &quot;registry-mirrors&quot;: [</span><br><span class="line"> &quot;https://mirror.ccs.tencentyun.com&quot;</span><br><span class="line">     ]</span><br><span class="line">     &#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>执行以下命令，重启 Docker 即可。示例命令以 CentOS 7 为例。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl restart docker</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
</ul>
<h3 id="Hello-World流程："><a href="#Hello-World流程：" class="headerlink" title="Hello-World流程："></a>Hello-World流程：</h3><ul>
<li>流程分析图：</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210522164949.png" alt="image-20210522164949462"></p>
<h2 id="底层原理："><a href="#底层原理：" class="headerlink" title="底层原理："></a>底层原理：</h2><ul>
<li>怎么工作的？<ul>
<li>本质上是一个C&#x2F;S接口系统，Docker守护进程运行在主机上，通过socket从客户端访问。</li>
<li>DockerServer接收到Docker-Client的指令，就会执行这个命令。</li>
</ul>
</li>
<li>内部结构：</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210522171235.png" alt="image-20210522171235487"></p>
<ul>
<li>后台是一个大的Linux服务器，通过客户端去连接后台的守护进程，Docker容器在我们的范围之内。每一个小的docker容器好比是一个小的Linux虚拟机。容器内有自己的端口号，和外界隔离，外界无法访问，只有守护进程能访问。大小Linux相互隔离，因此外界大Linux要访问小的Linux，需要一些技术将其连通。</li>
<li>Docker为啥比VM快？<ul>
<li>Docker有更少的抽象层</li>
<li>Docker利用的是宿主机的内核，vm需要的是Guest OS。</li>
<li>新建一个容器的时候，不需要加载虚拟机一样的操作系统内核，避免引导，因此很快。省略了复杂的引导过程。</li>
</ul>
</li>
<li>之后学命令就会很快乐，很清晰。</li>
</ul>
<h2 id="Docker常用命令："><a href="#Docker常用命令：" class="headerlink" title="Docker常用命令："></a>Docker常用命令：</h2><h4 id="docker-version-x2F-info-x2F-help："><a href="#docker-version-x2F-info-x2F-help：" class="headerlink" title="docker version &#x2F; info &#x2F; help："></a>docker version &#x2F; info &#x2F; help：</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker version		#显示版本信息</span><br><span class="line">docker info			#显示docker详细的系统信息</span><br><span class="line">docker 命令 --help   #docker的帮助文档</span><br></pre></td></tr></table></figure>

<ul>
<li>官网也可以在帮助文档中的reference找到所有的命令和列表。<a target="_blank" rel="noopener" href="https://docs.docker.com/reference/">Docker帮助文档</a></li>
<li>但是官网在国外会比较慢，所以我们这里直接使用命令进行查找用法即可。</li>
</ul>
<h3 id="常用镜像命令："><a href="#常用镜像命令：" class="headerlink" title="常用镜像命令："></a>常用镜像命令：</h3><h4 id="docker-images："><a href="#docker-images：" class="headerlink" title="docker images："></a>docker images：</h4><ul>
<li><pre><code class="shell">[root@VM-12-10-centos ~]# docker images
REPOSITORY    TAG       IMAGE ID       CREATED        SIZE
hello-world   latest    d1165f221234   2 months ago   13.3kB
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- Repository：镜像的仓库源</span><br><span class="line"></span><br><span class="line">- Tag：镜像的标签</span><br><span class="line"></span><br><span class="line">- Image ID：镜像的id</span><br><span class="line"></span><br><span class="line">- Created：镜像的创建时间</span><br><span class="line"></span><br><span class="line">- Size：镜像的大小</span><br><span class="line"></span><br><span class="line">- 可选项：</span><br><span class="line"></span><br><span class="line">  - -a , 列出所有镜像</span><br><span class="line">  - -q , 只显示id</span><br><span class="line"></span><br><span class="line">#### docker search:</span><br><span class="line"></span><br><span class="line">- shell中所搜镜像源头</span><br><span class="line"></span><br><span class="line">- ```shell</span><br><span class="line">  [root@VM-12-10-centos ~]# docker search mysql</span><br><span class="line">  NAME                              DESCRIPTION                                  STARS     OFFICIAL  AUTOMATED</span><br><span class="line">  mysql                             MySQL is a widely used, open-source relation…   10903     [OK]       </span><br><span class="line">  mariadb                           MariaDB Server is a high performing open sou…   4115      [OK]       </span><br><span class="line">  mysql/mysql-server                Optimized MySQL Server Docker images. Create…   809                  [OK]</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
<li><p>可选项：</p>
<ul>
<li><p>–filter , 过滤器，过滤出符合条件的内容。例如<code>--filter=STARS=3000</code>，就只会显示STARS中3000以上的内容。</p>
</li>
<li><p>&#96;&#96;&#96;shell<br>[root@VM-12-10-centos ~]# docker search mysql –filter&#x3D;STARS&#x3D;3000<br>NAME      DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED<br>mysql     MySQL is a widely used, open-source relation…   10903     [OK]<br>mariadb   MariaDB Server is a high performing open sou…   4115      [OK]  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#### docker pull：</span><br><span class="line"></span><br><span class="line">![image-20210522180106175](https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210522180106.png)</span><br><span class="line"></span><br><span class="line">- 下载镜像采用分层的方式</span><br><span class="line">- Digest是一个签名</span><br><span class="line">- 最后是一个下载的真实地址</span><br><span class="line"></span><br><span class="line">下面两条是等价的，你这里pull mysql实际上就是从下面这个地址去pull</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- 指定版本：</span><br><span class="line">  - 需要是系统支持的版本，在docker hub中可以看到有哪些版本的。</span><br><span class="line">  - `docker pull mysql:5.7`</span><br><span class="line">- 分层下载：</span><br><span class="line">  - 多个文件有共享的内容就不用分层进行下载了，直接可以共用哦。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#### docker rmi：</span><br><span class="line"></span><br><span class="line">- 可以通过id或者是name来删除。</span><br><span class="line">- 删除过程中也是按照层来删！！！</span><br><span class="line">- `docker rmi -f name/id`，删除指定容器</span><br><span class="line">- `docker rmi -f 容器id 容器id 容器id`，删除多个容器</span><br><span class="line">- 这里-f表示的是强制删除的参数嗷！！！</span><br><span class="line"></span><br><span class="line">```shell</span><br><span class="line">[root@VM-12-10-centos ~]# docker rmi -f d1165f221234</span><br><span class="line">Untagged: hello-world:latest</span><br><span class="line">Untagged: hello-world@sha256:5122f6204b6a3596e048758cabba3c46b1c937a46b5be6225b835d091b90e46c</span><br><span class="line">Deleted: sha256:d1165f2212346b2bab48cb01c1e39ee8ad1be46b87873d9ca7a4e434980a7726</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>批量删除（用到了linux中的技巧哦）：</p>
<ul>
<li><code>docker rmi -f $(docker images -aq)</code>，这样可以删除所有镜像。</li>
</ul>
</li>
</ul>
<h3 id="常用容器命令："><a href="#常用容器命令：" class="headerlink" title="常用容器命令："></a>常用容器命令：</h3><ul>
<li>有了镜像才可以创建容器，linux，下载一个centos镜像来测试学习:</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull centos</span><br></pre></td></tr></table></figure>



<h4 id="docker-run："><a href="#docker-run：" class="headerlink" title="docker run："></a>docker run：</h4><ul>
<li><p>docker run [可选参数] image</p>
</li>
<li><p>参数说明：</p>
<ul>
<li>–name&#x3D;”Name”   容器名字用来区分名字</li>
<li>-d   后台方式运行</li>
<li>-it   使用交互方式运行，进入容器查看内容</li>
<li>-p   指定容器端口：<ul>
<li>主机端口映射到容器端口（最常使用）</li>
<li>直接容器端口</li>
<li>ip：主机端口:容器端口</li>
</ul>
</li>
<li>-P   随机指定端口</li>
</ul>
</li>
<li><p>实际进入容器的例子：</p>
</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@VM-12-10-centos ~]# docker run -it centos /bin/bash</span><br><span class="line">[root@0c9bb9c70481 /]</span><br><span class="line"></span><br><span class="line">[root@0c9bb9c70481 /]# ls</span><br><span class="line">bin  etc   lib	  lost+found  mnt  proc  run   srv  tmp  var</span><br><span class="line">dev  home  lib64  media       opt  root  sbin  sys  usr</span><br></pre></td></tr></table></figure>

<ul>
<li>启动并进入容器，主机名称变了兄弟，现在进入到我们的容器里面去了，容器里面和外面是两个世界。里面是一个非常非常轻量的服务器，甚至指令都不完善的。</li>
<li>从容器中退回主机：exit可以退出进入的容器。</li>
</ul>
<h4 id="docker-ps："><a href="#docker-ps：" class="headerlink" title="docker  ps："></a>docker  ps：</h4><ul>
<li>显示正在运行的程序</li>
<li>参数大全： </li>
<li>-a , 显示历史运过的容器：</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@VM-12-10-centos ~]# docker ps -a</span><br><span class="line">CONTAINER ID   IMAGE          COMMAND       CREATED         STATUS                     PORTS     NAMES</span><br><span class="line">0c9bb9c70481   centos         &quot;/bin/bash&quot;   5 minutes ago   Exited (0) 2 minutes ago             laughing_shamir</span><br><span class="line">0e312a95099c   d1165f221234   &quot;/hello&quot;      3 hours ago     Exited (0) 3 hours ago               crazy_cray</span><br></pre></td></tr></table></figure>

<ul>
<li>-n&#x3D;？ 显示最近创建的容器，可以给个数。</li>
<li>-q  只显示容器的编号</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@VM-12-10-centos ~]# docker ps -aq</span><br><span class="line">2ab97137c167</span><br><span class="line">5650592ad646</span><br><span class="line">e6778cc94fee</span><br></pre></td></tr></table></figure>

<ul>
<li>上面这个例子可以显示全部容器的编号</li>
</ul>
<h4 id="退出容器："><a href="#退出容器：" class="headerlink" title="退出容器："></a>退出容器：</h4><ul>
<li>exit，停止并退出容器</li>
<li>Ctrl + P + Q ， 容器不停止同时退出容器</li>
</ul>
<h4 id="docker-rm："><a href="#docker-rm：" class="headerlink" title="docker rm："></a>docker rm：</h4><ul>
<li>删除容器</li>
<li><code>docker rm 容器id</code></li>
<li><code>docker rm -f $(docker ps -aq)</code>，删除所有的容器</li>
<li>运行中的容器不能够删除，如果要强制删除的话要<code>rm -f</code></li>
<li><code>docker ps -a -q|xargs docker rm</code>，这个也可以删除所有容器。</li>
</ul>
<h4 id="启动和停止容器的操作："><a href="#启动和停止容器的操作：" class="headerlink" title="启动和停止容器的操作："></a>启动和停止容器的操作：</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker start 容器id 	#启动</span><br><span class="line">docker restart 容器id #重启</span><br><span class="line">docker stop 容器id	#停止正在运行的容器</span><br><span class="line">docker kill 容器id	#强制停止当前容器</span><br></pre></td></tr></table></figure>



<h3 id="常用其他命令："><a href="#常用其他命令：" class="headerlink" title="常用其他命令："></a>常用其他命令：</h3><h4 id="docker-run-d-容器名"><a href="#docker-run-d-容器名" class="headerlink" title="docker run -d 容器名"></a>docker run -d 容器名</h4><ul>
<li>通过<code>docker run -d 镜像名</code>来后台跑起来一个容器</li>
<li>但是你发现启动完成之后，docker ps -a看不到？？？它自动停掉了。</li>
<li>reason：<ul>
<li>docker是容器使用后台运行，必须要有一个前台进程，docker发现没有前台提供服务的应用，就会自动停止。</li>
<li>容器启动后，发现自己没有提供服务，就会立即停止，没有程序了。</li>
</ul>
</li>
</ul>
<h4 id="docker-logs"><a href="#docker-logs" class="headerlink" title="docker logs"></a>docker logs</h4><ul>
<li>参数：<ul>
<li>-f：format，标准化输出。</li>
<li>-t：显示时间戳。</li>
<li>还有好多…</li>
</ul>
</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker logs -tf --tail 要显示的日志条数 容器id</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">-tf 显示日志</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">--<span class="built_in">tail</span> number 显示日志条数</span></span><br><span class="line">dockers logs -tf 容器id</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">上面这个就可以显示全部的日志</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">上面两个都可以不断更新最新的日志</span></span><br></pre></td></tr></table></figure>

<ul>
<li>上面这个可以显示容器内的日志，但有可能容器啥都没干，就无日志</li>
</ul>
<h4 id="查看进程信息"><a href="#查看进程信息" class="headerlink" title="查看进程信息"></a>查看进程信息</h4><ul>
<li>docker top 容器id</li>
<li>会显示出容器中所有进程的id</li>
</ul>
<h4 id="查看镜像元数据"><a href="#查看镜像元数据" class="headerlink" title="查看镜像元数据"></a>查看镜像元数据</h4><ul>
<li>docker inspect 容器id</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line">[root@VM-12-10-centos ~]# docker inspect hello-world</span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;Id&quot;: &quot;sha256:d1165f2212346b2bab48cb01c1e39ee8ad1be46b87873d9ca7a4e434980a7726&quot;,</span><br><span class="line">        &quot;RepoTags&quot;: [</span><br><span class="line">            &quot;hello-world:latest&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;RepoDigests&quot;: [</span><br><span class="line">            &quot;hello-world@sha256:5122f6204b6a3596e048758cabba3c46b1c937a46b5be6225b835d091b90e46c&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;Parent&quot;: &quot;&quot;,</span><br><span class="line">        &quot;Comment&quot;: &quot;&quot;,</span><br><span class="line">        &quot;Created&quot;: &quot;2021-03-05T23:25:25.230064203Z&quot;,</span><br><span class="line">        &quot;Container&quot;: &quot;f5a78ef54769bb8490754e9e063a89f90cc8eee6a6c5a0a72655826e99df116e&quot;,</span><br><span class="line">        &quot;ContainerConfig&quot;: &#123;</span><br><span class="line">            &quot;Hostname&quot;: &quot;f5a78ef54769&quot;,</span><br><span class="line">            &quot;Domainname&quot;: &quot;&quot;,</span><br><span class="line">            &quot;User&quot;: &quot;&quot;,</span><br><span class="line">            &quot;AttachStdin&quot;: false,</span><br><span class="line">            &quot;AttachStdout&quot;: false,</span><br><span class="line">            &quot;AttachStderr&quot;: false,</span><br><span class="line">            &quot;Tty&quot;: false,</span><br><span class="line">            &quot;OpenStdin&quot;: false,</span><br><span class="line">            &quot;StdinOnce&quot;: false,</span><br><span class="line">            &quot;Env&quot;: [</span><br><span class="line">                &quot;PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;</span><br><span class="line">            ],</span><br><span class="line">            &quot;Cmd&quot;: [</span><br><span class="line">                &quot;/bin/sh&quot;,</span><br><span class="line">                &quot;-c&quot;,</span><br><span class="line">                &quot;#(nop) &quot;,</span><br><span class="line">                &quot;CMD [\&quot;/hello\&quot;]&quot;</span><br><span class="line">            ],</span><br><span class="line">            &quot;Image&quot;: &quot;sha256:77fe0a37fa6ce641a004815f2761a9042618557d253f312cd3da61780e372c8f&quot;,</span><br><span class="line">            &quot;Volumes&quot;: null,</span><br><span class="line">            &quot;WorkingDir&quot;: &quot;&quot;,</span><br><span class="line">            &quot;Entrypoint&quot;: null,</span><br><span class="line">            &quot;OnBuild&quot;: null,</span><br><span class="line">            &quot;Labels&quot;: &#123;&#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;DockerVersion&quot;: &quot;19.03.12&quot;,</span><br><span class="line">        &quot;Author&quot;: &quot;&quot;,</span><br><span class="line">        &quot;Config&quot;: &#123;</span><br><span class="line">            &quot;Hostname&quot;: &quot;&quot;,</span><br><span class="line">            &quot;Domainname&quot;: &quot;&quot;,</span><br><span class="line">            &quot;User&quot;: &quot;&quot;,</span><br><span class="line">            &quot;AttachStdin&quot;: false,</span><br><span class="line">            &quot;AttachStdout&quot;: false,</span><br><span class="line">            &quot;AttachStderr&quot;: false,</span><br><span class="line">            &quot;Tty&quot;: false,</span><br><span class="line">            &quot;OpenStdin&quot;: false,</span><br><span class="line">            &quot;StdinOnce&quot;: false,</span><br><span class="line">            &quot;Env&quot;: [</span><br><span class="line">                &quot;PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;</span><br><span class="line">            ],</span><br><span class="line">            &quot;Cmd&quot;: [</span><br><span class="line">                &quot;/hello&quot;</span><br><span class="line">            ],</span><br><span class="line">            &quot;Image&quot;: &quot;sha256:77fe0a37fa6ce641a004815f2761a9042618557d253f312cd3da61780e372c8f&quot;,</span><br><span class="line">            &quot;Volumes&quot;: null,</span><br><span class="line">            &quot;WorkingDir&quot;: &quot;&quot;,</span><br><span class="line">            &quot;Entrypoint&quot;: null,</span><br><span class="line">            &quot;OnBuild&quot;: null,</span><br><span class="line">            &quot;Labels&quot;: null</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;Architecture&quot;: &quot;amd64&quot;,</span><br><span class="line">        &quot;Os&quot;: &quot;linux&quot;,</span><br><span class="line">        &quot;Size&quot;: 13336,</span><br><span class="line">        &quot;VirtualSize&quot;: 13336,</span><br><span class="line">        &quot;GraphDriver&quot;: &#123;</span><br><span class="line">            &quot;Data&quot;: &#123;</span><br><span class="line">                &quot;MergedDir&quot;: &quot;/var/lib/docker/overlay2/780de7dbba67a06f81bbd4e90bf01dbb79656623b604472bcf9d0edaba8687cd/merged&quot;,</span><br><span class="line">                &quot;UpperDir&quot;: &quot;/var/lib/docker/overlay2/780de7dbba67a06f81bbd4e90bf01dbb79656623b604472bcf9d0edaba8687cd/diff&quot;,</span><br><span class="line">                &quot;WorkDir&quot;: &quot;/var/lib/docker/overlay2/780de7dbba67a06f81bbd4e90bf01dbb79656623b604472bcf9d0edaba8687cd/work&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;Name&quot;: &quot;overlay2&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;RootFS&quot;: &#123;</span><br><span class="line">            &quot;Type&quot;: &quot;layers&quot;,</span><br><span class="line">            &quot;Layers&quot;: [</span><br><span class="line">                &quot;sha256:f22b99068db93900abe17f7f5e09ec775c2826ecfe9db961fea68293744144bd&quot;</span><br><span class="line">            ]</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;Metadata&quot;: &#123;</span><br><span class="line">            &quot;LastTagTime&quot;: &quot;0001-01-01T00:00:00Z&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>docker inspect 容器id&#x2F;镜像id都可以看嗷！！！</li>
</ul>
<h4 id="进入正在运行的容器"><a href="#进入正在运行的容器" class="headerlink" title="进入正在运行的容器"></a>进入正在运行的容器</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it 容器id /bin/bash</span><br><span class="line">docker attach 容器id</span><br></pre></td></tr></table></figure>

<ul>
<li>区别：<ul>
<li>exec，进入容器后开启一个新的终端。</li>
<li>attach，不会启动新的进程，直接进入正在执行的终端。</li>
</ul>
</li>
</ul>
<h4 id="从容器内拷贝文件到主机"><a href="#从容器内拷贝文件到主机" class="headerlink" title="从容器内拷贝文件到主机"></a>从容器内拷贝文件到主机</h4><ul>
<li>要进入容器内再拷贝出来</li>
<li><code>docker cp 容器id:/文件夹/文件 /宿主机内文件夹/文件</code></li>
<li>拷贝是一个手动过程，未来使用 -v 卷的技术，可以实现自动拷贝。</li>
</ul>
<h2 id="小结："><a href="#小结：" class="headerlink" title="小结："></a>小结：</h2><p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210523094907.png" alt="image-20210523094900703"></p>
<h2 id="小作业1（部署Nginx）"><a href="#小作业1（部署Nginx）" class="headerlink" title="小作业1（部署Nginx）:"></a>小作业1（部署Nginx）:</h2><blockquote>
<p>Docker安装nginx</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">1. docker search 搜索镜像，去dockerhub官网搜索可以看到详细的帮助文档</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">2. docker pull 下载镜像</span></span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[root@VM-12-10-centos ~]# docker pull nginx</span><br><span class="line">Using default tag: latest</span><br><span class="line">latest: Pulling from library/nginx</span><br><span class="line">69692152171a: Pull complete </span><br><span class="line">49f7d34d62c1: Pull complete </span><br><span class="line">5f97dc5d71ab: Pull complete </span><br><span class="line">cfcd0711b93a: Pull complete </span><br><span class="line">be6172d7651b: Pull complete </span><br><span class="line">de9813870342: Pull complete </span><br><span class="line">Digest: sha256:df13abe416e37eb3db4722840dd479b00ba193ac6606e7902331dcea50f4f1f2</span><br><span class="line">Status: Downloaded newer image for nginx:latest</span><br><span class="line">docker.io/library/nginx:latest</span><br><span class="line">[root@VM-12-10-centos ~]# docker images</span><br><span class="line">REPOSITORY    TAG       IMAGE ID       CREATED        SIZE</span><br><span class="line">nginx         latest    f0b8a9a54136   10 days ago    133MB</span><br><span class="line">hello-world   latest    d1165f221234   2 months ago   13.3kB</span><br><span class="line">centos        latest    300e315adb2f   5 months ago   209MB</span><br><span class="line">[root@VM-12-10-centos ~]# docker run -d --name nginx01 -p 3344:80 nginx</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">这里的话对于设置nginx后台运行，宿主机的3344对应容器内的80端口，同时给这个容器命名为nginx01</span></span><br><span class="line">68b3ef85158ed8d58fd92a6af097fb03c2cbed3a1b4118c27918444639b9de95</span><br></pre></td></tr></table></figure>

<ul>
<li>上面完成了nginx的下载与部署，下面进行访问测试：</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">[root@VM-12-10-centos ~]# docker ps</span><br><span class="line">CONTAINER ID   IMAGE     COMMAND                  CREATED          STATUS          PORTS                                   NAMES</span><br><span class="line">68b3ef85158e   nginx     &quot;/docker-entrypoint.…&quot;   22 minutes ago   Up 22 minutes   0.0.0.0:3344-&gt;80/tcp, :::3344-&gt;80/tcp   nginx01</span><br><span class="line">[root@VM-12-10-centos ~]# curl localhost:3344</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;title&gt;Welcome to nginx!&lt;/title&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">    body &#123;</span><br><span class="line">        width: 35em;</span><br><span class="line">        margin: 0 auto;</span><br><span class="line">        font-family: Tahoma, Verdana, Arial, sans-serif;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1&gt;Welcome to nginx!&lt;/h1&gt;</span><br><span class="line">&lt;p&gt;If you see this page, the nginx web server is successfully installed and</span><br><span class="line">working. Further configuration is required.&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">&lt;p&gt;For online documentation and support please refer to</span><br><span class="line">&lt;a href=&quot;http://nginx.org/&quot;&gt;nginx.org&lt;/a&gt;.&lt;br/&gt;</span><br><span class="line">Commercial support is available at</span><br><span class="line">&lt;a href=&quot;http://nginx.com/&quot;&gt;nginx.com&lt;/a&gt;.&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">&lt;p&gt;&lt;em&gt;Thank you for using nginx.&lt;/em&gt;&lt;/p&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>端口暴露的概念图：</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210523110242.png" alt="image-20210523110242571"></p>
<ul>
<li>可以进入nginx容器中查看nginx相关的信息：</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@VM-12-10-centos ~]# docker exec -it nginx01 /bin/bash</span><br><span class="line">root@68b3ef85158e:/# whereis nginx</span><br><span class="line">nginx: /usr/sbin/nginx /usr/lib/nginx /etc/nginx /usr/share/nginx</span><br><span class="line">root@68b3ef85158e:/# cd /etc/nginx</span><br><span class="line">root@68b3ef85158e:/etc/nginx# ls</span><br><span class="line">conf.d		koi-utf  mime.types  nginx.conf   uwsgi_params</span><br><span class="line">fastcgi_params	koi-win  modules     scgi_params  win-utf</span><br></pre></td></tr></table></figure>

<ul>
<li>由于你将本机端口和容器内部端口进行了映射，访问本机端口就可以获得服务，这个时候在服务器配置中开放端口就可以访问到你在对应端口开放的服务。</li>
<li>思考问题：每次改动配置文件都需要进入容器内部十分麻烦。我们要是可以在容器外部提供映射路径，达到在容器外的修改可以同步到容器内，就十分的方便嗷！！！-v 数据卷的技术。</li>
</ul>
<h2 id="小作业2（部署Tomcat）"><a href="#小作业2（部署Tomcat）" class="headerlink" title="小作业2（部署Tomcat）:"></a>小作业2（部署Tomcat）:</h2><ul>
<li>官方文档中提供的安装Tomcat的命令</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210523114616.png" alt="image-20210523114616832"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">[root@VM-12-10-centos ~]# docker run -it --rm tomcat:9.0</span><br><span class="line">Unable to find image &#x27;tomcat:9.0&#x27; locally</span><br><span class="line">9.0: Pulling from library/tomcat</span><br><span class="line">d960726af2be: Pull complete </span><br><span class="line">e8d62473a22d: Pull complete </span><br><span class="line">8962bc0fad55: Pull complete </span><br><span class="line">65d943ee54c1: Pull complete </span><br><span class="line">da20b77f10ac: Pull complete </span><br><span class="line">8669a096f083: Pull complete </span><br><span class="line">e0c0a5e9ce88: Pull complete </span><br><span class="line">f7f46169d747: Pull complete </span><br><span class="line">42d8171e56e6: Pull complete </span><br><span class="line">774078a3f8bb: Pull complete </span><br><span class="line">Digest: sha256:10842dab06b5e52233ad977d4689522d4fbaa9c21e6df387d7a530e02316fb45</span><br><span class="line">Status: Downloaded newer image for tomcat:9.0</span><br><span class="line">Using CATALINA_BASE:   /usr/local/tomcat</span><br><span class="line">Using CATALINA_HOME:   /usr/local/tomcat</span><br><span class="line">Using CATALINA_TMPDIR: /usr/local/tomcat/temp</span><br><span class="line">Using JRE_HOME:        /usr/local/openjdk-11</span><br><span class="line">Using CLASSPATH:       /usr/local/tomcat/bin/bootstrap.jar:/usr/local/tomcat/bin/tomcat-juli.jar</span><br><span class="line">Using CATALINA_OPTS:   </span><br><span class="line">NOTE: Picked up JDK_JAVA_OPTIONS:  --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.rmi/sun.rmi.transport=ALL-UNNAMED</span><br><span class="line">23-May-2021 03:47:09.425 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Server version name:   Apache Tomcat/9.0.46</span><br><span class="line">23-May-2021 03:47:09.427 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Server built:          May 8 2021 17:35:52 UTC</span><br><span class="line">23-May-2021 03:47:09.427 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Server version number: 9.0.46.0</span><br><span class="line">23-May-2021 03:47:09.427 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log OS Name:               Linux</span><br><span class="line">23-May-2021 03:47:09.427 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log OS Version:            3.10.0-1127.19.1.el7.x86_64</span><br><span class="line">23-May-2021 03:47:09.427 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Architecture:          amd64</span><br><span class="line">23-May-2021 03:47:09.428 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Java Home:             /usr/local/openjdk-11</span><br><span class="line">23-May-2021 03:47:09.428 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log JVM Version:           11.0.11+9</span><br><span class="line">23-May-2021 03:47:09.428 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log JVM Vendor:            Oracle Corporation</span><br><span class="line">23-May-2021 03:47:09.430 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log CATALINA_BASE:         /usr/local/tomcat</span><br><span class="line">23-May-2021 03:47:09.430 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log CATALINA_HOME:         /usr/local/tomcat</span><br><span class="line">23-May-2021 03:47:09.457 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: --add-opens=java.base/java.lang=ALL-UNNAMED</span><br><span class="line">23-May-2021 03:47:09.457 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: --add-opens=java.base/java.io=ALL-UNNAMED</span><br><span class="line">23-May-2021 03:47:09.457 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: --add-opens=java.base/java.util=ALL-UNNAMED</span><br><span class="line">23-May-2021 03:47:09.457 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: --add-opens=java.base/java.util.concurrent=ALL-UNNAMED</span><br><span class="line">23-May-2021 03:47:09.457 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: --add-opens=java.rmi/sun.rmi.transport=ALL-UNNAMED</span><br><span class="line">23-May-2021 03:47:09.457 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Djava.util.logging.config.file=/usr/local/tomcat/conf/logging.properties</span><br><span class="line">23-May-2021 03:47:09.457 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager</span><br><span class="line">23-May-2021 03:47:09.457 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Djdk.tls.ephemeralDHKeySize=2048</span><br><span class="line">23-May-2021 03:47:09.458 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Djava.protocol.handler.pkgs=org.apache.catalina.webresources</span><br><span class="line">23-May-2021 03:47:09.458 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dorg.apache.catalina.security.SecurityListener.UMASK=0027</span><br><span class="line">23-May-2021 03:47:09.458 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dignore.endorsed.dirs=</span><br><span class="line">23-May-2021 03:47:09.458 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dcatalina.base=/usr/local/tomcat</span><br><span class="line">23-May-2021 03:47:09.458 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dcatalina.home=/usr/local/tomcat</span><br><span class="line">23-May-2021 03:47:09.458 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Djava.io.tmpdir=/usr/local/tomcat/temp</span><br><span class="line">23-May-2021 03:47:09.468 INFO [main] org.apache.catalina.core.AprLifecycleListener.lifecycleEvent Loaded Apache Tomcat Native library [1.2.28] using APR version [1.6.5].</span><br><span class="line">23-May-2021 03:47:09.468 INFO [main] org.apache.catalina.core.AprLifecycleListener.lifecycleEvent APR capabilities: IPv6 [true], sendfile [true], accept filters [false], random [true].</span><br><span class="line">23-May-2021 03:47:09.468 INFO [main] org.apache.catalina.core.AprLifecycleListener.lifecycleEvent APR/OpenSSL configuration: useAprConnector [false], useOpenSSL [true]</span><br><span class="line">23-May-2021 03:47:09.478 INFO [main] org.apache.catalina.core.AprLifecycleListener.initializeSSL OpenSSL successfully initialized [OpenSSL 1.1.1d  10 Sep 2019]</span><br><span class="line">23-May-2021 03:47:10.220 INFO [main] org.apache.coyote.AbstractProtocol.init Initializing ProtocolHandler [&quot;http-nio-8080&quot;]</span><br><span class="line">23-May-2021 03:47:10.283 INFO [main] org.apache.catalina.startup.Catalina.load Server initialization in [1275] milliseconds</span><br><span class="line">23-May-2021 03:47:10.390 INFO [main] org.apache.catalina.core.StandardService.startInternal Starting service [Catalina]</span><br><span class="line">23-May-2021 03:47:10.390 INFO [main] org.apache.catalina.core.StandardEngine.startInternal Starting Servlet engine: [Apache Tomcat/9.0.46]</span><br><span class="line">23-May-2021 03:47:10.420 INFO [main] org.apache.coyote.AbstractProtocol.start Starting ProtocolHandler [&quot;http-nio-8080&quot;]</span><br><span class="line">23-May-2021 03:47:10.511 INFO [main] org.apache.catalina.startup.Catalina.start Server startup in [228] milliseconds</span><br><span class="line">^C23-May-2021 03:47:26.727 INFO [Thread-3] org.apache.coyote.AbstractProtocol.pause Pausing ProtocolHandler [&quot;http-nio-8080&quot;]</span><br><span class="line">23-May-2021 03:47:26.734 INFO [Thread-3] org.apache.catalina.core.StandardService.stopInternal Stopping service [Catalina]</span><br><span class="line">23-May-2021 03:47:26.737 INFO [Thread-3] org.apache.coyote.AbstractProtocol.stop Stopping ProtocolHandler [&quot;http-nio-8080&quot;]</span><br><span class="line">23-May-2021 03:47:26.783 INFO [Thread-3] org.apache.coyote.AbstractProtocol.destroy Destroying ProtocolHandler [&quot;http-nio-8080&quot;]</span><br><span class="line">[root@VM-12-10-centos ~]# docker ps -a</span><br><span class="line">CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES</span><br></pre></td></tr></table></figure>

<ul>
<li><p>我们发现容器跑起来和在Tomcat部署上的一摸一样，这个时候<code>ctrl+c</code>停掉Tomcat服务，<code>docker ps -a</code>显示一下容器我们发现它就没有了！！！</p>
</li>
<li><p>我们这儿不这么跑哈，不太好嗷！！！直接pull , run 起来好一点嗷！！！</p>
</li>
<li><p><code>docker pull tomcat</code></p>
</li>
<li><p><code>docker run -d -p 3344:8080 --name tomcat01 tomcat</code></p>
</li>
<li><p>本地的curl命令和远程访问3344端口都没问题：</p>
</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210523122418.png" alt="image-20210523122418187"></p>
<p>可以看到Apache服务器已经部署成功了！！！</p>
<ul>
<li>进入容器进行查看：</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@VM-12-10-centos ~]# docker exec -it tomcat01 /bin/bash</span><br><span class="line">root@57104ebe62bb:/usr/local/tomcat# ls</span><br><span class="line">BUILDING.txt	 NOTICE		RUNNING.txt  lib	     temp	   work</span><br><span class="line">CONTRIBUTING.md  README.md	bin	     logs	     webapps</span><br><span class="line">LICENSE		 RELEASE-NOTES	conf	     native-jni-lib  webapps.dist</span><br><span class="line">root@57104ebe62bb:/usr/local/tomcat# cd webapps</span><br><span class="line">root@57104ebe62bb:/usr/local/tomcat/webapps# ls</span><br><span class="line">root@57104ebe62bb:/usr/local/tomcat/webapps# </span><br></pre></td></tr></table></figure>

<ul>
<li>发现问题：<ul>
<li>命令被阉割了，类似于ll这样的命令都没有了</li>
<li>webapps底下啥都没有，原因是默认是最小的镜像，所有不必要的就都剔除掉，保证最小可运行的环境。</li>
</ul>
</li>
<li>实际文件藏在webapps.dist文件里面，就是基本的页面，把其复制到webapps中就可以正常跑起来啦！！！</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">root@57104ebe62bb:/usr/local/tomcat# ls webapps</span><br><span class="line">root@57104ebe62bb:/usr/local/tomcat# ls webapps.dist/</span><br><span class="line">ROOT  docs  examples  host-manager  manager</span><br><span class="line">root@57104ebe62bb:/usr/local/tomcat# cp -r webapps.dist/* webapps</span><br><span class="line">root@57104ebe62bb:/usr/local/tomcat# cd webapps</span><br><span class="line">root@57104ebe62bb:/usr/local/tomcat/webapps# ls</span><br><span class="line">ROOT  docs  examples  host-manager  manager</span><br></pre></td></tr></table></figure>

<ul>
<li><p>这个时候无论是本地curl还是远程:3344，都能够访问到apache的初始页面了嗷！！！</p>
</li>
<li><p>思考问题：我们以后部署项目，每次进入容器是不是很麻烦？我要是可以提供一个映射路径：webapps，我们在外部放置项目，就自动同步到内部就好了。</p>
</li>
</ul>
<h2 id="小作业3（部署ES-Kibana）："><a href="#小作业3（部署ES-Kibana）：" class="headerlink" title="小作业3（部署ES+Kibana）："></a>小作业3（部署ES+Kibana）：</h2><p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1og4y1q7M4?p=16&spm_id_from=pageDriverhttps://www.bilibili.com/video/BV1og4y1q7M4?p=16&spm_id_from=pageDriver">ES+Kibana平台</a></p>
<ul>
<li>比较耗费资源和内存，我这儿不用自己的虚拟机做演示了嗷！！！老师部署的都裂开来！！！</li>
<li>elasticsearch就是我们要下载部署的东西嗷！！！</li>
<li>部署了服务器都顶不住，直接卡住了，一核2G根本顶不住。解决方法：<ul>
<li>停整个docker</li>
<li>服务器直接重启orz</li>
<li>等服务器缓过来</li>
</ul>
</li>
<li>查看状态：<code>docker stats</code>,这是一个比较耗资源的操作嗷：</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210523165526.png" alt="image-20210523165518965"></p>
<ul>
<li>增加内存的限制才可以嗷！！！<ul>
<li><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210523165857.png" alt="image-20210523165856964"></li>
<li>这里的是-Xms , -Xmx限制的是最大和最小内存。</li>
<li>它的前面的这部分代码上dockerhub去看官网文档的用法嗷！！！</li>
</ul>
</li>
<li>作业：如何使用Kibana去连接ES呢？两者是相互隔离的，就非常顶？？？解决：通过Linux的内网地址，以Linux为中介，去连接ES。</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210523170235.png" alt="image-20210523170234877"></p>
<h1 id="可视化工具："><a href="#可视化工具：" class="headerlink" title="可视化工具："></a>可视化工具：</h1><h2 id="portainer-先用这个-："><a href="#portainer-先用这个-：" class="headerlink" title="portainer(先用这个)："></a>portainer(先用这个)：</h2><ul>
<li>docker的图形化管理工具，提供一个后台面板供我们操作</li>
<li>操作指令：</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 3344:9000 \</span><br><span class="line">--restart=always -v /var/run/docker.sock:/var/run/docker.sock --privileged=true portainer/portainer</span><br></pre></td></tr></table></figure>

<ul>
<li>然后访问3344端口就能够访问到：</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210523171253.png" alt="image-20210523171252987"></p>
<ul>
<li>创建用户之后使用本地的就好啦，很方便嗷！</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210523171425.png" alt="image-20210523171425800"></p>
<p>进入后，可以看到我们的主面板：</p>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210523171614.png" alt="image-20210523171614813"></p>
<ul>
<li>可视化面板，挺好用的，就是一般不会用orz。</li>
</ul>
<h2 id="Rancher-CI-x2F-CD再用"><a href="#Rancher-CI-x2F-CD再用" class="headerlink" title="Rancher(CI&#x2F;CD再用)"></a>Rancher(CI&#x2F;CD再用)</h2><h1 id="Docker镜像"><a href="#Docker镜像" class="headerlink" title="Docker镜像"></a>Docker镜像</h1><h2 id="镜像是什么"><a href="#镜像是什么" class="headerlink" title="镜像是什么"></a>镜像是什么</h2><ul>
<li>所有的引用直接打包为docker镜像，就可以直接跑起来</li>
<li>得到镜像：<ul>
<li>远程仓库下载</li>
<li>朋友拷贝给你</li>
<li>自己制作一个镜像dockerfile</li>
</ul>
</li>
</ul>
<h2 id="镜像加载原理（层级的概念）"><a href="#镜像加载原理（层级的概念）" class="headerlink" title="镜像加载原理（层级的概念）"></a>镜像加载原理（层级的概念）</h2><ul>
<li><code>Union File System</code>，联合文件系统，是一种分层，轻量级并且高性能的文件系统，它支持对于文件系统的修改作为一次提交来一层层叠加。同时可以把不同目录挂载到同一个虚拟文件系统下。镜像可以通过分层来进行集成，基于基础镜像，可以制作各种具体的应用镜像。</li>
<li>精简的OS，所以可以很小，底层使用的是Host的kernel，因此为秒级启动。</li>
<li>有点像windows里面的更新补丁，盖中盖。</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210523190339.png" alt="image-20210523190339127"></p>
<ul>
<li>分层下载可以复用相同的层。这里注意一下，下面这个很重要，我们不可以写只读的镜像，我们只可以操作启动的容器，相当于在镜像上面多加了一层容器层进行操作，新的这一整个整体可以被打包为一个全新的镜像嗷！！！</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210523190514.png" alt="image-20210523190514390"></p>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210523190752.png" alt="image-20210523190752317"></p>
<h2 id="commit镜像"><a href="#commit镜像" class="headerlink" title="commit镜像"></a>commit镜像</h2><ul>
<li><p><code>docker commit -m=&quot;提交的信息&quot; -a=&quot;作者&quot; 容器id 目标镜像名: [TAG]</code></p>
</li>
<li><p>命令和git类似</p>
</li>
<li><p>实战测试：</p>
<ul>
<li><ol>
<li>启动一个默认的Tomcat</li>
</ol>
</li>
<li><ol start="2">
<li>没有webapps应用，官方默认webapps里面是没有东西的</li>
</ol>
</li>
<li><ol start="3">
<li>我自己向webapps里面拷贝了webapps.disk里面的全部文件。</li>
</ol>
</li>
<li><ol start="4">
<li>这个时候提交一下我们修改的内容打包成一个镜像嗷！！！</li>
</ol>
</li>
<li><p>&#96;&#96;&#96;shell<br>docker commit -a&#x3D;”tuzi”  -m&#x3D;”add webapps app” 7e119b82cff6 tomcat02:1.0</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- 这个时候就从容器创建了一个镜像，docker images是可以看到你这里生成的镜像的嗷！！！我们以后就可以使用我们自己修改过的镜像。这个就相当于我们学习过的概念snapshot。</span><br><span class="line"></span><br><span class="line">- 先理解概念，然后概念和实践相互集合一把拿下。以后项目开发就可以通过commit不断向已有的镜像中添加新的容器层再打包为新的镜像。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># Docker精通</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## Docker数据卷</span><br><span class="line"></span><br><span class="line">### 什么是容器数据卷</span><br><span class="line"></span><br><span class="line">- 将应用和环境打包为一个镜像。</span><br><span class="line">- 数据？如果数据都在容器中，我们删除容器数据就会丢失。**需求：数据持久化**。</span><br><span class="line">- MySQL之类的数据在容器中是不安全的，需要数据共享，将容器中的数据可以导出来保存嗷！！！</span><br><span class="line">- 容器之间可以有一个数据共享的技术！Docker容器中产生的数据同步到本地！！！</span><br><span class="line">- 卷技术，本质上是目录的挂载，将容器内的目录挂载在Linux上。</span><br><span class="line"></span><br><span class="line">![image-20210524095038844](https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210524095046.png)</span><br><span class="line"></span><br><span class="line">容器中的数据自动同步到Linux文件夹上。</span><br><span class="line"></span><br><span class="line">- 总结一句话：</span><br><span class="line">  - 容器的持久化和同步操作</span><br><span class="line">  - 容器间也是可以数据共享的</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### 使用数据卷</span><br><span class="line"></span><br><span class="line">&gt; 方式一：使用命令来挂载</span><br><span class="line"></span><br><span class="line">- 命令格式：</span><br><span class="line"></span><br><span class="line">`docker run -it -v 主机目录:容器内目录`</span><br><span class="line"></span><br><span class="line">这个和上面学的-p也很类似哦，-p是端口映射，-v是目录映射。挂在完成之后，以后容器内目录中的内容都会自动和主机目录的内容同步嗷！！！</span><br><span class="line"></span><br><span class="line">- 为了查看挂载是否成功，可以使用docker inspect 容器id来查看容器状态，里面有个属性说明了挂载的内容的状态：</span><br><span class="line"></span><br><span class="line">![image-20210524095842507](https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210524095842.png)</span><br><span class="line"></span><br><span class="line">- 可以理解为双向绑定？？？？ ---&gt;   对，就是这么理解的</span><br><span class="line">- 好处：</span><br><span class="line">  - 修改只需要在本地修改即可，不需要进入容器中修改</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### 实战：安装MySQL</span><br><span class="line"></span><br><span class="line">- MySQL数据持久化的问题</span><br><span class="line">- 注意：MySQL配置的时候需要账号和密码嗷！！！具体怎么设置的话，可以上官网去康康嗷！！！</span><br><span class="line"></span><br><span class="line">![image-20210524102556491](https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210524102603.png)</span><br><span class="line"></span><br><span class="line">- 启动成功之后，可以通过你云服务器主机的ip和密码访问到远程的mysql，就和你本地的Database建立连接没啥区别。IDEA里面的Database就提供了这样的连接功能，VSCode也有嗷！！！</span><br><span class="line">- 本地测试一个新的数据库，映射路径都是ok的嗷！！！</span><br><span class="line">- 就算删掉MySQL容器的话，挂载到本地的数据卷中的数据还在哈！！！</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### 具名挂载和匿名挂载</span><br><span class="line"></span><br><span class="line">- docker volume:</span><br><span class="line"></span><br><span class="line">```shell</span><br><span class="line">[root@VM-12-10-centos ~]# docker volume --help</span><br><span class="line"></span><br><span class="line">Usage:  docker volume COMMAND</span><br><span class="line"></span><br><span class="line">Manage volumes</span><br><span class="line"></span><br><span class="line">Commands:</span><br><span class="line">  create      Create a volume</span><br><span class="line">  inspect     Display detailed information on one or more volumes</span><br><span class="line">  ls          List volumes</span><br><span class="line">  prune       Remove all unused local volumes</span><br><span class="line">  rm          Remove one or more volumes</span><br><span class="line"></span><br><span class="line">Run &#x27;docker volume COMMAND --help&#x27; for more information on a command.</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>这个volume就是我们所说的卷 -v 的来源</p>
</li>
<li><p>查看所有卷的情况：</p>
<ul>
<li>docker volume ls</li>
</ul>
</li>
</ul>
<h4 id="匿名挂载："><a href="#匿名挂载：" class="headerlink" title="匿名挂载："></a>匿名挂载：</h4><ul>
<li>-v的时候，只指定了指定容器里内目录，不指定容器外目录。</li>
<li><code>docker run -d -P --name nginx02 -v /etc/nginx nginx</code></li>
</ul>
<h4 id="具名挂载："><a href="#具名挂载：" class="headerlink" title="具名挂载："></a>具名挂载：</h4><ul>
<li><p>-v的时候，没有给路径，只给了个名字</p>
</li>
<li><p><code>docker run -d -P --name nginx02 -v juming-nginx:/etc/nginx nginx</code></p>
</li>
<li><p>卷名:容器内路径</p>
</li>
<li><p>docker volume ls，是可以看到这个名字的相关信息的嗷！！！</p>
</li>
<li><p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210524104347.png" alt="image-20210524104347307"></p>
</li>
</ul>
<h4 id="Summary："><a href="#Summary：" class="headerlink" title="Summary："></a>Summary：</h4><ul>
<li>所有docker内的卷，没有指定目录的情况下，都是在<code>/var/lib/docker/volumes/xxxx/_data</code>下的。</li>
<li>这个xxxx如果是匿名挂载就是一个id，如果是具名挂载就是你的命名。</li>
<li>具名挂载是最常用的，可以方便找到我们的一个卷，大多情况在使用具名挂载。</li>
<li>如何确定是具名挂载还是匿名挂载，还是指定路径挂载？<ul>
<li>-v   容器内路径</li>
<li>-v   卷名:容器内路径</li>
<li>-v   宿主机路径:容器内路径</li>
</ul>
</li>
<li>同时甚至可以设置权限：<ul>
<li><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210524104914.png" alt="image-20210524104914282"></li>
<li>注意哈，权限是对于容器中的内容来说的，例如ro说明这个路径只能通过宿主机来操作，容器内是无法操作的嗷！！！</li>
</ul>
</li>
</ul>
<h2 id="初识DockerFile"><a href="#初识DockerFile" class="headerlink" title="初识DockerFile"></a>初识DockerFile</h2><h3 id="采用Dockerfile进行挂载："><a href="#采用Dockerfile进行挂载：" class="headerlink" title="采用Dockerfile进行挂载："></a>采用Dockerfile进行挂载：</h3><ul>
<li>commit是通过容器生成镜像，如果我想自己从头生成一个镜像呢？？？</li>
<li>DockerFile就是用来构造docker镜像的构建文件，命令脚本。镜像是一层一层的，脚本就是一个一个的命令。</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">FROM centos</span><br><span class="line"></span><br><span class="line">VOLUMN [&quot;volume01&quot;,&quot;volume02&quot;]</span><br><span class="line"></span><br><span class="line">CMD echo &quot;......end......&quot;</span><br><span class="line">CMD /bin/bash</span><br></pre></td></tr></table></figure>

<ul>
<li>上面这里是个例子，第一行指定环境，第二行指定挂载的卷，就是其实就是匿名指定嗷！！！这里只说明了容器内的名字嘛！！！</li>
<li><code>docker build -f /home/tuzi/dockerfile1 -t tuzi/centos:1.0 .</code></li>
<li>上面这里-f是指文件的位置，-t指的是target，也就是生成的目标位置，最后的.表示当前目录下。</li>
<li>注意这里的名字前面不能有&#x2F;哈，dockerfile文件名字最好为Dockerfile。文件中的内容，指令大写嗷。</li>
<li>这里的每个命令是镜像的一层！！！</li>
<li>这种方式使用的非常多！！！一般都构建自己的镜像，如果没有的话就需要我们手动镜像挂载！！！</li>
</ul>
<h3 id="数据卷容器："><a href="#数据卷容器：" class="headerlink" title="数据卷容器："></a>数据卷容器：</h3><h4 id="多个MySQL数据同步："><a href="#多个MySQL数据同步：" class="headerlink" title="多个MySQL数据同步："></a>多个MySQL数据同步：</h4><p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210524150702.png" alt="image-20210524150655723"></p>
<ul>
<li>下面这个就是一个例子：</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210524150900.png" alt="image-20210524150900230"></p>
<ul>
<li>甚至可以多个容器之间采用同样的方式进行挂载。只要通过这种方式就能够实现容器之间的数据共享。</li>
<li>删除了其中一个容器，其他的容器还使用着卷，这其他卷中的数据是不会丢失的嗷！！！</li>
<li>结论：容器之间，可以配置信息的传递。容器卷的生命周期一致持续到没有容器使用为止。一旦持久化到了本地，本地的数据就是持久化的，不会随着容器被删除完而消失嗷！！！</li>
</ul>
<h3 id="Dockerfile介绍："><a href="#Dockerfile介绍：" class="headerlink" title="Dockerfile介绍："></a>Dockerfile介绍：</h3><ul>
<li><p>构建步骤：</p>
<ul>
<li>构建dockerfile 文件</li>
<li>docker build 构建一个镜像</li>
<li>docker run 运行镜像</li>
<li>docker push 发布镜像(DockerHub , 阿里云镜像仓库)</li>
</ul>
</li>
<li><p>很多官方镜像都是基础包，很多功能没有，我们通常需要自己来配置我们的环境！！！</p>
</li>
<li><p>基础知识：</p>
<ul>
<li>每个保留关键字必须是大写字母</li>
<li>执行从上往下执行</li>
<li># 表示注释</li>
<li>每一个指令都会提交一个新的镜像层，并且提交。</li>
</ul>
</li>
<li><p>整体结构：</p>
</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210524152140.png" alt="image-20210524152140558"></p>
<ul>
<li>面向开发的，我们以后要发布项目，做镜像，就需要编写dockerfile文件，这个文件十分简单。镜像就是我们要最终发布和运行的产品。</li>
<li>Docker容器就是镜像运行起来提供服务的嗷！！！</li>
</ul>
<h3 id="Dockerfile指令说明："><a href="#Dockerfile指令说明：" class="headerlink" title="Dockerfile指令说明："></a>Dockerfile指令说明：</h3><p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210524152518.png" alt="image-20210524152518215"></p>
<h4 id="FROM"><a href="#FROM" class="headerlink" title="FROM"></a>FROM</h4><ul>
<li>基础镜像，一切从这里开始</li>
</ul>
<h4 id="MAINTAINER"><a href="#MAINTAINER" class="headerlink" title="MAINTAINER"></a>MAINTAINER</h4><ul>
<li>镜像是谁写的，姓名+邮箱</li>
</ul>
<h4 id="RUN"><a href="#RUN" class="headerlink" title="RUN"></a>RUN</h4><ul>
<li>镜像构建的时候运行的命令</li>
</ul>
<h4 id="ADD"><a href="#ADD" class="headerlink" title="ADD"></a>ADD</h4><ul>
<li>步骤：添加Tomcat镜像：<ul>
<li>Centos有了,Tomcat呢？</li>
<li>加入Tomcat包才能用哇！！！</li>
</ul>
</li>
</ul>
<h4 id="WORKDIR"><a href="#WORKDIR" class="headerlink" title="WORKDIR"></a>WORKDIR</h4><ul>
<li>镜像的工作目录，指定工作的目录</li>
</ul>
<h4 id="VOLUME"><a href="#VOLUME" class="headerlink" title="VOLUME"></a>VOLUME</h4><ul>
<li>挂载的目录</li>
</ul>
<h4 id="EXPOSE"><a href="#EXPOSE" class="headerlink" title="EXPOSE"></a>EXPOSE</h4><ul>
<li>暴露端口，端口配置</li>
</ul>
<h4 id="CMD"><a href="#CMD" class="headerlink" title="CMD"></a>CMD</h4><ul>
<li><p>指定容器启动的时候要运行的命令</p>
</li>
<li><p>只有最后一个会生效，可被替代</p>
</li>
</ul>
<h4 id="ENTRYPOINT"><a href="#ENTRYPOINT" class="headerlink" title="ENTRYPOINT"></a>ENTRYPOINT</h4><ul>
<li>指定容器启动的时候要运行的命令</li>
<li>可以追加命令</li>
</ul>
<h4 id="ONBUILD"><a href="#ONBUILD" class="headerlink" title="ONBUILD"></a>ONBUILD</h4><ul>
<li>构建一个被继承的时候，Dockerfile会运行ONBUILD指令，触发指令。</li>
</ul>
<h4 id="COPY"><a href="#COPY" class="headerlink" title="COPY"></a>COPY</h4><ul>
<li>类似于add,将我们的文件拷贝到镜像中</li>
</ul>
<h4 id="ENV"><a href="#ENV" class="headerlink" title="ENV"></a>ENV</h4><ul>
<li>构建的时候设置环境变量</li>
</ul>
<h3 id="实战测试："><a href="#实战测试：" class="headerlink" title="实战测试："></a>实战测试：</h3><ul>
<li>非常基础的镜像：scratch , 连CentOS系统都是由它构建的嗷！！！Docker Hub中99%的镜像都是由这个镜像过来的。</li>
</ul>
<blockquote>
<p>创建一个自己的CentOS</p>
</blockquote>
<ul>
<li>由于原来的镜像中很多指令类似于pwd , vim都没有，我们创建一个有这些东西的镜像。</li>
</ul>
<ol>
<li>编写配置文件：</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@VM-12-10-centos dockerfile]# cat mydockerfile </span><br><span class="line">FROM centos</span><br><span class="line">MAINTAINER tuzi&lt;2632746476@qq.com&gt;</span><br><span class="line"></span><br><span class="line">ENV MYPATH /usr/local</span><br><span class="line">WORKDIR $MYPATH</span><br><span class="line"></span><br><span class="line">RUN yum -y install vim</span><br><span class="line">RUN yum -y install net-tools</span><br><span class="line"></span><br><span class="line">EXPOSE 3344</span><br><span class="line"></span><br><span class="line">CMD echo $MYPATH</span><br><span class="line">CMD echo &quot;-----end-----&quot;</span><br><span class="line">CMD /bin/bash</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>构建镜像：</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br></pre></td><td class="code"><pre><span class="line">[root@VM-12-10-centos dockerfile]# docker build -f mydockerfile -t mycentos:0.1 .</span><br><span class="line">Sending build context to Docker daemon  2.048kB</span><br><span class="line">Step 1/10 : FROM centos</span><br><span class="line"><span class="meta prompt_"> ---&gt; </span><span class="language-bash">300e315adb2f</span></span><br><span class="line">Step 2/10 : MAINTAINER tuzi&lt;2632746476@qq.com&gt;</span><br><span class="line"><span class="meta prompt_"> ---&gt; </span><span class="language-bash">Using cache</span></span><br><span class="line"><span class="meta prompt_"> ---&gt; </span><span class="language-bash">b7b887b8d1d9</span></span><br><span class="line">Step 3/10 : ENV MYPATH /usr/local</span><br><span class="line"><span class="meta prompt_"> ---&gt; </span><span class="language-bash">Using cache</span></span><br><span class="line"><span class="meta prompt_"> ---&gt; </span><span class="language-bash">a93da34898df</span></span><br><span class="line">Step 4/10 : WORKDIR $MYPATH</span><br><span class="line"><span class="meta prompt_"> ---&gt; </span><span class="language-bash">Using cache</span></span><br><span class="line"><span class="meta prompt_"> ---&gt; </span><span class="language-bash">aeb1cad8b76e</span></span><br><span class="line">Step 5/10 : RUN yum -y install vim</span><br><span class="line"><span class="meta prompt_"> ---&gt; </span><span class="language-bash">Running <span class="keyword">in</span> e77104a1f8bf</span></span><br><span class="line">CentOS Linux 8 - AppStream                      1.5 MB/s | 6.3 MB     00:04    </span><br><span class="line">CentOS Linux 8 - BaseOS                         419 kB/s | 2.3 MB     00:05    </span><br><span class="line">CentOS Linux 8 - Extras                          20 kB/s | 9.6 kB     00:00    </span><br><span class="line">Dependencies resolved.</span><br><span class="line">================================================================================</span><br><span class="line"> Package             Arch        Version                   Repository      Size</span><br><span class="line">================================================================================</span><br><span class="line">Installing:</span><br><span class="line"> vim-enhanced        x86_64      2:8.0.1763-15.el8         appstream      1.4 M</span><br><span class="line">Installing dependencies:</span><br><span class="line"> gpm-libs            x86_64      1.20.7-15.el8             appstream       39 k</span><br><span class="line"> vim-common          x86_64      2:8.0.1763-15.el8         appstream      6.3 M</span><br><span class="line"> vim-filesystem      noarch      2:8.0.1763-15.el8         appstream       48 k</span><br><span class="line"> which               x86_64      2.21-12.el8               baseos          49 k</span><br><span class="line"></span><br><span class="line">Transaction Summary</span><br><span class="line">================================================================================</span><br><span class="line">Install  5 Packages</span><br><span class="line"></span><br><span class="line">Total download size: 7.8 M</span><br><span class="line">Installed size: 30 M</span><br><span class="line">Downloading Packages:</span><br><span class="line">(1/5): gpm-libs-1.20.7-15.el8.x86_64.rpm        680 kB/s |  39 kB     00:00    </span><br><span class="line">(2/5): vim-filesystem-8.0.1763-15.el8.noarch.rp 360 kB/s |  48 kB     00:00    </span><br><span class="line">(3/5): vim-enhanced-8.0.1763-15.el8.x86_64.rpm  1.3 MB/s | 1.4 MB     00:01    </span><br><span class="line">(4/5): which-2.21-12.el8.x86_64.rpm              15 kB/s |  49 kB     00:03    </span><br><span class="line">(5/5): vim-common-8.0.1763-15.el8.x86_64.rpm    1.3 MB/s | 6.3 MB     00:05    </span><br><span class="line">--------------------------------------------------------------------------------</span><br><span class="line">Total                                           1.3 MB/s | 7.8 MB     00:05     </span><br><span class="line">warning: /var/cache/dnf/appstream-02e86d1c976ab532/packages/gpm-libs-1.20.7-15.el8.x86_64.rpm: Header V3 RSA/SHA256 Signature, key ID 8483c65d: NOKEY</span><br><span class="line">CentOS Linux 8 - AppStream                      1.6 MB/s | 1.6 kB     00:00    </span><br><span class="line">Importing GPG key 0x8483C65D:</span><br><span class="line"> Userid     : &quot;CentOS (CentOS Official Signing Key) &lt;security@centos.org&gt;&quot;</span><br><span class="line"> Fingerprint: 99DB 70FA E1D7 CE22 7FB6 4882 05B5 55B3 8483 C65D</span><br><span class="line"> From       : /etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial</span><br><span class="line">Key imported successfully</span><br><span class="line">Running transaction check</span><br><span class="line">Transaction check succeeded.</span><br><span class="line">Running transaction test</span><br><span class="line">Transaction test succeeded.</span><br><span class="line">Running transaction</span><br><span class="line">  Preparing        :                                                        1/1 </span><br><span class="line">  Installing       : which-2.21-12.el8.x86_64                               1/5 </span><br><span class="line">  Installing       : vim-filesystem-2:8.0.1763-15.el8.noarch                2/5 </span><br><span class="line">  Installing       : vim-common-2:8.0.1763-15.el8.x86_64                    3/5 </span><br><span class="line">  Installing       : gpm-libs-1.20.7-15.el8.x86_64                          4/5 </span><br><span class="line">  Running scriptlet: gpm-libs-1.20.7-15.el8.x86_64                          4/5 </span><br><span class="line">  Installing       : vim-enhanced-2:8.0.1763-15.el8.x86_64                  5/5 </span><br><span class="line">  Running scriptlet: vim-enhanced-2:8.0.1763-15.el8.x86_64                  5/5 </span><br><span class="line">  Running scriptlet: vim-common-2:8.0.1763-15.el8.x86_64                    5/5 </span><br><span class="line">  Verifying        : gpm-libs-1.20.7-15.el8.x86_64                          1/5 </span><br><span class="line">  Verifying        : vim-common-2:8.0.1763-15.el8.x86_64                    2/5 </span><br><span class="line">  Verifying        : vim-enhanced-2:8.0.1763-15.el8.x86_64                  3/5 </span><br><span class="line">  Verifying        : vim-filesystem-2:8.0.1763-15.el8.noarch                4/5 </span><br><span class="line">  Verifying        : which-2.21-12.el8.x86_64                               5/5 </span><br><span class="line"></span><br><span class="line">Installed:</span><br><span class="line">  gpm-libs-1.20.7-15.el8.x86_64         vim-common-2:8.0.1763-15.el8.x86_64    </span><br><span class="line">  vim-enhanced-2:8.0.1763-15.el8.x86_64 vim-filesystem-2:8.0.1763-15.el8.noarch</span><br><span class="line">  which-2.21-12.el8.x86_64             </span><br><span class="line"></span><br><span class="line">Complete!</span><br><span class="line">Removing intermediate container e77104a1f8bf</span><br><span class="line"><span class="meta prompt_"> ---&gt; </span><span class="language-bash">77e4b03443f6</span></span><br><span class="line">Step 6/10 : RUN yum -y install net-tools</span><br><span class="line"><span class="meta prompt_"> ---&gt; </span><span class="language-bash">Running <span class="keyword">in</span> 9c36b34f901a</span></span><br><span class="line">Last metadata expiration check: 0:00:12 ago on Mon May 24 07:44:53 2021.</span><br><span class="line">Dependencies resolved.</span><br><span class="line">================================================================================</span><br><span class="line"> Package         Architecture Version                        Repository    Size</span><br><span class="line">================================================================================</span><br><span class="line">Installing:</span><br><span class="line"> net-tools       x86_64       2.0-0.52.20160912git.el8       baseos       322 k</span><br><span class="line"></span><br><span class="line">Transaction Summary</span><br><span class="line">================================================================================</span><br><span class="line">Install  1 Package</span><br><span class="line"></span><br><span class="line">Total download size: 322 k</span><br><span class="line">Installed size: 942 k</span><br><span class="line">Downloading Packages:</span><br><span class="line">net-tools-2.0-0.52.20160912git.el8.x86_64.rpm    56 kB/s | 322 kB     00:05    </span><br><span class="line">--------------------------------------------------------------------------------</span><br><span class="line">Total                                            46 kB/s | 322 kB     00:07     </span><br><span class="line">Running transaction check</span><br><span class="line">Transaction check succeeded.</span><br><span class="line">Running transaction test</span><br><span class="line">Transaction test succeeded.</span><br><span class="line">Running transaction</span><br><span class="line">  Preparing        :                                                        1/1 </span><br><span class="line">  Installing       : net-tools-2.0-0.52.20160912git.el8.x86_64              1/1 </span><br><span class="line">  Running scriptlet: net-tools-2.0-0.52.20160912git.el8.x86_64              1/1 </span><br><span class="line">  Verifying        : net-tools-2.0-0.52.20160912git.el8.x86_64              1/1 </span><br><span class="line"></span><br><span class="line">Installed:</span><br><span class="line">  net-tools-2.0-0.52.20160912git.el8.x86_64                                     </span><br><span class="line"></span><br><span class="line">Complete!</span><br><span class="line">Removing intermediate container 9c36b34f901a</span><br><span class="line"><span class="meta prompt_"> ---&gt; </span><span class="language-bash">5aa957293560</span></span><br><span class="line">Step 7/10 : EXPOSE 3344</span><br><span class="line"><span class="meta prompt_"> ---&gt; </span><span class="language-bash">Running <span class="keyword">in</span> 5337e93b278e</span></span><br><span class="line">Removing intermediate container 5337e93b278e</span><br><span class="line"><span class="meta prompt_"> ---&gt; </span><span class="language-bash">24a3cf5703dd</span></span><br><span class="line">Step 8/10 : CMD echo $MYPATH</span><br><span class="line"><span class="meta prompt_"> ---&gt; </span><span class="language-bash">Running <span class="keyword">in</span> 0b0ee9826aed</span></span><br><span class="line">Removing intermediate container 0b0ee9826aed</span><br><span class="line"><span class="meta prompt_"> ---&gt; </span><span class="language-bash">e990f552ebff</span></span><br><span class="line">Step 9/10 : CMD echo &quot;-----end-----&quot;</span><br><span class="line"><span class="meta prompt_"> ---&gt; </span><span class="language-bash">Running <span class="keyword">in</span> 06b75cec4a71</span></span><br><span class="line">Removing intermediate container 06b75cec4a71</span><br><span class="line"><span class="meta prompt_"> ---&gt; </span><span class="language-bash">095dbd389dcc</span></span><br><span class="line">Step 10/10 : CMD /bin/bash</span><br><span class="line"><span class="meta prompt_"> ---&gt; </span><span class="language-bash">Running <span class="keyword">in</span> 84b5d1acc86b</span></span><br><span class="line">Removing intermediate container 84b5d1acc86b</span><br><span class="line"><span class="meta prompt_"> ---&gt; </span><span class="language-bash">8eb39247efa4</span></span><br><span class="line">Successfully built 8eb39247efa4</span><br><span class="line">Successfully tagged mycentos:0.1</span><br></pre></td></tr></table></figure>

<ul>
<li><p>注意build最后有个点哈！！！有的它就直接使用，没有的它就去下载。</p>
</li>
<li><p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210524154755.png" alt="image-20210524154755515"></p>
</li>
<li><p>验证过后发现，vim ,  ifconfig , pwd都是设置正确的嗷！</p>
</li>
<li><p>解锁新指令：docker history imageID：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@VM-12-10-centos dockerfile]# docker history 8eb39247efa4</span><br><span class="line">IMAGE          CREATED         CREATED BY                                      SIZE      COMMENT</span><br><span class="line">8eb39247efa4   6 minutes ago   /bin/sh -c #(nop)  CMD [&quot;/bin/sh&quot; &quot;-c&quot; &quot;/bin…   0B        </span><br><span class="line">095dbd389dcc   6 minutes ago   /bin/sh -c #(nop)  CMD [&quot;/bin/sh&quot; &quot;-c&quot; &quot;echo…   0B        </span><br><span class="line">e990f552ebff   6 minutes ago   /bin/sh -c #(nop)  CMD [&quot;/bin/sh&quot; &quot;-c&quot; &quot;echo…   0B        </span><br><span class="line">24a3cf5703dd   6 minutes ago   /bin/sh -c #(nop)  EXPOSE 3344                  0B        </span><br><span class="line">5aa957293560   6 minutes ago   /bin/sh -c yum -y install net-tools             23.3MB    </span><br><span class="line">77e4b03443f6   6 minutes ago   /bin/sh -c yum -y install vim                   58MB      </span><br><span class="line">aeb1cad8b76e   7 minutes ago   /bin/sh -c #(nop) WORKDIR /usr/local            0B        </span><br><span class="line">a93da34898df   7 minutes ago   /bin/sh -c #(nop)  ENV MYPATH=/usr/local        0B        </span><br><span class="line">b7b887b8d1d9   7 minutes ago   /bin/sh -c #(nop)  MAINTAINER tuzi&lt;263274647…   0B        </span><br><span class="line">300e315adb2f   5 months ago    /bin/sh -c #(nop)  CMD [&quot;/bin/bash&quot;]            0B        </span><br><span class="line">&lt;missing&gt;      5 months ago    /bin/sh -c #(nop)  LABEL org.label-schema.sc…   0B        </span><br><span class="line">&lt;missing&gt;      5 months ago    /bin/sh -c #(nop) ADD file:bd7a2aed6ede423b7…   209MB     </span><br></pre></td></tr></table></figure>

<ul>
<li>通过history可以看看镜像是怎么做出来的嗷！！！</li>
</ul>
</li>
</ul>
<h2 id=""><a href="#" class="headerlink" title=""></a></h2><h3 id="CMD和ENTRYPOINT的区别："><a href="#CMD和ENTRYPOINT的区别：" class="headerlink" title="CMD和ENTRYPOINT的区别："></a>CMD和ENTRYPOINT的区别：</h3><ul>
<li>CMD可以执行多个的嗷：</li>
</ul>
<p><code>CMD [&quot;ls&quot;,&quot;-a&quot;]</code></p>
<ul>
<li><p>在你run的时候，只有最后一个cmd指令生效</p>
</li>
<li><p>CMD中，如果你想用<code>docker run test -l</code>这种形式的话，-l会替换掉上面的ls -a，指令出错，无法拼接在指令后面orz。</p>
</li>
<li><p>ENTRYPOINT则可以让它在我们编写的内容后面添加。</p>
</li>
</ul>
<p><code>ENTRYPOINT [&quot;ls&quot;,&quot;-a&quot;]</code></p>
<ul>
<li><p>这个时候如果你要和上面一样跑起来，这个指令则添加到我们的ENTRYPOINT后面，变为ls -al，这就是这两者的区别。</p>
</li>
<li><p>DOCKERFILE中很多相似的命令，最好的方法就是去实践并且对比结果。</p>
</li>
</ul>
<h3 id="实例：Tomcat镜像"><a href="#实例：Tomcat镜像" class="headerlink" title="实例：Tomcat镜像"></a>实例：Tomcat镜像</h3><ul>
<li><p>这个我没有实操嗷，因为我这儿没有Tomcat和JDK的压缩包，这儿就没有再去下载完成这个任务！！！</p>
</li>
<li><p>步骤：</p>
<ol>
<li>准备镜像文件tomcat压缩包，jdk压缩包</li>
<li>编写dockerfile压缩包（官方命名为Dockerfile，如果是这个名字的话-f就可以不需要这个参数，会默认去寻找这个名字的文件来进行build）。</li>
</ol>
</li>
<li><p>注意哈，在dockerfile里面使用add添加文件后，如果它的压缩包，docker会自动帮你解压嗷！！！</p>
</li>
<li><p>注意最后那个.哈，比如你要add导入一些文件，你可以先切到对应的文件目录之下，然后直接用文件名导入即可。这样做非常简单，最后的 . 其实就指定了在当前目录下去寻找文件。</p>
</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">FROM centos</span><br><span class="line">MAINTAINER tuzi&lt;2632746476@qq.com&gt;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">复制本机的文件进入容器中</span></span><br><span class="line">COPY readme.txt /usr/1oca1/readme.txt</span><br><span class="line">ADD jdk-8u11-1inux-x64.tar.gz /usr/local/</span><br><span class="line">ADD apache-tomcat-9.0.22.tar.gz /usr/local/</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">安装vim</span></span><br><span class="line">RUN yum -y install vim</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">设置docker镜像中的环境</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">指定工作目录</span></span><br><span class="line">ENV MYPATH /usr/1oca1</span><br><span class="line">WORKDIR $MYPATH</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">指定JAVA环境</span></span><br><span class="line">ENV JAVA_HOME /usr/1oca1/jdk1.8.0.11</span><br><span class="line">ENV CLASSPATH $JAVA_HOME/1ib/dt. jar:$JAVA_HOME/lib/too1s.jar</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">指定Tomcat环境</span></span><br><span class="line">ENV CATALINA_HOME /usr/1oca1/apache- tomcat-9.0.22</span><br><span class="line">ENV CATALINA_BASH /usr/1oca1/apache-tomcat-9.0.22</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">指定默认路径，和windows里面一样的，这样方便在命令行中直接使用命令！！！</span></span><br><span class="line">ENV PATH $PATH:$JAVA_HOME/bin:$CATALINA_HOME/lib:$CATALINA_HOME/bin</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">暴露端口</span></span><br><span class="line">EXPOSE 8080</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">启动一些文件来进行操作，例如日志的开启啊</span></span><br><span class="line">CMD /usr/1oca1/apache-tomcat-9.0.22/bin/startup.sh &amp;&amp; tail -F /ur1/1oca1/apache-tomcat-9.0.22/bin/1ogs/catalina.out</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>创建镜像：</li>
</ol>
<p><code>docker build -t diytomcat .</code></p>
<ul>
<li>dockerfile文件的名字为标准的Dockerfile的话，-f就不用自己设置了，系统会导入的嗷！！！</li>
<li>docker run的时候如果没有指定版本的话，用的就是默认版本，也就是最新版，因此这里要注意一下嗷！！！</li>
</ul>
<ol start="4">
<li>启动镜像：</li>
</ol>
<p>进行一些挂载，例如发布的时候的目录挂载到Linux虚拟机中嗷！！！</p>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210524191909.png" alt="image-20210524191902624"></p>
<ul>
<li>例如上面这个，将这个容器的webapps挂载到了本地的test目录，将日志目录也挂载到了本地。这里我们。</li>
</ul>
<ol start="5">
<li><p>测试访问</p>
</li>
<li><p>发布项目（由于我们做了挂载，可以直接对于本地的文件进行修改就可以实现发布）</p>
</li>
</ol>
<p>例如webapps&#x2F;test挂载到了本地的目录，那么我们就可以去test里面新建WEB-INF啊，新建web.xml啊，新建index.jsp啊之类的，都可以新建的。然后访问对应端口</p>
<ul>
<li>以后的项目都是这个流程嗷！！！</li>
</ul>
<h2 id="发布镜像："><a href="#发布镜像：" class="headerlink" title="发布镜像："></a>发布镜像：</h2><h3 id="发布到docker-hub："><a href="#发布到docker-hub：" class="headerlink" title="发布到docker hub："></a>发布到docker hub：</h3><ul>
<li><p>先去DockerHub的注册一个账号</p>
</li>
<li><p>服务器上提交自己的镜像</p>
</li>
<li><p><code>docker push 账户名(liututu)/镜像名(diytomcat:1.0)</code></p>
</li>
</ul>
<h4 id="docker-login："><a href="#docker-login：" class="headerlink" title="docker login："></a>docker login：</h4><ul>
<li>登录远程的dockerhub</li>
<li>登录完毕之后就可以提交镜像了。</li>
<li>登录之后就可以docker push了。</li>
<li><code>docker login -u liututu</code></li>
<li>然后输入密码即可以登录</li>
</ul>
<h4 id="docker-tag："><a href="#docker-tag：" class="headerlink" title="docker tag："></a>docker tag：</h4><ul>
<li>用于添加标签</li>
<li><code>docker tag 镜像id tag的名字和版本号</code></li>
<li>e.g. <code>docker tag xxx tuzi/tomcat:1.0</code></li>
</ul>
<h3 id="发布到腾讯云："><a href="#发布到腾讯云：" class="headerlink" title="发布到腾讯云："></a>发布到腾讯云：</h3><ul>
<li>有点麻烦，暂不考虑</li>
</ul>
<h2 id="Docker全流程小结："><a href="#Docker全流程小结：" class="headerlink" title="Docker全流程小结："></a>Docker全流程小结：</h2><ul>
<li>流程图如下：</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210525164723.png" alt="image-20210525164716547"></p>
<h3 id="docker-save"><a href="#docker-save" class="headerlink" title="docker save:"></a>docker save:</h3><ul>
<li>可以使用–help去看使用方法很简单的嗷</li>
<li>-o 参数，用于指定输出路径</li>
</ul>
<h3 id="docker-load："><a href="#docker-load：" class="headerlink" title="docker load："></a>docker load：</h3><ul>
<li>可以使用–help去看使用方法很简单的嗷</li>
<li>- i参数，用于指定输入读取的路径</li>
</ul>
<h1 id="Docker网络"><a href="#Docker网络" class="headerlink" title="Docker网络"></a>Docker网络</h1><h2 id="理解网络"><a href="#理解网络" class="headerlink" title="理解网络"></a>理解网络</h2><h3 id="ip-addr"><a href="#ip-addr" class="headerlink" title="ip addr:"></a>ip addr:</h3><ul>
<li>docker中的网络是docker0</li>
<li>docker中先清空，比较方便，rmi and rm</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210525165959.png" alt="image-20210525165958822"></p>
<ul>
<li><p>三个网络，有点乱嗷！！！</p>
</li>
<li><p>查看容器内部网络地址，就是上面那幅图：ip addr。</p>
</li>
<li><p><code>docker exec -it tomcat01 ip addr</code>可以使用命令连接直接查看ip addr。</p>
</li>
<li><p>下面这幅图你可以看到，Linux宿主机是可以Ping通docker容器的。</p>
</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210525170516.png" alt="image-20210525170515929"></p>
<blockquote>
<p>原理：</p>
<ol>
<li>每启动一个docker容器，docker就会为容器分配一个ip。</li>
<li>只要安装了docker，就会有一个docker网卡。这个网卡使用的是evth-pair桥接模式。</li>
<li>多启动了一个容器之后，在宿主机内使用ip addr可以看到多了一个网卡！！！</li>
<li>容器带来的网卡是一对儿的，容器里面有一个，宿主机外面有一个，这两个网卡是相互绑定可以通信的。这样一对儿一对儿网卡存在的技术就叫做evth-pair技术。一端连着协议，一端彼此相连，他们之间就可以通信。</li>
<li>因此我们经常使用evth-pair来充当一个桥梁，连接各种网络设备的。</li>
<li>OpenStac , Docker容器之间的连接，OVS的连接，都是使用 evth-pair技术。</li>
</ol>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210525171852.png" alt="image-20210525171852546"></p>
<ul>
<li>容器和容器之间也是可以相互ping通的嗷！！！</li>
<li>网络通信流程图：</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210525172510.png" alt="image-20210525172305633"></p>
<p>结论：Tomcat01和Tomcat02共用一个路由器 ， docker0</p>
<ul>
<li>在所有容器不指定网络的情况下，默认使用的都是docker0，docker会给我们容器分配一个默认的可用ip</li>
</ul>
<blockquote>
<p>小结:</p>
<p>​	Docker使用的Linux中的桥接模式嗷！！！</p>
<p>概念图，宿主机中式一个Docker容器的网桥：</p>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210525172743.png" alt="image-20210525172743908"></p>
</blockquote>
<ul>
<li>Docker中的所有的网络接口都是虚拟的，虚拟的转发效率高！！！</li>
<li>只要容器删除了，容器的一堆网卡就都没了。</li>
<li>思考场景</li>
</ul>
<blockquote>
<p>思考一个场景，我们编写了一个微服务，database url &#x3D; ip; 项目不重启，数据库ip换掉了，我们希望可以处理这个问题，可以使用名字来访问容器。</p>
</blockquote>
<h2 id="docker-link："><a href="#docker-link：" class="headerlink" title="docker link："></a>docker link：</h2><ul>
<li>用名字取ping ， 容器之间ping不通：</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210525173214.png" alt="image-20210525173214861"></p>
<ul>
<li>解决问题的样式：</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210525173352.png" alt="image-20210525173351915"></p>
<ul>
<li>3 ping 2可以ping通，2 ping 3通不了，因为你只对于3做了配置</li>
</ul>
<h3 id="docker-network-ls"><a href="#docker-network-ls" class="headerlink" title="docker  network ls:"></a>docker  network ls:</h3><p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210525173746.png" alt="image-20210525173746192"></p>
<h3 id="docker-network-inspect-容器id"><a href="#docker-network-inspect-容器id" class="headerlink" title="docker network inspect 容器id:"></a>docker network inspect 容器id:</h3><ul>
<li>查看容器的网络连接情况。</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210525174735.png" alt="image-20210525174735252"></p>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210525174826.png" alt="image-20210525174826630"></p>
<ul>
<li>其实tomcat03是配置了tomcat02</li>
</ul>
<p>看看配置：</p>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210525175127.png" alt="image-20210525175127130"></p>
<ul>
<li>这里进入了tomcat03中的host配置文件，查看到了tomcat03关于tomcat02的网络配置。</li>
<li>原理：<ul>
<li>在启动容器的时候，对于tomcat02进行了一个绑定，其实就算不绑定，用容器id也能够ping通。</li>
</ul>
</li>
<li>未进行配置的tomcat02配置文件中的内容：</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210525185042.png" alt="image-20210525185042340"></p>
<ul>
<li><p>真实玩docker的时候，使用自定义的网络，就很方便嗷！！！不适用docker0嗷！！！</p>
</li>
<li><p>docker0的问题：</p>
<ul>
<li>不支持容器名访问嗷！！！</li>
</ul>
</li>
<li><p>自定义yyds！！！</p>
</li>
</ul>
<h2 id="自定义网络"><a href="#自定义网络" class="headerlink" title="自定义网络"></a>自定义网络</h2><ul>
<li>容器互联作用</li>
</ul>
<h3 id="移除网络："><a href="#移除网络：" class="headerlink" title="移除网络："></a>移除网络：</h3><ul>
<li>docker network ls可以显示所有的网络</li>
<li>docker network rm 网络id ， 可以移除一个或多个网络</li>
<li>docker network rm $(docker network ls -q)这样就可以递归删除所有网络嗷！！！</li>
</ul>
<h3 id="网络模式："><a href="#网络模式：" class="headerlink" title="网络模式："></a>网络模式：</h3><ul>
<li>bridge：在docker上面搭桥。（默认，自己创建也是使用桥接模式的嗷！！！）</li>
<li>none：不配置网络</li>
<li>host：和宿主机共享网络</li>
<li>container：容器内网络联通（用的少，局限很大）</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@VM-12-10-centos ~]# docker network ls</span><br><span class="line">NETWORK ID     NAME      DRIVER    SCOPE</span><br><span class="line">96547b049a6f   bridge    bridge    local</span><br><span class="line">cbf21525bdaa   host      host      local</span><br><span class="line">1f4bf7dc20df   none      null      local</span><br></pre></td></tr></table></figure>



<ul>
<li>上面这三个是docker为我们默认配置好的三个嗷！！！</li>
</ul>
<h3 id="使用create创建网络："><a href="#使用create创建网络：" class="headerlink" title="使用create创建网络："></a>使用create创建网络：</h3><ul>
<li>我们直接启动镜像的命令，实际上是默认有个：<code>--net bridge</code>参数的，这里实际上就指定了使用docker默认为我们提供的docker0桥接模式也就是我们上面这一段代码中的第一个也就是名字为bridge的这个网络。</li>
<li>docker0默认名字不能访问 ，可以使用link进行打通，但是比较麻烦嗷！！！</li>
<li>可以调用帮助文档：<code>docker network create --help</code></li>
<li>创建一个网络：<ul>
<li><code>docker network create --driver bridge --subnet 192.168.0.0/16 --gateway 192.168.0.1 mynet </code></li>
<li>上面这个相当于新建了一个router</li>
</ul>
</li>
<li>我们创建了网络之后进行查看：</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">[root@VM-12-10-centos ~]# docker inspect mynet</span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;Name&quot;: &quot;mynet&quot;,</span><br><span class="line">        &quot;Id&quot;: &quot;4fdb6ebd5847ecda8ef9aa755cb1fe24a0c792f089492aaa273e528517c56a45&quot;,</span><br><span class="line">        &quot;Created&quot;: &quot;2021-05-25T21:49:13.115937992+08:00&quot;,</span><br><span class="line">        &quot;Scope&quot;: &quot;local&quot;,</span><br><span class="line">        &quot;Driver&quot;: &quot;bridge&quot;,</span><br><span class="line">        &quot;EnableIPv6&quot;: false,</span><br><span class="line">        &quot;IPAM&quot;: &#123;</span><br><span class="line">            &quot;Driver&quot;: &quot;default&quot;,</span><br><span class="line">            &quot;Options&quot;: &#123;&#125;,</span><br><span class="line">            &quot;Config&quot;: [</span><br><span class="line">                &#123;</span><br><span class="line">                    &quot;Subnet&quot;: &quot;192.168.0.0/16&quot;,</span><br><span class="line">                    &quot;Gateway&quot;: &quot;192.168.0.1&quot;</span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;Internal&quot;: false,</span><br><span class="line">        &quot;Attachable&quot;: false,</span><br><span class="line">        &quot;Ingress&quot;: false,</span><br><span class="line">        &quot;ConfigFrom&quot;: &#123;</span><br><span class="line">            &quot;Network&quot;: &quot;&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;ConfigOnly&quot;: false,</span><br><span class="line">        &quot;Containers&quot;: &#123;&#125;,</span><br><span class="line">        &quot;Options&quot;: &#123;&#125;,</span><br><span class="line">        &quot;Labels&quot;: &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<ul>
<li>这个时候启动容器的时候，就可以加上参数：<code>--net mynet</code>，这样就完成了<code>router</code>的指定。</li>
<li>当创建了新的容器之后，我们再执行这个inspect mynet的命令，就可以看到我们上面这一坨里面的多了容器！！！为了验证容器间可以进行交互，我们这里创建了tomcat01和tomcat02，作为示例：</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">[root@VM-12-10-centos ~]# docker inspect mynet</span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;Name&quot;: &quot;mynet&quot;,</span><br><span class="line">        &quot;Id&quot;: &quot;4fdb6ebd5847ecda8ef9aa755cb1fe24a0c792f089492aaa273e528517c56a45&quot;,</span><br><span class="line">        &quot;Created&quot;: &quot;2021-05-25T21:49:13.115937992+08:00&quot;,</span><br><span class="line">        &quot;Scope&quot;: &quot;local&quot;,</span><br><span class="line">        &quot;Driver&quot;: &quot;bridge&quot;,</span><br><span class="line">        &quot;EnableIPv6&quot;: false,</span><br><span class="line">        &quot;IPAM&quot;: &#123;</span><br><span class="line">            &quot;Driver&quot;: &quot;default&quot;,</span><br><span class="line">            &quot;Options&quot;: &#123;&#125;,</span><br><span class="line">            &quot;Config&quot;: [</span><br><span class="line">                &#123;</span><br><span class="line">                    &quot;Subnet&quot;: &quot;192.168.0.0/16&quot;,</span><br><span class="line">                    &quot;Gateway&quot;: &quot;192.168.0.1&quot;</span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;Internal&quot;: false,</span><br><span class="line">        &quot;Attachable&quot;: false,</span><br><span class="line">        &quot;Ingress&quot;: false,</span><br><span class="line">        &quot;ConfigFrom&quot;: &#123;</span><br><span class="line">            &quot;Network&quot;: &quot;&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;ConfigOnly&quot;: false,</span><br><span class="line">        &quot;Containers&quot;: &#123;</span><br><span class="line">            &quot;0940afc5e87c21a391d076dbc2929f4ff6e2b86e753c9f608deeb4de32b92421&quot;: &#123;</span><br><span class="line">                &quot;Name&quot;: &quot;tomcat01&quot;,</span><br><span class="line">                &quot;EndpointID&quot;: &quot;0be1b6042a092ae4fdbd744559a781cccd865b6836c30c3cb25b92359d500214&quot;,</span><br><span class="line">                &quot;MacAddress&quot;: &quot;02:42:c0:a8:00:02&quot;,</span><br><span class="line">                &quot;IPv4Address&quot;: &quot;192.168.0.2/16&quot;,</span><br><span class="line">                &quot;IPv6Address&quot;: &quot;&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;def80af639d3f697e76de23f50fcdf209612fb70996289b1b812b07f547f55f6&quot;: &#123;</span><br><span class="line">                &quot;Name&quot;: &quot;tomcat02&quot;,</span><br><span class="line">                &quot;EndpointID&quot;: &quot;c827e50e6ec0c3c9692b3c4090ac9a9b38e38eb1b2cc70fe5baa7ef40856d14a&quot;,</span><br><span class="line">                &quot;MacAddress&quot;: &quot;02:42:c0:a8:00:03&quot;,</span><br><span class="line">                &quot;IPv4Address&quot;: &quot;192.168.0.3/16&quot;,</span><br><span class="line">                &quot;IPv6Address&quot;: &quot;&quot;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;Options&quot;: &#123;&#125;,</span><br><span class="line">        &quot;Labels&quot;: &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<ul>
<li>上面就可以看到我们的两个容器嗷！！！自创建的网络非常完善，带了很多的功能嗷！！！不管是ping id还是ping name都能够ping通嗷！！！</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">[root@VM-12-10-centos ~]# docker exec -it tomcat01 ping 192.168.0.3</span><br><span class="line">PING 192.168.0.3 (192.168.0.3) 56(84) bytes of data.</span><br><span class="line">64 bytes from 192.168.0.3: icmp_seq=1 ttl=64 time=0.060 ms</span><br><span class="line">64 bytes from 192.168.0.3: icmp_seq=2 ttl=64 time=0.049 ms</span><br><span class="line">64 bytes from 192.168.0.3: icmp_seq=3 ttl=64 time=0.058 ms</span><br><span class="line">64 bytes from 192.168.0.3: icmp_seq=4 ttl=64 time=0.064 ms</span><br><span class="line">^C</span><br><span class="line">--- 192.168.0.3 ping statistics ---</span><br><span class="line">4 packets transmitted, 4 received, 0% packet loss, time 1002ms</span><br><span class="line">rtt min/avg/max/mdev = 0.049/0.057/0.064/0.010 ms</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@VM-12-10-centos ~]# docker exec -it tomcat01 ping tomcat02</span><br><span class="line">PING tomcat02 (192.168.0.3) 56(84) bytes of data.</span><br><span class="line">64 bytes from tomcat02.mynet (192.168.0.3): icmp_seq=1 ttl=64 time=0.059 ms</span><br><span class="line">64 bytes from tomcat02.mynet (192.168.0.3): icmp_seq=2 ttl=64 time=0.061 ms</span><br><span class="line">64 bytes from tomcat02.mynet (192.168.0.3): icmp_seq=3 ttl=64 time=0.050 ms</span><br><span class="line">64 bytes from tomcat02.mynet (192.168.0.3): icmp_seq=4 ttl=64 time=0.059 ms</span><br><span class="line">64 bytes from tomcat02.mynet (192.168.0.3): icmp_seq=5 ttl=64 time=0.063 ms</span><br><span class="line">64 bytes from tomcat02.mynet (192.168.0.3): icmp_seq=6 ttl=64 time=0.055 ms</span><br><span class="line">64 bytes from tomcat02.mynet (192.168.0.3): icmp_seq=7 ttl=64 time=0.066 ms</span><br><span class="line">64 bytes from tomcat02.mynet (192.168.0.3): icmp_seq=8 ttl=64 time=0.063 ms</span><br><span class="line">64 bytes from tomcat02.mynet (192.168.0.3): icmp_seq=9 ttl=64 time=0.053 ms</span><br><span class="line">64 bytes from tomcat02.mynet (192.168.0.3): icmp_seq=10 ttl=64 time=0.049 ms</span><br><span class="line">^C</span><br><span class="line">--- tomcat02 ping statistics ---</span><br><span class="line">10 packets transmitted, 10 received, 0% packet loss, time 9ms</span><br><span class="line">rtt min/avg/max/mdev = 0.049/0.057/0.066/0.011 ms</span><br></pre></td></tr></table></figure>

<ul>
<li>不适用–link也可以ping名字，我们自定义的网络，docker都已经帮我们维护好了对应的关系。</li>
</ul>
<h3 id="网络联通："><a href="#网络联通：" class="headerlink" title="网络联通："></a>网络联通：</h3><ul>
<li>不同的网段是ping不通的嗷！！！</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210526115758.png" alt="image-20210526115321157"></p>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210526115806.png" alt="image-20210526115347834"></p>
<ul>
<li><code>docker network connect NETWORK CONTAINER</code></li>
<li>上面用于不同的网段之间的连接，联通就是将tomcat容器放到了mynet网络下。官方叫做：一个容器，两个ip地址。（一个公网ip , 一个私网ip）。</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210526120924.png" alt="image-20210526120923916"></p>
<ul>
<li>网卡和网卡之间正常是不能打通的，但是容器和网卡之间可以嗷！！！</li>
<li>只有01和mynet打通了，可以和它交互，但是02不可以嗷！！！！</li>
</ul>
<h2 id="实战（部署redis集群）："><a href="#实战（部署redis集群）：" class="headerlink" title="实战（部署redis集群）："></a>实战（部署redis集群）：</h2><ul>
<li>分片+高可用+负载均衡</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210526121252.png" alt="image-20210526121252216"></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1og4y1q7M4?p=38&spm_id_from=pageDriver">这一块儿可以后面再看嗷！！！</a></li>
<li>目前还没学redis，以及集群还没学，这个狂神的课程还有进阶版本的docker，目前这个教程就到这里嗷！！！</li>
</ul>
<h1 id="小技巧"><a href="#小技巧" class="headerlink" title="小技巧"></a>小技巧</h1><h2 id="Docker开机后跑不了的问题"><a href="#Docker开机后跑不了的问题" class="headerlink" title="Docker开机后跑不了的问题"></a>Docker开机后跑不了的问题</h2><ul>
<li>由于docker默认没有开启开机自动重启，这个时候你的虚拟机重新开机就会导致docker用不了，如何解决？那就再开启一次docker服务就好了哇！！！</li>
<li><code>systemctl restart docker.service</code></li>
</ul>
<h2 id="Docker映射端口在服务器打开"><a href="#Docker映射端口在服务器打开" class="headerlink" title="Docker映射端口在服务器打开"></a>Docker映射端口在服务器打开</h2><ul>
<li>此外，比如你想开放3344端口，你需要去腾讯云服务器配置的那个位置配置新的安全组：</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/cloudimg/20210523113152.png" alt="image-20210523113152632"></p>
<ul>
<li>配置完成之后可能需要重启实例才能使得服务生效嗷！！！</li>
</ul>
<h2 id="博客的nginx重启之后记得开"><a href="#博客的nginx重启之后记得开" class="headerlink" title="博客的nginx重启之后记得开"></a>博客的nginx重启之后记得开</h2><ul>
<li><code>systemctl start nginx.service</code></li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/56349043">Nginx服务器解决方案</a></li>
</ul>
<h2 id="远程访问的问题："><a href="#远程访问的问题：" class="headerlink" title="远程访问的问题："></a>远程访问的问题：</h2><ul>
<li>比如我开放了3344端口，直接通过域名:3344是能够访问到我监听3344端口的程序的。</li>
<li>突然让我想起了blog的搭建。我搭建blog的时候，使用nginx监听的是80端口。浏览器访问我的域名的话，默认访问的就是80端口，因此我的nginx能够为其提供服务。</li>
<li>域名:端口号就可以根据你自己的喜好，访问到部署在不同端口的应用程序。</li>
</ul>
<h2 id="x2F-bin-x2F-bash"><a href="#x2F-bin-x2F-bash" class="headerlink" title="&#x2F;bin&#x2F;bash"></a>&#x2F;bin&#x2F;bash</h2><ul>
<li>一般和-it这个选项用来一起使用的嗷，这里是指定交互的终端为bash，不然你怎么和内部容器进行交互嘛！！！</li>
<li></li>
</ul>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        Author:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">John Doe</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        Link:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="http://example.com/2021/05/19/Docker%E5%AD%A6%E4%B9%A0/">http://example.com/2021/05/19/Docker%E5%AD%A6%E4%B9%A0/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        Reprint policy:
                    </i>
                </span>
                <span class="reprint-info">
                    All articles in this blog are used except for special statements
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    reprint policy. If reproduced, please indicate source
                    <a href="/about" target="_blank">John Doe</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>Copied successfully, please follow the reprint policy of this article</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">more</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/%E5%90%8E%E7%AB%AF/">
                                    <span class="chip bg-color">后端</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;Previous</div>
            <div class="card">
                <a href="/2021/05/23/%E5%90%B4%E6%81%A9%E8%BE%BE%E7%9A%84%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-%E7%9D%A1%E5%89%8D%E8%8B%B1%E8%AF%AD%E5%90%AC%E5%8A%9B%E5%B0%8F%E5%8A%A9%E6%89%8B/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/16.jpg" class="responsive-img" alt="吴恩达的机器学习-睡前英语听力小助手">
                        
                        <span class="card-title">吴恩达的机器学习-睡前英语听力小助手</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            AWSL，吴恩达的声音太性感了。以后听着机器学习睡觉我觉得是一种该死的享受嗷！！！
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2021-05-23
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" class="post-category">
                                    机器学习
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">
                        <span class="chip bg-color">机器学习</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                Next&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2021/05/15/SpringMVC%E6%A1%86%E6%9E%B6%E5%AD%A6%E4%B9%A0/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/15.jpg" class="responsive-img" alt="SpringMVC框架学习">
                        
                        <span class="card-title">SpringMVC框架学习</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            这里是刚刚学完Spring的兔子，直接上SpringMVC，冲冲冲！！！
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2021-05-15
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E5%8A%A8%E5%8A%9B%E7%BB%93%E7%82%B9%E5%90%8E%E7%AB%AF%E8%AF%BE%E7%A8%8B/" class="post-category">
                                    动力结点后端课程
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E5%90%8E%E7%AB%AF/">
                        <span class="chip bg-color">后端</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>



<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>



    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;TOC</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="503838841"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="/libs/aplayer/Meting.min.js"></script>

    

    <div class="container row center-align"
         style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2019-2022</span>
            
            <a href="/about" target="_blank">John Doe</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;Total visits:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;Total visitors:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/blinkfox" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:1181062873@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=1181062873" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 1181062873" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;Search</span>
            <input type="search" id="searchInput" name="s" placeholder="Please enter a search keyword"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 白天和黑夜主题 -->
<div class="stars-con">
    <div id="stars"></div>
    <div id="stars2"></div>
    <div id="stars3"></div>  
</div>

<script>
    function switchNightMode() {
        $('<div class="Cuteen_DarkSky"><div class="Cuteen_DarkPlanet"></div></div>').appendTo($('body')),
        setTimeout(function () {
            $('body').hasClass('DarkMode') 
            ? ($('body').removeClass('DarkMode'), localStorage.setItem('isDark', '0'), $('#sum-moon-icon').removeClass("fa-sun").addClass('fa-moon')) 
            : ($('body').addClass('DarkMode'), localStorage.setItem('isDark', '1'), $('#sum-moon-icon').addClass("fa-sun").removeClass('fa-moon')),
            
            setTimeout(function () {
            $('.Cuteen_DarkSky').fadeOut(1e3, function () {
                $(this).remove()
            })
            }, 2e3)
        })
    }
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    

    <!-- 雪花特效 -->
    

    <!-- 鼠标星星特效 -->
    

     
        <script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
        <script src="/libs/others/TencentCaptcha.js"></script>
        <button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button>
    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
