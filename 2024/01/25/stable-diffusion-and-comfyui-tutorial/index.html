

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/tuzi.png">
  <link rel="icon" href="/img/tuzi.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Alexander Liu">
  <meta name="keywords" content="分布式系统,后端研发,数据协同">
  
    <meta name="description" content="最近做的一些内容偏向Stable Diffusion的应用，也用到了类似于WebUI和ComfyUI这样的UI工具。网上的教程多、杂、乱，就寻思的记录下自己摸索过程中的学习内容吧！这里很多东西都是参考网上的哈，只不过是摘抄+学习，具体用到的网站会放到References下面。另外，SD is the short of Stable Diffusion.">
<meta property="og:type" content="article">
<meta property="og:title" content="Stable Diffusion and ComfyUI Tutorial">
<meta property="og:url" content="https://alexanderliu-creator.github.io/2024/01/25/stable-diffusion-and-comfyui-tutorial/index.html">
<meta property="og:site_name" content="兔の博客">
<meta property="og:description" content="最近做的一些内容偏向Stable Diffusion的应用，也用到了类似于WebUI和ComfyUI这样的UI工具。网上的教程多、杂、乱，就寻思的记录下自己摸索过程中的学习内容吧！这里很多东西都是参考网上的哈，只不过是摘抄+学习，具体用到的网站会放到References下面。另外，SD is the short of Stable Diffusion.">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/alexanderliu-creator/blog_img/img/202401251541279.png">
<meta property="article:published_time" content="2024-01-25T07:39:03.000Z">
<meta property="article:modified_time" content="2024-01-27T03:01:49.190Z">
<meta property="article:author" content="Alexander Liu">
<meta property="article:tag" content="研0自学">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/alexanderliu-creator/blog_img/img/202401251541279.png">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>Stable Diffusion and ComfyUI Tutorial - 兔の博客</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"alexanderliu-creator.github.io","root":"/","version":"1.9.3","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":1},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.3.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="兔の博客" type="application/atom+xml">
</head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>兔的博客</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                友链
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/background_post.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="Stable Diffusion and ComfyUI Tutorial"></span>
          
        </div>

        
          
  <div class="mt-3">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-author" aria-hidden="true"></i>
        Alexander Liu
      </span>
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-01-25 15:39" pubdate>
          2024年1月25日 下午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          19k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          155 分钟
        
      </span>
    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> 次
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">Stable Diffusion and ComfyUI Tutorial</h1>
            
              <p class="note note-info">
                
                  
                    本文最后更新于：8 个月前
                  
                
              </p>
            
            
              <div class="markdown-body">
                
                <p>最近做的一些内容偏向Stable Diffusion的应用，也用到了类似于WebUI和ComfyUI这样的UI工具。网上的教程多、杂、乱，就寻思的记录下自己摸索过程中的学习内容吧！这里很多东西都是参考网上的哈，只不过是摘抄+学习，具体用到的网站会放到References下面。另外，SD is the short of Stable Diffusion.</p>
<span id="more"></span>

<h1 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h1><ul>
<li>在我看来，Stable Diffusion能够执行的任务有很多种。但是无非是在几种不同的形式之间转换：txt, img, vedio</li>
<li>常见的转换与任务有：<ul>
<li>txt2img</li>
<li>img2img<ul>
<li>Style Transfer</li>
<li>Upscaling</li>
<li>Inpainting</li>
</ul>
</li>
<li>img2vedio</li>
<li>vedio2vedio</li>
</ul>
</li>
<li>Stable Diffusion能做的本质就是，把“模糊的东西变清楚”，这一点十分重要。可以本来是糊的，也可以是后来我们手动糊上去的。调参无非也就是，怎么糊？糊多少？怎么变清楚，引导或者参考？清楚成什么样子？</li>
</ul>
<h1 id="How-to-use-Stable-Diffusion"><a href="#How-to-use-Stable-Diffusion" class="headerlink" title="How to use Stable Diffusion"></a>How to use Stable Diffusion</h1><h2 id="SD-Introduction"><a href="#SD-Introduction" class="headerlink" title="SD Introduction"></a>SD Introduction</h2><blockquote>
<p>This beginner’s guide is for newbies with zero experience with Stable Diffusion or other AI image generators. You will get an overview of Stable Diffusion and some basic useful tips. <a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/beginners-guide/">SD beginners-guide</a></p>
</blockquote>
<ul>
<li><p>SD是一种用于生成 AI 图像的潜在扩散模型。这些图像可以是逼真的，就像相机拍摄的图像一样，也可以是艺术风格的，就像由专业艺术家制作的一样。SD的好处有：</p>
<ul>
<li>开源：许多爱好者创建了免费的工具和模型。</li>
<li>专为低功耗计算机设计：免费或运行成本低廉。</li>
</ul>
</li>
<li><p>如何使用SD? Prompt!</p>
</li>
<li><p>SD能做什么？</p>
<ul>
<li>text2img</li>
<li>img2img</li>
<li>inpainting</li>
<li>make vedioes<ul>
<li>text2vedio</li>
<li>vedio2vedio(Stylize, …)</li>
</ul>
</li>
</ul>
</li>
<li><p>如何使用SD</p>
<ul>
<li>在线生成器</li>
<li>GUI</li>
</ul>
</li>
<li><p>GUI能够带给你的好处：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/prompt-guide/">Advanced prompting techniques</a>.</li>
<li>Regenerate a small part of an image with <a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/how-to-remove-a-person-with-ai-inpainting/">Inpainting</a>.</li>
<li>Generate images based on an input image (<a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/how-to-use-img2img-to-turn-an-amateur-drawing-to-professional-with-stable-diffusion-image-to-image/">Image-to-image</a>)</li>
<li>Edit an image by <a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/instruct-pix2pix/">giving an instruction</a>.</li>
</ul>
</li>
</ul>
<h2 id="Prompt-Matters"><a href="#Prompt-Matters" class="headerlink" title="Prompt Matters"></a>Prompt Matters</h2><ul>
<li>如何建立一个好的Prompt<ul>
<li>使用<a target="_blank" rel="noopener" href="https://andrewongai.gumroad.com/l/stable_diffusion_prompt_generator">提示生成器</a>是学习分步过程和重要关键字的好方法。对于初学者来说，学习一组强大的关键字及其预期效果至关重要。这就像学习新语言的词汇一样。<a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/how-to-come-up-with-good-prompts-for-ai-image-generation/#Some_good_keywords_for_you">您还可以在这里</a>找到关键字和注释的简短列表。</li>
<li>生成高质量图像的捷径是重用现有提示。前往提示集合，选择您喜欢的图像，然后窃取提示！缺点是您可能不明白为什么它会生成高质量的图像。阅读注释并更改提示即可查看效果。</li>
<li>使用PlaygroundAI等图像收集网站。选择您喜欢的图像并重新混合提示。但这可能就像大海捞针一样寻找高质量的提示。 将提示视为起点。修改以满足您的需求。</li>
</ul>
</li>
<li>一些Prompt的经验法则<ul>
<li>详细且具体：街上的一个女人 -&gt; 一位年轻的女士，棕色的眼睛，头发亮点，微笑，穿着时尚的商务休闲装，坐在外面，安静的城市街道，边缘照明</li>
<li>使用强大的关键词：有些关键字比其他关键字更强大。名人名字（例如艾玛·沃特森）、艺术家姓名（例如梵高）、艺术媒介（例如插图、绘画、照片）</li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/how-to-come-up-with-good-prompts-for-ai-image-generation/">您可以在构建提示的基础知识</a>中了解有关提示构建和示例关键字的更多信息。想作弊吗？就像做作业一样，您可以使用<a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/chatgpt-prompt/">ChatGPT</a>来生成提示！</li>
</ul>
<h2 id="Picture-Gen-Params"><a href="#Picture-Gen-Params" class="headerlink" title="Picture Gen Params"></a>Picture Gen Params</h2><ul>
<li>生成图片的时候，一些参数和其作用：<ul>
<li>**<a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/know-these-important-parameters-for-stunning-ai-images/#Image_size">图像尺寸</a>**：输出图像的尺寸。标准尺寸为512×512像素。将其更改为纵向或横向尺寸会对图像产生很大影响。例如，使用<a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/common-problems-in-ai-images-and-how-to-fix-them/#Not_showing_full_body_problems">肖像尺寸</a>生成全身图像。</li>
<li>**<a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/know-these-important-parameters-for-stunning-ai-images/#Sampling_steps">采样步骤</a>**：至少使用 20 个步骤。如果您看到模糊的图像，请增加。</li>
<li><a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/know-these-important-parameters-for-stunning-ai-images/#CFG_Scale"><strong>CFG 比例</strong></a>：典型值为 7。如果您希望图像更多地遵循提示，请增加值。</li>
<li><a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/know-these-important-parameters-for-stunning-ai-images/#Seed"><strong>种子值</strong></a>：-1 生成随机图像。如果您想要相同的图像，请指定一个值。</li>
</ul>
</li>
</ul>
<blockquote>
<p>强烈推荐，参阅<a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/know-these-important-parameters-for-stunning-ai-images/">其他设置的建议</a>。</p>
</blockquote>
<ul>
<li>生成图像数量？我会一次生成 2-4 个图像，以便加快搜索速度。当进行小的更改以增加看到可用内容的机会时，我会一次生成 4 个。有些提示只能在一半或更少的时间内起作用。因此，不要根据一张图像就取消提示。</li>
</ul>
<h2 id="Picture-Images-Defects"><a href="#Picture-Images-Defects" class="headerlink" title="Picture Images Defects"></a>Picture Images Defects</h2><blockquote>
<p>当你看到社交媒体上分享的令人惊叹的人工智能图像时，它们很可能经过了一系列的后处理步骤。</p>
</blockquote>
<ul>
<li>面部修复：SD不擅长生成面部。很多时候，生成的面孔存在伪影。我们经常使用经过训练来恢复人脸的图像 AI 模型，例如<a target="_blank" rel="noopener" href="https://github.com/sczhou/CodeFormer">CodeFormer</a>，AUTOMATIC1111 GUI 具有内置支持。看看<a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/common-problems-in-ai-images-and-how-to-fix-them/#Garbled_faces_and_eyes_problems">如何打开它</a>。您知道 v1.4 和 v1.5 模型有修复眼睛的更新吗？查看如何安装<a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/how-to-use-vae/">VAE</a>。</li>
<li>修复Inpainting小瑕疵: 第一次尝试很难获得您想要的图像。更好的方法是生成具有良好构图的图像。<a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/inpainting_basics/">然后用修补法</a>修复缺陷。</li>
<li>还有其他技术可以解决问题。阅读有关解决<a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/common-problems-in-ai-images-and-how-to-fix-them/">常见问题的</a>更多信息。</li>
</ul>
<h2 id="Custom-Models"><a href="#Custom-Models" class="headerlink" title="Custom Models"></a>Custom Models</h2><ul>
<li><p>模型介绍</p>
<ul>
<li><p>Stability AI及其合作伙伴发布的官方模型称为<strong>基础模型</strong>。基本模型的一些示例包括稳定<a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/install-stable-diffusion-2-1/">扩散</a><a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/models/#Stable_diffusion_v14">1.4、1.5、2.0</a><a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/how-to-run-stable-diffusion-2-0/">和</a>2.1 <a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/models/#Stable_diffusion_v15">…</a>。<a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/models/">自定义模型</a>是根据基本模型进行训练的。目前，大多数模型都是从 v1.4 或 v1.5 开始训练的。他们接受额外数据的训练，以生成特定样式或对象的图像。</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/models/#Merging_two_models">合并两个模型</a>以创建介于两者之间的样式也很容易。</p>
</li>
</ul>
</li>
<li><p>使用哪种型号？</p>
<ul>
<li>如果您刚开始，请坚持使用<strong>基本模型。</strong>有很多值得学习和玩耍的东西，可以让你忙上几个月。</li>
<li>Stable Diffusion 的三个主要版本是 v1、v2 和 Stable Diffusion XL (SDXL)。<ul>
<li>v1 型号为 1.4 和 1.5。</li>
<li>v2 型号为 2.0 和 2.1。</li>
<li><a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/sdxl-model/">SDXL 1.0</a></li>
</ul>
</li>
<li>您可能认为应该从较新的 v2 型号开始。人们仍在试图弄清楚如何使用 v2 模型。v2 的图像不一定比 v1 的图像好。发布了一系列SDXL模型：<a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/sdxl-beta/">SDXL beta</a>、SDXL 0.9和最新的SDXL 1.0。如果您是稳定扩散的新手，我建议您使用<a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/models/#Stable_diffusion_v15">v1.5和 SDXL 1.0 模型。</a></li>
</ul>
</li>
<li><p>如何训练新模型</p>
<ul>
<li>使用SD的优点是您可以完全控制模型。如果您愿意，您可以创建具有独特风格的自己的模型。训练模型的两种主要方法：（1）<a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/dreambooth/">Dreambooth</a>和（2）<a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/embedding/">Embedding</a>。</li>
<li><strong>Dreambooth</strong>被认为更强大，因为它微调了整个模型的重量。<strong>Embedding</strong>使模型保持不变，但找到描述新主题或风格的关键字。</li>
<li><a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/dreambooth/">您可以在dreambooth</a>文章中尝试使用 Colab 笔记本。</li>
</ul>
</li>
</ul>
<h2 id="Negative-Prompts"><a href="#Negative-Prompts" class="headerlink" title="Negative Prompts"></a>Negative Prompts</h2><ul>
<li><p>您在提示中输入您想看到的内容。你把你不想看到的东西放在否定提示中。并非所有稳定扩散服务都支持负面提示。但它对于 v1 模型来说很有价值，对于 v2 模型来说是必须的。对于初学者来说，使用通用的否定提示并没有什么坏处。阅读有关负面提示的更多信息：</p>
<ul>
<li><p><a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/how-negative-prompt-work/">负面提示如何发挥作用？</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/how-to-use-negative-prompts/">如何使用负面提示？</a></p>
</li>
</ul>
</li>
</ul>
<h2 id="SD-Make-Large-Prints"><a href="#SD-Make-Large-Prints" class="headerlink" title="SD Make Large Prints"></a>SD Make Large Prints</h2><ul>
<li><p>对于 v1 模型，稳定扩散的原始分辨率为 512×512 像素。您不应生成宽度和高度与 512 像素偏差太大的图像。使用以下尺寸设置生成初始图像。</p>
<ul>
<li><strong>横向</strong>图像：将高度设置为 512 像素。将宽度设置得更高，例如 768 像素（2:3 宽高比）</li>
<li><strong>纵向</strong>图像：将宽度设置为 512 像素。将高度设置得更高，例如 768 像素（3:2 宽高比）</li>
<li>如果您将初始宽度和高度设置得太高，您将看到重复的主题。</li>
</ul>
</li>
<li><p>下一步是放大图像。免费的 AUTOMATIC1111 GUI 附带一些流行的 AI 升级器。</p>
<ul>
<li><p>阅读<a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/ai-upscaler/">本教程</a>了解 AI Scaler的初学者指南。</p>
</li>
<li><p>阅读<a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/controlnet-upscale/">本教程</a>以获取更高级的用法。</p>
</li>
</ul>
</li>
</ul>
<h2 id="Control-Image-Composition"><a href="#Control-Image-Composition" class="headerlink" title="Control Image Composition"></a>Control Image Composition</h2><ul>
<li>Image-to-image: 您可以要求稳定扩散在生成新图像时大致遵循输入图像。这称为<a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/how-to-use-img2img-to-turn-an-amateur-drawing-to-professional-with-stable-diffusion-image-to-image/">图像到图像</a>。下面是使用鹰的输入图像生成龙的示例。输出图像的组成遵循输入。</li>
<li>ControlNet: <a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/controlnet/">ControlNet</a>类似地使用输入图像来指导输出。但它可以提取特定信息，例如人体姿势。下面是使用 ControlNet 从输入图像复制人体姿势的示例。除了人体姿势之外，ControlNet 还可以提取其他信息，例如轮廓。</li>
<li>Regional prompting: <a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/regional-prompter/">您可以使用名为Regional Prompter 的</a>扩展指定图像某些部分的提示。此技术对于仅在图像的某些部分绘制对象非常有帮助。阅读<a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/regional-prompter/">区域提示器</a>教程以了解更多使用方法。</li>
<li>Depth-to-image: <a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/depth-to-image/">图像深度</a>是通过输入图像控制构图的另一种方法。它可以检测输入图像的前景和背景。输出图像将遵循相同的前景和背景。下面是一个例子。</li>
</ul>
<h2 id="Generating-Specific-Subjects"><a href="#Generating-Specific-Subjects" class="headerlink" title="Generating Specific Subjects"></a>Generating Specific Subjects</h2><ul>
<li>现实的人：您可以使用稳定扩散来生成照片风格的逼真人物。是使用正确的提示和经过训练的特殊模型来产生照片风格的逼真人类。<a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/realistic-people/">在生成真实人物</a>的教程中了解更多信息。</li>
<li>动物：动物是SD用户中最受欢迎的主题。 阅读生成动物的教程以了解如何操作。</li>
</ul>
<h2 id="Good-Prompts-for-SD"><a href="#Good-Prompts-for-SD" class="headerlink" title="Good Prompts for SD"></a>Good Prompts for SD</h2><h3 id="Prompt-Guide"><a href="#Prompt-Guide" class="headerlink" title="Prompt Guide"></a>Prompt Guide</h3><blockquote>
<p>快速构建是任何SD用户都应该掌握的基本技能。通过了解如何构建清晰简洁的提示，您可以解锁 Stable Diffusion 提供的全部风格。为了擅长提示构建，您应该从一个特定的主题开始，并添加关键字以达到特定的效果。<a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/how-to-come-up-with-good-prompts-for-ai-image-generation/">SD prompts</a></p>
</blockquote>
<ul>
<li><p>如果您想练习快速构建但尚未设置稳定扩散，您可以在线使用<a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/free-ai-image-generator-sites/">免费的稳定扩散生成器</a>。如果您想自行设置，请阅读<a target="_blank" rel="noopener" href="https://andrewongai.gumroad.com/l/stable_diffusion_quick_start">快速入门指南。</a>使用<a target="_blank" rel="noopener" href="https://andrewongai.gumroad.com/l/stable_diffusion_prompt_generator?_gl=1*9sumr3*_ga*MTAxNjEwMDgyMi4xNzA0MjkyMDUy*_ga_YHRX2WJZH7*MTcwNjE2OTA5MC42LjEuMTcwNjE3MTUyMi4yNy4wLjA.">提示生成器</a> 以系统的方法来制作提示。这篇文章旨在成为您的第一门提示课程。请参阅此<a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/prompt-guide/">提示指南</a>以了解高级技术。</p>
</li>
<li><p>这是一种经过验证的技术，可以生成高质量的特定图像。您的提示应该涵盖大部分（如果不是全部）这些区域。</p>
<ul>
<li>Subject (required)</li>
<li>Medium</li>
<li>Style</li>
<li>Artist</li>
<li>Website</li>
<li>Resolution</li>
<li>Additional details</li>
<li>Color</li>
<li>Lighting</li>
</ul>
</li>
<li><p>Subject：</p>
<ul>
<li>初学者的一个常见错误是没有足够详细地描述图像。她穿什么衣服？她的发型是什么？这些看似微不足道的元素可以对所传达的整体形象做出重大贡献。如果不指定这些详细信息，您就将它们留给 AI 生成器，您可能会对得到的结果感到失望。</li>
<li>包含通用的否定提示是一个好习惯。ugly, deform, disfigured。</li>
</ul>
</li>
<li><p>Medium：</p>
<ul>
<li>我们可以更具体。让我们添加一个Medium，即创作艺术品的材料。一些例子是<em>digital painting</em>, <em>photography</em>, and <em>oil painting</em>。<strong>Digital painting of</strong> a young woman with light blue dress sitting next to a wooden window reading a book</li>
</ul>
</li>
<li><p>其余</p>
<ul>
<li>Artist– 指定创作艺术的艺术家来引导风格。 by Stanley Artgerm Lau</li>
<li>Website– 网站名称可用于特定类型。 artstation</li>
<li>Resolution– 这些是控制图像清晰度的关键字。8k</li>
<li><code>Additional details</code>– 这些关键词更像是甜味剂，例如添加一些有趣的细节。extremely detailed, ornate</li>
<li><code>Lighting</code>–<a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/control-lighting/">控制光线</a>对于获得良好的图像非常重要。cinematic lighting, rim lighting</li>
<li><code>color</code>– 图像的配色方案。vivid</li>
</ul>
</li>
<li><p>Putting them all together, the prompt is: Digital painting of a young woman with light blue dress sitting next to a wooden window reading a book, by Stanley Artgerm Lau, artstation, 8k, extremely detailed, ornate, cinematic lighting, rim lighting, vivid.</p>
</li>
</ul>
<blockquote>
<p>我们可以通过在提示中添加特定的关键字来设计图像以获得我们想要的样式。</p>
</blockquote>
<ul>
<li>Tips for good prompts<ul>
<li>描述主题时要详细、具体。</li>
<li>使用多个括号 () 可以增加其强度，使用 [] 可以减少强度。</li>
<li>使用与艺术家一致的适当媒介类型。例如，照片不应该与梵高一起使用。</li>
<li>艺术家的名字是一个非常强烈的风格修饰符。明智地使用。</li>
<li>尝试混合风格。</li>
<li>前往<a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/prompts/">Workflow section</a>研究高质量的提示。如果您喜欢特定图像，请使用提示作为起点。</li>
</ul>
</li>
</ul>
<h3 id="Good-Prompt-List"><a href="#Good-Prompt-List" class="headerlink" title="Good Prompt List"></a>Good Prompt List</h3><ul>
<li><p>Some good keywords: You can find the full list in the <a target="_blank" rel="noopener" href="https://andrewongai.gumroad.com/l/stable_diffusion_prompt_generator">prompt builder</a>.</p>
</li>
<li><p>Medium: Medium defines a category of artwork.</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>keyword</th>
<th>Note</th>
</tr>
</thead>
<tbody><tr>
<td><strong>Portrait</strong></td>
<td>Very realistic drawings. Good to use with people.</td>
</tr>
<tr>
<td><strong>Digital painting</strong></td>
<td>Digital art style.</td>
</tr>
<tr>
<td><strong>Concept art</strong></td>
<td>Illustration style, 2D.</td>
</tr>
<tr>
<td><strong>Ultra realistic illustration</strong></td>
<td>Drawings that are very realistic. Good to use with people.</td>
</tr>
<tr>
<td><strong>Underwater portrait</strong></td>
<td>Use with people. Underwater. Hair floating.</td>
</tr>
<tr>
<td><strong>Underwater steampunk</strong></td>
<td>Very realistic drawings. Good to use with people.</td>
</tr>
</tbody></table>
<ul>
<li>Style: These keywords further refine the art style.</li>
</ul>
<table>
<thead>
<tr>
<th>keyword</th>
<th>Note</th>
</tr>
</thead>
<tbody><tr>
<td><strong>hyperrealistic</strong></td>
<td>Increases details and resolution</td>
</tr>
<tr>
<td><strong>pop-art</strong></td>
<td>Pop-art style</td>
</tr>
<tr>
<td><strong>Modernist</strong></td>
<td>vibrant color, high contrast</td>
</tr>
<tr>
<td><strong>art nouveau</strong></td>
<td>Add ornaments and details, building style</td>
</tr>
</tbody></table>
<ul>
<li>Artist: Mentioning the artist in the prompt is a strong effect. Study their work and choose wisely.</li>
</ul>
<table>
<thead>
<tr>
<th>keyword</th>
<th>Note</th>
</tr>
</thead>
<tbody><tr>
<td><strong>John Collier</strong></td>
<td>19th century portrait painter. Add elegancy</td>
</tr>
<tr>
<td><strong>Stanley Artgerm Lau</strong></td>
<td>Good to use with woman portrait, generate 19th delicate clothing, some impressionism</td>
</tr>
<tr>
<td><strong>Frida Kahlo</strong></td>
<td>Quite strong effect following Kahlo’s portrait style. Sometimes result in picture frame</td>
</tr>
<tr>
<td><strong>John Singer Sargent</strong></td>
<td>Good to use with woman portraits, generate 19th delicate clothing, some impressionism</td>
</tr>
<tr>
<td><strong>Alphonse Mucha</strong></td>
<td>2D portrait painting in style of Alphonse Mucha</td>
</tr>
</tbody></table>
<ul>
<li>Website: Mentioning an art or photo site is a strong effect, probably because each site has its niche genre.</li>
</ul>
<table>
<thead>
<tr>
<th>keyword</th>
<th>Note</th>
</tr>
</thead>
<tbody><tr>
<td><strong>pixiv</strong></td>
<td>Japanese anime style</td>
</tr>
<tr>
<td><strong>pixabay</strong></td>
<td>Commercial stock photo style</td>
</tr>
<tr>
<td><strong>artstation</strong></td>
<td>Modern illustration, fantasy</td>
</tr>
</tbody></table>
<ul>
<li>Resolution</li>
</ul>
<table>
<thead>
<tr>
<th>keyword</th>
<th>Note</th>
</tr>
</thead>
<tbody><tr>
<td><strong>unreal engine</strong></td>
<td>Very realistic and detailed 3D</td>
</tr>
<tr>
<td><strong>sharp focus</strong></td>
<td>Increase resolution</td>
</tr>
<tr>
<td><strong>8k</strong></td>
<td>Increase resolution, though can lead to it looking more fake. Makes the image more camera like and realistic</td>
</tr>
<tr>
<td><strong>vray</strong></td>
<td>3D rendering best for objects, landscape and building.</td>
</tr>
</tbody></table>
<ul>
<li>Lighting</li>
</ul>
<table>
<thead>
<tr>
<th>keyword</th>
<th>Note</th>
</tr>
</thead>
<tbody><tr>
<td><strong>rim lighting</strong></td>
<td>light on edge of an object</td>
</tr>
<tr>
<td><strong>cinematic lighting</strong></td>
<td>A generic term to improve contrast by using light</td>
</tr>
<tr>
<td><strong>crepuscular rays</strong></td>
<td>sunlight breaking through the cloud</td>
</tr>
</tbody></table>
<ul>
<li>Additional details: Add specific details to your image.</li>
</ul>
<table>
<thead>
<tr>
<th>keyword</th>
<th>Note</th>
</tr>
</thead>
<tbody><tr>
<td><strong>dramatic</strong></td>
<td>shot from a low angle</td>
</tr>
<tr>
<td><strong>silk</strong></td>
<td>Add silk to clothing</td>
</tr>
<tr>
<td><strong>expansive</strong></td>
<td>More open background, smaller subject</td>
</tr>
<tr>
<td><strong>low angle shot</strong></td>
<td>shot from low angle</td>
</tr>
<tr>
<td><strong>god rays</strong></td>
<td>sunlight breaking through the cloud</td>
</tr>
<tr>
<td><strong>psychedelic</strong></td>
<td>vivid color with distortion</td>
</tr>
</tbody></table>
<ul>
<li>Color: Add an additional color scheme to the image.</li>
</ul>
<table>
<thead>
<tr>
<th>keyword</th>
<th>Note</th>
</tr>
</thead>
<tbody><tr>
<td><strong>iridescent gold</strong></td>
<td>Shinny gold</td>
</tr>
<tr>
<td><strong>silver</strong></td>
<td>Silver color</td>
</tr>
<tr>
<td><strong>vintage</strong></td>
<td>vintage effect</td>
</tr>
</tbody></table>
<blockquote>
<p>We have gone through the basic structure of a good prompt. This should be used as a guide rather than rule. The Stable Diffusion model is very flexible. Let it surprise you with some creative combination of keywords!</p>
</blockquote>
<h1 id="How-Stable-Diffusion-Works"><a href="#How-Stable-Diffusion-Works" class="headerlink" title="How Stable Diffusion Works"></a>How Stable Diffusion Works</h1><h2 id="Diffusion-Model-Introduction"><a href="#Diffusion-Model-Introduction" class="headerlink" title="Diffusion Model Introduction"></a>Diffusion Model Introduction</h2><blockquote>
<p>Stable Diffusion is a latent diffusion model that generates AI images from text. Instead of operating in the high-dimensional image space, it first compresses the image into the latent space. <a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/how-stable-diffusion-work/">How SD works</a></p>
</blockquote>
<ul>
<li><p>SD属于一类称为<strong>扩散模型</strong>的深度学习模型。它们是生成模型，这意味着它们旨在生成与训练中看到的类似的新数据。在SD的情况下，数据是图像。</p>
</li>
<li><p>扩散那些事儿</p>
<ul>
<li>前向扩散：前向扩散将照片变成噪声。前向扩散过程向训练图像添加噪声，逐渐将其变成不典型的噪声图像。 就像一滴墨水落入一杯水中。墨滴在水中扩散。几分钟后，它随机分布在整个水中。您不再能够判断它最初是落在中心还是边缘附近。</li>
<li>反向扩散：如果我们可以逆转扩散呢？就像倒放视频一样。时间倒退。我们将看到墨滴最初添加的位置。 从嘈杂、无意义的图像开始，反向扩散恢复为原始的图像。这是主要思想。</li>
<li>从技术上讲，每个扩散过程都有两个部分：（1）<strong>漂移</strong>和（2）<strong>随机</strong>运动。反向扩散会偏向猫或狗图像，但不会偏向于两者之间。这就是为什么结果可以是猫或狗。</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/blog_img/img/202401261926737.png" srcset="/img/loading.gif" lazyload alt="img"></p>
</li>
<li><p>如何训练一个扩散模型呢？为了反转扩散，我们需要知道图像中添加了多少噪声。答案是训练<strong>神经网络模型来预测添加的噪声</strong>。它在稳定扩散中被称为<strong>噪声预测器</strong>。它是一个<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/U-Net">U-Net模型</a>。</p>
<ul>
<li><p>训练过程如下：</p>
<ol>
<li>选择一张训练图像，例如猫的照片。</li>
<li>生成随机噪声图像。</li>
<li>通过将噪声图像添加到一定数量的步骤，来破坏训练图像。</li>
<li>教噪声预测器告诉我们添加了多少噪声，这是通过调整其权重并向其显示正确答案来完成的。</li>
</ol>
</li>
<li><p>在每个步骤中依次添加噪声。噪声预测器估计每一步添加的总噪声。添加噪声：</p>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/blog_img/img/202401261927190.png" srcset="/img/loading.gif" lazyload alt="img"></p>
<blockquote>
<p>训练后，<strong>我们有了一个噪声预测器，能够估计添加到图像中的噪声。</strong></p>
</blockquote>
</li>
<li><p>反向扩散：我们首先<strong>生成一个完全随机的图像，并要求噪声预测器告诉我们噪声</strong>。然后我们从原始图像中减去估计的噪声。重复此过程几次。您将获得猫或狗的图像。</p>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/blog_img/img/202401261928705.png" srcset="/img/loading.gif" lazyload alt="img"></p>
</li>
</ul>
</li>
</ul>
<h2 id="Stable-Diffusion-Model-Introduction"><a href="#Stable-Diffusion-Model-Introduction" class="headerlink" title="Stable Diffusion Model Introduction"></a>Stable Diffusion Model Introduction</h2><blockquote>
<p>上述扩散过程是在图像空间中进行的。它的计算速度非常非常慢。您将无法在任何单个 GPU 上运行，更不用说笔记本电脑上的蹩脚 GPU 了。 图像空间是巨大的。想想看：具有三个颜色通道（红、绿、蓝）的 512×512 图像是一个 786,432 维的空间！</p>
</blockquote>
<h3 id="Latent-Space"><a href="#Latent-Space" class="headerlink" title="Latent Space"></a>Latent Space</h3><ul>
<li>Latent Duffusion Model: Stable Diffusion Model旨在解决速度问题。 <strong>SD</strong>是一种<strong>潜在扩散模型</strong>。它不是在高维图像空间中操作，而是首先将图像压缩到潜在空间中。潜在空间小了 48 倍，因此它获得了处理更少数字的好处。这就是为什么它要快得多。</li>
<li>为什么潜在空间可能存在？您可能想知道为什么 VAE 可以将图像压缩到更小的潜在空间而不丢失信息。毫不奇怪，原因是自然图像不是随机的。它们具有高度的规律性：面部遵循眼睛、鼻子、脸颊和嘴巴之间的特定空间关系。图像的高维性是人为的。自然图像可以很容易地压缩到更小的潜在空间中，而不会丢失任何信息。这在机器学习中被称为<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Manifold_hypothesis">Manifold hypothesis 流形假设</a></li>
<li>Reverse diffusion in latent space, Here’s how latent reverse diffusion in Stable Diffusion works.<ol>
<li>生成随机潜在空间矩阵。</li>
<li><strong>噪声预测器</strong>估计潜在矩阵的噪声。</li>
<li>然后从潜在矩阵中减去估计的噪声。</li>
<li>重复步骤 2 和 3 直至达到特定的采样步骤。</li>
<li>VAE 的解码<strong>器</strong>将潜在矩阵转换为最终图像。</li>
</ol>
</li>
</ul>
<h3 id="VAE"><a href="#VAE" class="headerlink" title="VAE"></a>VAE</h3><ul>
<li>Variational Autoencoder(VAE): 可以做到图像在Pixel和Latent之间的转换，变分自动编码器 (VAE) 神经网络有两部分：(1) 编码器和 (2) 解码器。编码器将图像压缩为潜在空间中的较低维表示。解码器从潜在空间恢复图像。</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/blog_img/img/202401261945659.png" srcset="/img/loading.gif" lazyload alt="VAE"></p>
<ul>
<li><strong>SD的潜在空间为 4x64x64，比图像像素空间小 48 倍。</strong>我们谈到的所有前向和反向扩散实际上都是在潜在空间中完成的。</li>
<li>在训练过程中，<strong>它不会生成噪声图像，而是在潜在空间（潜在噪声）中生成随机张量</strong>。它不是用噪声破坏图像，而是用潜在噪声破坏图像在潜在空间中的表示。<strong>这样做的原因是它的速度要快得多，因为潜在空间更小。</strong></li>
<li>什么是 .vae 文件？Stable Diffusion v1 中使用<a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/how-to-use-vae/">VAE 文件来改善眼睛和面部。</a>它们就是我们刚才谈到的<strong>自动编码器的解码器。</strong>通过进一步微调解码器，模型可以绘制更精细的细节。您可能意识到我之前提到的并不完全正确。将图像压缩到潜在空间<em>确实会</em>丢失信息，因为原始 VAE 无法恢复精细细节。相反，VAE 解码器负责绘制精细细节。</li>
</ul>
<h3 id="Upscaling"><a href="#Upscaling" class="headerlink" title="Upscaling"></a>Upscaling</h3><ul>
<li><p>图像分辨率</p>
<ul>
<li><p>图像分辨率反映在潜像张量的大小上。仅对于 512×512 图像，潜在图像的大小为 4x64x64。768×512 肖像图像的尺寸为 4x96x64。这就是为什么需要更长、更多的 VRAM 才能生成更大的图像。</p>
</li>
<li><p>由于SD v1 在 512×512 图像上进行了微调，因此生成大于 512×512 的图像可能会导致重复的对象，例如臭名<a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/common-problems-in-ai-images-and-how-to-fix-them/">昭著的两个头</a>。</p>
</li>
</ul>
</li>
<li><p>图像放大: 要生成大打印，请将图像的至少一侧保持为 512 像素。使用<a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/ai-upscaler/">AI 放大器</a>或图像到图像功能进行图像放大。或者，使用<a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/sdxl-model/">SDXL</a>型号。它的默认尺寸更大，为 1,024 x 1,024 像素。</p>
</li>
</ul>
<h3 id="Conditioning"><a href="#Conditioning" class="headerlink" title="Conditioning"></a>Conditioning</h3><ul>
<li><p>我们的理解不完整：文字提示在哪里进入图片？没有它，稳定扩散就不是文本到图像的模型。您可能获得猫或狗的图像，而没有任何方法可以控制它。</p>
</li>
<li><p>这就是<strong>Conditioning</strong>作用的用武之地。条件作用的目的是<strong>引导噪声预测器，以便预测的噪声</strong>在从图像中减去后能够为我们提供我们想要的结果。</p>
</li>
<li><p>Text Conditioning: 下面概述了如何处理文本提示并将其输入噪声预测器。 Tokenizer首先将提示中的每个单词转换为一个称为token的数字。然后，每个标记都会转换为一个称为embedding的 768 个值向量。 嵌入随后由文本转换器进行处理，并准备好供噪声预测器使用。</p>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/blog_img/img/202401261958039.png" srcset="/img/loading.gif" lazyload alt="在稳定扩散中，文本提示被标记化并转换为嵌入。 然后它由文本转换器处理并由噪声预测器消耗。"></p>
<ul>
<li>Tokenizer: 文本提示首先由CLIP 标记器进行分词。 一个词并不总是意味着一个令牌！SD Model仅限于在提示中使用 75 个tokens。</li>
<li>Embedding: SD v1 使用 Open AI 的<a target="_blank" rel="noopener" href="https://github.com/CompVis/stable-diffusion">ViT-L/14</a> Clip 模型。Embedding一个 768 值向量。每个标记都有自己独特的嵌入向量。嵌入<strong>由 CLIP 模型固定</strong>，CLIP是在训练过程中学习的。Embedding可以把Token嵌入到向量空间，更好表达每个Token之间的关系。</li>
<li>Feeding embeddings to noise predictor(Text Transformer): 在输入噪声预测器之前，Embedding需要由<strong>Text Transformer</strong>进一步处理。<strong>Text Transformer</strong>就像一个用于调节的通用适配器。在这种情况下，它的输入是文本嵌入向量，但它也可以是其他东西，例如类标签、图像和<a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/depth-to-image/">Depth-to-image</a>。转换器不仅进一步处理数据，而且还<strong>提供了一种包含不同调节模式的机制</strong>。</li>
<li>Cross-attention(Noise Predictor): <ul>
<li>整个 U-Net 中的<strong>噪声预测器****多次</strong>使用文本转换器的输出。U-Net 通过<strong>交叉注意力机制</strong>来消耗它。这就是提示与图像相遇的地方。</li>
<li>Hypernetwork是一种微调稳定扩散模型的技术，它劫持交叉注意力网络来插入样式。<a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/lora/">LoRA模型</a>修改交叉注意力模块的权重来改变风格。单独修改这个模块就可以微调 Stabe Diffusion 模型，这一事实告诉您这个模块有多么重要。</li>
</ul>
</li>
</ul>
</li>
<li><p>Other Conditionings:</p>
<ul>
<li>文本提示并不是调节稳定扩散模型的唯一方法。 text conditioning和<a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/depth-to-image/">depth-to-image</a>都用于conditioning模型。</li>
<li><a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/controlnet/">ControlNet</a>使用检测到的轮廓、人体姿势等来调节噪声预测器，并实现对图像生成的出色控制。</li>
</ul>
</li>
</ul>
<h2 id="Stable-Diffusion-Working-Pipeline-txt2img"><a href="#Stable-Diffusion-Working-Pipeline-txt2img" class="headerlink" title="Stable Diffusion Working Pipeline(txt2img)"></a>Stable Diffusion Working Pipeline(txt2img)</h2><ol>
<li>稳定扩散在潜在空间中生成随机张量。您可以通过设置随机数生成器的<a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/know-these-important-parameters-for-stunning-ai-images/#Seed">种子来控制该张量。</a>如果将种子设置为某个值，您将始终获得相同的随机张量。<strong>这是你在潜在空间中的影像</strong>。但目前这都是噪音。</li>
<li><strong>第2步</strong>。噪声预测器 U-Net 将潜在噪声图像和文本提示作为输入，并在潜在空间（4x64x64 张量）中<strong>预测</strong>噪声。</li>
<li><strong>步骤3</strong>。从潜在图像中减去潜在噪声。这成为你<strong>新的潜像</strong>。(重复步骤2和3一定数量的采样步骤，例如20次。)</li>
<li><strong>步骤4</strong>。最后，VAE 的解码器将潜像转换回像素空间。这是运行稳定扩散后获得的图像。</li>
</ol>
<h2 id="Noise-Schedule"><a href="#Noise-Schedule" class="headerlink" title="Noise Schedule"></a>Noise Schedule</h2><ul>
<li>图像从嘈杂变为干净。您是否想知道噪声预测器在最初的步骤中是否工作得不好？事实上，这只是部分正确。真正的原因是我们试图在每个采样步骤中获得<strong>预期的噪声</strong>。这称为<strong>噪声表</strong>。下面是一个例子。</li>
<li><strong>噪声表</strong>是我们定义的。我们可以选择在每一步减去相同数量的噪声。或者我们可以在开始时减去更多，就像上面一样。<a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/samplers/">采样器</a>在每一步中减去足够的噪声，以达到下一步中的预期噪声。这就是您在分步图像中看到的内容。</li>
</ul>
<h2 id="Stable-Diffusion-Working-Pipeline-img2img"><a href="#Stable-Diffusion-Working-Pipeline-img2img" class="headerlink" title="Stable Diffusion Working Pipeline(img2img)"></a>Stable Diffusion Working Pipeline(img2img)</h2><ol>
<li>输入图像被编码到潜在空间。</li>
<li>噪声被添加到潜像中。**<a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/inpainting_basics/#Denoising_strength">去噪强度</a>**控制添加的噪声量。如果为0，则不添加噪声。如果为1，则添加最大量的噪声，使潜像成为完全随机的张量。</li>
<li>噪声预测器 U-Net 将潜在噪声图像和文本提示作为输入，并预测潜在空间（4x64x64 张量）中的噪声。</li>
<li>从潜在图像中减去潜在噪声。这成为你<strong>新的潜像</strong>。(重复步骤3和4一定数量的采样步骤，例如20次。)</li>
<li>最后，VAE 的解码器将潜像转换回像素空间。这是运行 image-to-image 后得到的图像。</li>
</ol>
<blockquote>
<p>图像到图像所做的就是设置带有一点噪声的初始潜在图像和输入图像。将去噪强度设置为 1 相当于文本到图像，因为初始潜在图像是完全随机的。</p>
</blockquote>
<h2 id="Inpainting"><a href="#Inpainting" class="headerlink" title="Inpainting"></a>Inpainting</h2><p>Inpainting实际上只是图像到图像的一种特殊情况。噪点会添加到您想要修复的图像部分。噪声量同样由降噪强度控制。</p>
<h2 id="Depth-to-image"><a href="#Depth-to-image" class="headerlink" title="Depth-to-image"></a>Depth-to-image</h2><p><a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/depth-to-image/">深度到图像</a>是图像到图像的增强；它使用深度图生成带有附加条件的新图像。步骤如下：</p>
<ol>
<li>输入图像被编码为潜在状态</li>
<li><a target="_blank" rel="noopener" href="https://github.com/isl-org/MiDaS">MiDaS</a>（一种 AI 深度模型）根据输入图像估计深度图。</li>
<li>噪声被添加到潜像中。去噪强度控制添加的噪声量。如果去噪强度为0，则不添加噪声。如果去噪强度为1，则添加最大噪声，使得潜像变成随机张量。</li>
<li>噪声预测器估计潜在空间的噪声，<strong>以文本提示和深度图为条件</strong>。</li>
</ol>
<p><img src="https://cdn.jsdelivr.net/gh/alexanderliu-creator/blog_img/img/202401262031048.png" srcset="/img/loading.gif" lazyload alt="depth-to-img"></p>
<ol start="5">
<li>从潜在图像中减去潜在噪声。这成为你<strong>新的潜像</strong>。(重复步骤 4 和 5 的采样步骤数。)</li>
<li>VAE的解码器对潜像进行解码。现在，您可以获得从深度到图像的最终图像。</li>
</ol>
<h2 id="CFG-value"><a href="#CFG-value" class="headerlink" title="CFG value"></a>CFG value</h2><ul>
<li>Classifier guidance: <ul>
<li><a target="_blank" rel="noopener" href="https://arxiv.org/abs/2105.05233">分类器引导</a>是一种将<strong>图像标签</strong>合并到扩散模型中的方法。您可以使用标签来指导扩散过程。例如，标签“猫”引导反向扩散过程来生成猫的照片。分类器指导尺度是控制扩散过程遵循标签的程度的参数。</li>
<li>在高分类器指导下，扩散模型生成的图像将偏向<strong>极端或明确的示例</strong>。如果你向模型询问一只猫，它会返回一张明确是猫的图像，除此之外别无其他。</li>
</ul>
</li>
<li>Classifier-free guidance<ul>
<li><strong><a target="_blank" rel="noopener" href="https://arxiv.org/abs/2207.12598">无分类器指导</a><strong>是一种实现“没有分类器的分类器指导”的方法。他们没有使用类标签和单独的模型进行指导，而是建议使用图像标题并训练</strong>conditional diffusion model</strong>，就像我们在文本到图像中 <a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/how-stable-diffusion-work/#Text_conditioning_text-to-image">讨论的模型一样</a></li>
<li>他们将分类器部分作为<strong>噪声预测器 U-Net 的调节</strong>，实现了图像生成中所谓的“无分类器”（即没有单独的图像分类器）指导。文本提示提供了文本到图像的指导。</li>
</ul>
</li>
<li>Classifier-free guidance scale: <strong>无分类器引导尺度（CFG 尺度）</strong>是控制文本提示引导扩散过程的程度的值<strong>。当 CFG 比例设置为 0 时， AI 图像生成是</strong>无条件的（即忽略提示）。较高的 CFG 比例会引导扩散朝向提示。</li>
</ul>
<h2 id="SD-v1-5-vs-v2"><a href="#SD-v1-5-vs-v2" class="headerlink" title="SD v1.5 vs v2"></a>SD v1.5 vs v2</h2><blockquote>
<p>…想看去原文看哈，这里简单概括下重要的</p>
</blockquote>
<ul>
<li>用户通常发现使用 Stable Diffusion v2 来控制风格和生成名人更困难。尽管 Stability AI 没有明确过滤掉艺术家和名人的名字，但它们的效果在 v2 中要弱得多。这可能是由于训练数据的差异造成的。Open AI 的专有数据可能有更多艺术品和名人照片。他们的数据可能经过高度过滤，因此一切和每个人看起来都很好。<strong>v2 和 v2.1 模型并不流行</strong>。人们只使用经过微调的 v1.5 和 SDXL 模型。</li>
<li>SDXL型号是v1和v2型号的官方升级版。该模型作为开源软件发布。 这是一个更大的模型，SDXL模型的参数总数为66亿，而v1.5模型的参数总数为9.8亿。</li>
</ul>
<h1 id="Important-Parameters-in-image-gen"><a href="#Important-Parameters-in-image-gen" class="headerlink" title="Important Parameters in image gen"></a>Important Parameters in image gen</h1><h2 id="CFG-Scale"><a href="#CFG-Scale" class="headerlink" title="CFG Scale"></a>CFG Scale</h2><ul>
<li>CFG Value是一个参数，用于控制模型应尊重您的提示的程度。</li>
</ul>
<p>1 – 大多忽略您的提示。<br>3 – 更有创意。<br>7 – 遵循提示和自由之间的良好平衡。<br>15 – 坚持更多提示。<br>30 – 严格按照提示操作。</p>
<ul>
<li>下面是使用相同随机种子增加 CFG 规模的几个示例。一般来说，您应该远离两个极端——1 和 30。</li>
<li><strong>建议</strong>：从 7 开始。如果您希望它更多地遵循您的提示，请增加。</li>
</ul>
<h2 id="Sampling-steps"><a href="#Sampling-steps" class="headerlink" title="Sampling steps"></a>Sampling steps</h2><ul>
<li>质量随着采样步骤的增加而提高。<em>通常，使用Euler</em>采样器进行 20 个步骤 就足以获得高质量、清晰的图像。虽然当迈向更高的值时，图像会发生微妙的变化，但它会变得不同，但不一定具有更高的质量。</li>
<li><strong>建议</strong>：20-30 步。如果您怀疑质量较低，请调整至较高值。</li>
</ul>
<h2 id="Sampling-methods"><a href="#Sampling-methods" class="headerlink" title="Sampling methods"></a>Sampling methods</h2><ul>
<li>您可以选择多种采样方法，具体取决于您使用的 GUI。它们只是求解扩散方程的不同方法。它们应该给出相同的结果，但由于数值偏差可能略有不同。但由于这里没有正确的答案——唯一的标准是图像看起来不错，因此该方法的准确性不应该是您关心的问题。</li>
<li>在线社区中有一些讨论声称某些采样方法往往会产生特定的风格。这是没有理论价值的。</li>
</ul>
<h2 id="Seed"><a href="#Seed" class="headerlink" title="Seed"></a>Seed</h2><ul>
<li>随机种子决定了初始噪声模式，从而决定了最终图像。将其设置为 -1 意味着每次都使用随机的一个。当您想要生成新图像时它很有用。另一方面，固定Seed，将会在每一代中产生相同的图像。</li>
<li>如果使用随机种子，如何找到用于图像的种子？在对话框中，您应该看到类似以下内容：</li>
</ul>
<blockquote>
<p>步骤：20，采样器：Euler a，CFG规模：7， <strong>种子：4239744034</strong>，大小：512×512，模型哈希：7460a6fa</p>
</blockquote>
<ul>
<li>将此种子值复制到种子输入框中。如果一次生成多张图像，则第二张图像的种子值会增加 1，依此类推。或者，单击回收按钮以重复使用上一代的种子。<strong>建议</strong>：Set to -1 to explore. Fix to a value for fine-tuning.</li>
</ul>
<h2 id="Image-size"><a href="#Image-size" class="headerlink" title="Image size"></a>Image size</h2><ul>
<li>输出图像的大小。由于稳定扩散 v1 是使用 512×512 图像进行训练的，因此偏离太多可能会导致诸如重复对象之类的问题。尽可能将其保留为正方形。512×768（纵向）或768×512（横向）仍然可以。</li>
<li><strong>建议</strong>：将图像尺寸设置为512×512。否则为 512×768 或 768×512。（适用于 v1 型号）</li>
</ul>
<h2 id="Batch-size"><a href="#Batch-size" class="headerlink" title="Batch size"></a>Batch size</h2><ul>
<li>批量大小是每次生成的图像数量。由于最终图像非常依赖于随机种子，因此一次生成一些图像始终是一个好主意。这样，您就可以很好地了解当前提示可以执行的操作。</li>
<li><strong>建议</strong>：将批量大小设置为 4 或 8。</li>
</ul>
<h2 id="More"><a href="#More" class="headerlink" title="More"></a>More</h2><ul>
<li>在本文中，我们介绍了稳定扩散 AI 的基本参数。查看<a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/how-to-come-up-with-good-prompts-for-ai-image-generation/">本文</a>，了解构建高质量提示的分步指南。查看<a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/fine-tune-your-ai-images-with-these-simple-prompting-techniques/">这篇文章</a>以了解更高级的提示技术。</li>
</ul>
<h1 id="How-to-use-ComfyUI"><a href="#How-to-use-ComfyUI" class="headerlink" title="How to use ComfyUI"></a>How to use ComfyUI</h1><blockquote>
<p>ComfyUI is a node-based GUI for Stable Diffusion. <a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/comfyui/">Beginner’s Guide to ComfyUI</a></p>
</blockquote>
<h2 id="Components-in-ComfyUI"><a href="#Components-in-ComfyUI" class="headerlink" title="Components in ComfyUI"></a>Components in ComfyUI</h2><ul>
<li>ComfyUI 是一个基于节点的Stable Diffusion GUI。<strong>您可以通过将不同的块（称为节点</strong>）链接在一起来构建图像生成工作流程。</li>
<li>一些常用的块包括加载检查点模型、输入提示、指定采样器等。ComfyUI 将工作流程分解为可重新排列的元素，以便您可以轻松创建自己的元素。您需要一个可用的 ComfyUI 才能遵循本指南。本地安装请参见<a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/how-to-install-comfyui/">安装指南</a>。</li>
<li>ComfyUI 的<strong>好与坏</strong>：<ul>
<li>好处<ul>
<li><strong>轻量级</strong>：运行速度快。</li>
<li><strong>灵活</strong>：非常可配置。</li>
<li><strong>透明</strong>：数据流就在你的面前。</li>
<li><strong>易于共享</strong>：每个文件都是一个可重复的工作流程。</li>
<li><strong>适合原型设计</strong>：使用图形界面而不是编码进行原型设计。</li>
</ul>
</li>
<li>坏处<ul>
<li><strong>界面不一致</strong>：每个工作流程可能会以不同的方式放置节点。你需要弄清楚要改变什么。</li>
<li><strong>太多细节</strong>：普通用户不需要知道底层是如何连接的。（这难道不是使用 GUI 的全部意义吗？）</li>
</ul>
</li>
</ul>
</li>
</ul>
<blockquote>
<p>具体的Demo可以看上的链接哈，这里就不详细展开了。</p>
</blockquote>
<ul>
<li><p>Workflow is made with two basic building blocks: <strong>Nodes</strong> and <strong>edges</strong>.</p>
<ul>
<li><p><strong>Nodes</strong> are the rectangular blocks, e.g., Load Checkpoint, Clip Text Encoder, etc. Each node executes some code. If you have some programming experience, you can think of them as functions. Each node needs three things</p>
<ul>
<li><p><strong>Input</strong>s are the texts and dots on the left that the wires come in.</p>
</li>
<li><p><strong>Outputs</strong> are the texts and dots on the right the wires go out.</p>
</li>
<li><p><strong>Parameters</strong> are the fields at the center of the block.</p>
</li>
</ul>
</li>
<li><p><strong>Edges</strong> are the wires connecting the outputs and the inputs between <strong>nodes</strong>.</p>
</li>
</ul>
</li>
<li><p>Stable Diffusion由三个主要部分组成：</p>
<ol>
<li><strong>模型</strong>：潜在空间中的噪声预测模型。</li>
<li><strong>CLIP</strong>：语言模型对正面和负面提示进行预处理。</li>
<li><strong>VAE</strong>：变分自动<strong>编码器</strong>在像素和潜在空间之间转换图像。</li>
</ol>
</li>
</ul>
<blockquote>
<p>MODEL 输出连接到<a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/samplers/">采样器</a>，在采样器中完成反向扩散过程。</p>
<p>CLIP 输出连接到提示，因为提示需要经过 CLIP 模型处理才能有用。CLIP<strong>文本编码</strong>节点获取提示并将其输入 CLIP 语言模型。CLIP 是 OpenAI 的语言模型，将提示中的每个单词转换为<a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/embedding/">Embedding</a>。</p>
<p>在txt2img中，VAE仅用于最后一步：将图像从潜在空间转换到像素空间。换句话说，我们只使用自动编码器的<strong>解码器</strong>部分。</p>
</blockquote>
<ul>
<li>Empty latent image: 文本<a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/how-stable-diffusion-work/#Text-to-image">到图像的</a>过程从潜在空间中的随机图像开始。潜像的大小与像素空间中的实际图像成正比。因此，如果您想更改图像的大小，请更改潜在图像的大小。<ul>
<li>您可以设置<strong>高度</strong>和<strong>权重</strong>来更改像素空间中的图像大小。</li>
<li>您还可以设置<strong>批量大小</strong>，即每次运行生成的图像数量。</li>
</ul>
</li>
<li>KSampler: KSampler 是稳定扩散图像生成的核心。采样<a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/samplers/">器</a>将随机图像去噪为与您的提示相匹配的图像。KSampler 指的是在此<a target="_blank" rel="noopener" href="https://github.com/crowsonkb/k-diffusion">代码存储库</a>中实现的采样器。<ul>
<li>Seed: KSampler 指的是在此<a target="_blank" rel="noopener" href="https://github.com/crowsonkb/k-diffusion">代码存储库</a>中实现的采样器</li>
<li>Control_after_generation: <strong>种子</strong>在每一代之后应如何变化。它可以获取随机值（随机化）、增加 1（增量）、减少 1（减量）或不变（固定）。</li>
<li>Step: 采样步骤数。越高，数值过程中的伪影越少。</li>
<li>Sampler_name: 在这里，您可以设置采样算法。请阅读<a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/samplers/">采样器文章</a>以获取入门知识。</li>
<li>Scheduler: 控制每个步骤中噪声级别的变化方式。</li>
<li>Denoise: 去噪过程应消除多少初始噪声。1 表示全部。</li>
</ul>
</li>
</ul>
<h2 id="ComfyUI-Manager"><a href="#ComfyUI-Manager" class="headerlink" title="ComfyUI Manager"></a>ComfyUI Manager</h2><ul>
<li>Install:</li>
</ul>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">cd ComfyUI/custom_nodes<br>git clone https://github.com/ltdrdata/ComfyUI-Manager<br></code></pre></td></tr></tbody></table></figure>

<ul>
<li>Usage<ul>
<li>安装/卸载custom nodes。</li>
<li>安装当前工作流程中缺少的节点。</li>
<li>安装<a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/models/">checkpoint models</a>, <a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/ai-upscaler/">AI upscalers</a>, <a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/how-to-use-vae/">VAEs</a>, <a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/train-lora/">LoRA</a>, <a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/controlnet/">ControlNet models</a>, etc.</li>
<li>更新 ComfyUI UI</li>
<li>阅读社区手册。</li>
</ul>
</li>
</ul>
<blockquote>
<p>The <strong>Install Missing Nodes</strong> function is especially useful for finding what custom nodes that are required in the current workflow.</p>
<p>The <strong>Install Custom Nodes</strong> menu lets you manage custom nodes. You can uninstall or disable an installed node or install a new one.</p>
</blockquote>
<ul>
<li>如何更新ComfyUI或者是某个custom node？<ul>
<li>通过ComfyUI Manger的UI来更新</li>
<li>切到对应的目录，然后git pull</li>
</ul>
</li>
</ul>
<h2 id="Upscaling-1"><a href="#Upscaling-1" class="headerlink" title="Upscaling"></a>Upscaling</h2><ul>
<li><p>There are several ways to upscale in Stable Diffusion. For teaching purposes, let’s go through upscaling with: <a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/ai-upscaler/">AI upscaler</a>, <a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/automatic1111/#Hires_fix">Hi-res fix</a>, <a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/controlnet-upscale/">Ultimate Upscale</a></p>
</li>
<li><p>AI upscale: AI <a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/ai-upscaler/">upscaler</a>是一种用于放大图像(Pixel)并填充细节的 AI 模型。它们不是Stable Diffusion Model，而是经过训练以放大图像的神经网络。<a target="_blank" rel="noopener" href="https://comfyanonymous.github.io/ComfyUI_examples/upscale_models/">Example</a></p>
</li>
</ul>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://upscale.wiki/w/index.php?title=Model_Database&amp;oldid=1571">Upscaler Model Wiki</a>, <a target="_blank" rel="noopener" href="https://openmodeldb.info/">The Best Place To Find AI Upscaling Models</a></p>
</blockquote>
<ul>
<li><p>Hi-res fix: <a target="_blank" rel="noopener" href="https://comfyanonymous.github.io/ComfyUI_examples/2_pass_txt2img/">Example</a>, 第一部分与文本到图像相同：您使用采样器对潜在图像进行去噪，并以正面和负面提示为条件。 然后，工作流程会放大潜在空间中的图像并执行一些额外的采样步骤。它给图像添加一些初始噪声，并以一定的去噪强度对其进行去噪。 然后，VAE 解码器对较大的潜在图像进行解码以生成放大的图像。</p>
</li>
<li><p>SD Ultimate upscale, <a target="_blank" rel="noopener" href="https://github.com/ssitu/ComfyUI_UltimateSDUpscale">Github Page of SD Ultimate upscale for ComfyUI</a></p>
<ul>
<li><p>This is a good exercise for installing a custom node.</p>
</li>
<li><p>A good exercise is to start with the AI upscaler workflow. Add SD Ultimate Upscale and compare the result. Right-click on an empty space. Select Add Node &gt; image &gt; upscaling &gt; Ultimate SD Upscale.</p>
</li>
<li><p>Parameters</p>
<ul>
<li><p><strong>image</strong> to VAE Decode’s IMAGE.</p>
</li>
<li><p><strong>model</strong> to Load Checkpoint’s MODEL.</p>
</li>
<li><p><strong>positive</strong> to CONDITIONING of the positive prompt box.</p>
</li>
<li><p><strong>negative</strong> to CONDITIONING of the negative prompt box.</p>
</li>
<li><p><strong>vae</strong> to Load Checkpoint’s VAE.</p>
</li>
<li><p><strong>upscale_model</strong> to Load Upscale Model’s UPSCALE_MODEL.</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="Others"><a href="#Others" class="headerlink" title="Others"></a>Others</h2><ul>
<li><p>ComfyUI Inpainting: You can use ComfyUI for <a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/inpainting_basics/">inpainting</a>. It is a basic technique to regenerate a part of the image.</p>
</li>
<li><p>ComfyUI Impact Pack: <a target="_blank" rel="noopener" href="https://github.com/ltdrdata/ComfyUI-Impact-Pack">ComfyUI Impact pack</a> is a pack of free custom nodes that greatly enhance what ComfyUI can do. There are more custom nodes in the Impact Pact. See the <a target="_blank" rel="noopener" href="https://github.com/ltdrdata/ComfyUI-extension-tutorials/tree/Main">official tutorials</a> to learn them one by one. Read through the beginner tutorials if you want to use this set of nodes effectively.</p>
</li>
<li><p>Regenerate faces with Face Detailer (SDXL)</p>
<ul>
<li><p>You can use <a target="_blank" rel="noopener" href="https://github.com/ltdrdata/ComfyUI-extension-tutorials/blob/Main/ComfyUI-Impact-Pack/workflow/sdxl-detailer.json">this workflow</a> in the Impact Pack to regenerate faces with the <strong>Face Detailer</strong> custom node and SDXL base and refiner models. Download and drop the JSON file into ComfyUI.</p>
</li>
<li><p>To use this workflow, you will need to set</p>
<ul>
<li>The initial image in the <strong>Load Image</strong> node.</li>
<li>An SDXL base model in the upper <strong>Load Checkpoint</strong> node.</li>
<li>An SDXL refiner model in the lower <strong>Load Checkpoint</strong> node.</li>
<li>The <strong>prompt</strong> and <strong>negative</strong> prompt for the new images.</li>
</ul>
</li>
</ul>
</li>
<li><p>使用 Face Detailer (SDXL) 重新生成面部</p>
</li>
<li><p>使用 Face Detailer (SD v1.5) 重新生成面部</p>
</li>
<li><p>Embeddings: 要在 ComfyUI 中使用<a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/embedding/">Embeddings</a>（也称为<strong>文本反转</strong><code>embedding:</code>），请在肯定或否定提示框中键入。ComfyUI 将搜索文件夹<strong>ComfyUI &gt; models &gt; embeddings</strong>中具有相同文件名的Embeddings。</p>
</li>
<li><p>Embedding with autocomplete: 查找文件名需要做很多工作。相反，您可以通过安装ComfyUI-Custom-Scripts自定义节点来启用嵌入名称的自动完成功能。 您可以使用 ComfyUI 管理器安装它。单击管理器 &gt; 安装自定义节点。搜索“ComfyUI-Custom-Scripts”并安装它。重新启动 ComfyUI。 embedding:输入提示后，应该会出现可用嵌入的列表。选择您要使用的一个。</p>
</li>
<li><p>Lora: LoRA是一个修改检查点模型的小模型文件。它经常用于修改样式或将人物注入模型中。 LoRA模型改变了检查点模型的MODEL和CLIP，但保持VAE不变。<a target="_blank" rel="noopener" href="https://comfyanonymous.github.io/ComfyUI_examples/lora/lora.png">下载简单的 LoRA 工作流程</a></p>
<ul>
<li>选择检查点模型。</li>
<li>选择 LoRA。</li>
<li>修改提示和否定提示。</li>
<li>单击<strong>队列提示</strong>。</li>
</ul>
</li>
<li><p>多个 LoRA: 您可以在同一文本到图像工作流程中使用两个 LoRA。 <a target="_blank" rel="noopener" href="https://comfyanonymous.github.io/ComfyUI_examples/lora/lora_multiple.png">下载两个 LoRA 工作流程</a>，用法与一个 LoRA 类似，但现在您必须选择两个，两个LoRA相继应用(one after the other)。</p>
</li>
<li><p>Joining two strings: </p>
<ul>
<li>To join two strings, you will use a node called <strong>String Function</strong> from the <a target="_blank" rel="noopener" href="https://github.com/pythongosssss/ComfyUI-Custom-Scripts">ComfyUI-Custom-Scripts</a> custom node.</li>
<li>You should have installed this custom node to enable autocomplete of the textual inversion. Install it in the ComfyUI Manager if not.</li>
</ul>
</li>
</ul>
<h1 id="Stable-Diffusion-Workflow"><a href="#Stable-Diffusion-Workflow" class="headerlink" title="Stable Diffusion Workflow"></a>Stable Diffusion Workflow</h1><blockquote>
<p>A stunning Stable Diffusion artwork is not created by a simple prompt. The workflow is a multiple-step process. In this post, I will go through the workflow step-by-step. <a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/workflow/">Stable Diffusion Workflow</a></p>
</blockquote>
<h1 id="SD-glossary"><a href="#SD-glossary" class="headerlink" title="SD glossary"></a>SD glossary</h1><p><a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/glossary/">SD glossary</a></p>
<h1 id="References"><a href="#References" class="headerlink" title="References"></a>References</h1><ol>
<li><a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/beginners-guide/">SD beginners-guide</a></li>
<li><a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/how-to-come-up-with-good-prompts-for-ai-image-generation/">SD prompts guides</a></li>
<li><a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/inpainting_basics/">SD inpainting basics</a></li>
<li><a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/models/">SD models</a></li>
<li><a target="_blank" rel="noopener" href="https://andrewongai.gumroad.com/l/stable_diffusion_quick_start">SD quick-start guide</a></li>
<li><a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/glossary/">SD glossary</a></li>
<li><a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/how-stable-diffusion-work/">How SD works</a></li>
<li><a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/comfyui/">Beginner’s Guide to ComfyUI</a></li>
<li><a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/how-to-use-vae/">How to use vae for fixing face and fingers</a></li>
<li><a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/workflow/">Stable Diffusion Workflow</a></li>
<li><a target="_blank" rel="noopener" href="https://stable-diffusion-art.com/know-these-important-parameters-for-stunning-ai-images/">Important Parameters</a></li>
</ol>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/AI/" class="category-chain-item">AI</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/%E7%A0%940%E8%87%AA%E5%AD%A6/">#研0自学</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>Stable Diffusion and ComfyUI Tutorial</div>
      <div>https://alexanderliu-creator.github.io/2024/01/25/stable-diffusion-and-comfyui-tutorial/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>Alexander Liu</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2024年1月25日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2024/01/28/li-hong-yi-shen-du-xue-xi-ke-cheng/" title="李宏毅深度学习课程">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">李宏毅深度学习课程</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2023/12/25/pku-cao-zuo-xi-tong-yu-xu-ni-hua-an-quan/" title="PKU-操作系统与虚拟化安全">
                        <span class="hidden-mobile">PKU-操作系统与虚拟化安全</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  





  <script>
  Fluid.utils.createScript('https://lib.baomitu.com/mermaid/8.14.0/mermaid.min.js', function() {
    mermaid.initialize({"theme":"default"});

    Fluid.events.registerRefreshCallback(function() {
      if ('mermaid' in window) {
        mermaid.init();
      }
    });
  });
</script>






    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        总访问量 
        <span id="busuanzi_value_site_pv"></span>
         次
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        总访客数 
        <span id="busuanzi_value_site_uv"></span>
         人
      </span>
    
    
  
</div>

  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            loader : {
              load: ['ui/lazy']
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }

        Fluid.events.registerRefreshCallback(function() {
          if ('MathJax' in window && MathJax.startup.document && typeof MathJax.startup.document.state === 'function') {
            MathJax.startup.document.state(0);
            MathJax.texReset();
            MathJax.typeset();
            MathJax.typesetPromise();
          }
        });
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.2/es5/tex-mml-chtml.js" ></script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
